<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Getting Started · MOSIP Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Table Of Content"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Getting Started · MOSIP Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://your-docusaurus-test-site.com/"/><meta property="og:description" content="## Table Of Content"/><meta property="og:image" content="https://your-docusaurus-test-site.com/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://your-docusaurus-test-site.com/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://your-docusaurus-test-site.com/blog/atom.xml" title="MOSIP Documentation Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://your-docusaurus-test-site.com/blog/feed.xml" title="MOSIP Documentation Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.ico" alt="MOSIP Documentation"/><h2 class="headerTitleWithLogo">MOSIP Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/Platform-Documentation" target="_self">Docs</a></li><li class="siteNavGroupActive siteNavItemActive"><a href="/docs/Getting-Started" target="_self">API</a></li><li class=""><a href="/Contributor-Guide" target="_self">Help</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Building and Deploying MOSIP</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/Platform-Documentation">Table Of Contents</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Building and Deploying MOSIP</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/Getting-Started">Getting Started</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Open Source Contributions</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/Contributor-Guide">Contributor Guide</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Getting Started</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="table-of-content"></a><a href="#table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table Of Content</h2>
<ul>
<li><a href="#1-getting-the-source-code-">1. Getting the Source Code</a></li>
<li><a href="#2-setup-and-configure-jenkins-">2. Setup and Configure Jenkins</a></li>
<li><a href="#3-setup-and-configure-jfrog-artifactory-version-652-">3. Setup and Configure Jfrog Artifactory Version 6.5.2</a></li>
<li><a href="#4-setup-and-configure-sonarqube-version-73-">4. Setup and Configure SonarQube version 7.3</a></li>
<li><a href="#5-setup-and-configure-docker-registry-">5. Setup and Configure Docker Registry</a></li>
<li><a href="#6-installing-external-dependencies-">6. Installing External Dependencies</a></li>
<li><a href="#7-configuring-mosip-">7. Configuring MOSIP</a></li>
<li><a href="#8-mosip-deployment-">8. MOSIP Deployment</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="1-getting-the-source-code-table-of-content"></a><a href="#1-getting-the-source-code-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Getting the Source Code <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<p>Knowledge of Linux and Azure with Kubernetes are required to follow the instructions.
MOSIP source code can be obtained via creating a fork of mosip-platform Github repository from the <a href="/mosip/mosip-platform/">URL</a>. To know more about how to fork code from Github follow this <a href="//help.github.com/articles/fork-a-repo/">guide</a>.
Once Forked, start the process of setting up your CI/CD tools to build and run MOSIP.</p>
<p><strong>NOTE</strong> MOSIP configuration has been seperated from the source code. For running the source code, you will be needing a fork of mosip-config repository from this <a href="https://github.com/mosip/mosip-config.git">URL</a>. All the configuration files will be stored under config-templates folder under this repository.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="2-setup-and-configure-jenkins-table-of-content"></a><a href="#2-setup-and-configure-jenkins-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Setup and Configure Jenkins <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<p>In this step, we will setup jenkins and configure it. Configuration contains steps like creating credentials, creating pipelines using xml files present in MOSIP source code, connecting Jenkins to recently forked repository and creating webhooks. Lets look at these steps one by one -</p>
<h3><a class="anchor" aria-hidden="true" id="a-installing-jenkins-version-21501"></a><a href="#a-installing-jenkins-version-21501" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A. Installing Jenkins version 2.150.1</h3>
<p>Jenkins installation is standard(see <a href="//jenkins.io/doc/book/installing/">How to install Jenkins</a>), but to use MOSIP supported build pipelines you have to install Jenkins in an Redhat 7.6 environment. The prerequisite for installing Jenkins is you should have java already installed and path for JAVA_HOME is also set. Also the following plugins have to be installed
list of plugins -</p>
<ul>
<li><a href="//wiki.jenkins.io/display/JENKINS/GitHub+Plugin">Github Plugin</a></li>
<li><a href="//wiki.jenkins.io/display/JENKINS/Artifactory+Plugin">Artifactory Plugin</a></li>
<li><a href="//wiki.jenkins.io/display/JENKINS/Credentials+Plugin">Credentials Plugin</a></li>
<li><a href="//wiki.jenkins.io/display/JENKINS/Docker+Pipeline+Plugin">Docker Pipeline Plugin</a></li>
<li><a href="//wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin">Email Extension Plugin</a></li>
<li><a href="//wiki.jenkins-ci.org/display/JENKINS/Pipeline+Plugin">Pipeline Plugin</a></li>
<li><a href="//wiki.jenkins-ci.org/display/JENKINS/Publish+Over+SSH+Plugin">Publish Over SSH Plugin</a></li>
<li><a href="//docs.sonarqube.org/display/SCAN/Analyzing+with+SonarQube+Scanner+for+Jenkins">SonarQube Scanner for Jenkins Plugin</a></li>
<li><a href="//wiki.jenkins-ci.org/display/JENKINS/SSH+Agent+Plugin">SSH Agent Plugin</a></li>
<li><a href="//wiki.jenkins.io/display/JENKINS/Pipeline+Utility+Steps+Plugin">Pipeline Utility Steps Plugin</a></li>
<li><a href="//wiki.jenkins.io/display/JENKINS/M2+Release+Plugin">M2 Release Plugin</a></li>
<li><a href="//wiki.jenkins-ci.org/display/JENKINS/SSH+Credentials+Plugin">SSH Credentials Plugin</a></li>
<li><a href="//wiki.jenkins.io/display/JENKINS/Office+365+Connector+Plugin">Office 365 Plugin</a></li>
</ul>
<p>Once the plugin installation is complete, run this command in Jenkins Script Console -</p>
<p><code>System.setProperty(&quot;hudson.model.DirectoryBrowserSupport.CSP&quot;, &quot;&quot;)</code></p>
<p>This above command modifies Content Security Policy in Jenkins to enable loading of style and javascript for HTML Reports.</p>
<h3><a class="anchor" aria-hidden="true" id="b-setting-up-github-for-in-jenkins"></a><a href="#b-setting-up-github-for-in-jenkins" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>B. Setting Up Github for/in Jenkins</h3>
<p>Setting up Github for/in Jenkins involves putting the Jenkins Webhook url in Github Repo so that Github can inform Jenkins for push events(look at <a href="//developer.github.com/webhooks/">Webhooks</a> and <a href="//wiki.jenkins.io/display/JENKINS/GitHub+Plugin#GitHubPlugin-GitHubhooktriggerforGITScmpolling">Github hook</a>). After hooks are in place, setup Github credentials inside Jenkins, so that on webhook event our pipeline can checkout the code from Github. To set up Github Credentials, follow these steps -</p>
<pre><code class="hljs">I. Goto Jenkins
II. Goto Credentials -&gt; System
III. Goto Global credentials
IV. Click on Add Credentials
V. Now use following details

    Kind=Username with password
    Scope=Global (Jenkins, nodes, items, all child items, etc)
    Username=&lt;Your Github Username&gt;
    Password=&lt;Your Github Password&gt;
    ID=Some Unique Identifier to refer to this credentials (to autogenerate this, leave this blank)
    Description=&lt;It is optional&gt;
VI. Now since our Jenkinsfile usage this github credentials, update the credentials id in the Jenkinsfile.
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="c-create-pipelines"></a><a href="#c-create-pipelines" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>C. Create Pipelines</h3>
<p>Next step after Jenkins installation is to configure/create Jenkins Jobs. These Jenkins Jobs are written as Jenkins Pipelines and respective Jenkinsfile in <a href="https://github.com/mosip/mosip-infra/tree/master/deployment/cloud/jenkinsfile">URL</a>. MOSIP currently has 5 Jenkins jobs that take care of CI/CD process for Development Environment. They are -</p>
<ul>
<li><p>master-branch-build-all-modules</p>
<p>Jenkinsfile for master-branch-build-all-modules can be found in <a href="https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/jenkinsfile">URL</a>, named <strong>MasterJenkinsfile</strong><br/><br/>
This Job is used to build MOSIP as a single unit. This Job also acts like a nightly process to check the build status of MOSIP code in Master Branch. To create this Job you need to create a new Item in Jenkins as a Pipeline Project. Here is the configuration for Pipeline you might have to explicitly change to use MOSIP provided Jenkinsfile-</p>
<p><img src="_images/getting_started_images/master-branch-build-all-modules-build-triggers.JPG" alt="Configure Build Triggers"></p>
<p><img src="_images/getting_started_images/master-branch-build-all-modules-pipeline.JPG" alt="Configure Pipelines"></p>
<p>As it can be seen from the above image this pipeline uses Jenkinsfile present in master branch of mosip-platform repository. You need to provide the Github credentials that this pipeline will take to connect and download this Jenkinsfile at the time of the build. Let us now look into this Jenkinsfile.</p>
<p>Jenkinsfile for this pipeline is written in Groovy Language using the scripted style of writing code.</p>
<ul>
<li><p>Then we have module specific Jenkinsfile for individual Modules. These Modules are:</p>
<ul>
<li><strong>Kernel</strong><br/></li>
<li><strong>Registration</strong><br/></li>
<li><strong>Registration-Processor</strong><br/></li>
<li><strong>Pre-Registration</strong><br/></li>
<li><strong>ID-Repository</strong><br/></li>
<li><strong>ID-Authentication</strong><br/></li>
</ul>
<p>Each Module's CI/CD Jenkins script can be found in <a href="https://github.com/mosip/mosip-infra/tree/master/deployment/cloud/jenkinsfile">URL</a>. This Jenkins script will be  named Jenkinsfile and is responsible to build and deploy the entire Module to Dev environment<br/></p></li>
<li><p>For promoting these modules to QA, there is a pipeline named <strong>PromoteToQAJenkinsFile</strong> which is located in root directory of mosip source code. This pipeline tags the entire code, runs build process, and once everything is successful, it deploys the entire code to QA environment.</p></li>
</ul>
<p>In each Jenkinsfile you will see some variables starting with <strong>params.</strong> These variables are passed as parameters into the Jenkins jobs. You have to setup these parameters variables in your jenkins to use these Jenkinsfiles. These Variables include:<br/></p></li>
</ul>
<p><strong>NOTE</strong>-&gt; To set up parameters for a jenkins job, go inside the jenkins job-&gt; Click Configure-&gt;Click on &quot;This project is parameterized&quot; and provide the parameter name and value.</p>
<ol>
<li><strong>BRANCH_NAME</strong><br/></li>
<li><strong>REGISTRY_URL</strong><br/></li>
<li><strong>REGISTRY_NAME</strong><br/></li>
<li><strong>REGISTRY_CREDENTIALS</strong><br/></li>
<li><strong>GIT_URL</strong><br/></li>
<li><strong>GIT_CREDENTIALS</strong><br/></li>
<li><strong>BUIILD_OPTION</strong><br/></li>
</ol>
<p><strong>NOTE</strong> We are building docker images in each of the JenkinsFile, so docker should be installed and accessible for Jenkins user. Please install Docker version 18.09.3 in your Jenkins instance.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="3-setup-and-configure-jfrog-artifactory-version-652-table-of-content"></a><a href="#3-setup-and-configure-jfrog-artifactory-version-652-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Setup and Configure Jfrog Artifactory Version 6.5.2 <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<p>For installing and setting up Jfrog, following steps <a href="//jfrog.com/confluence/display/RTF/Installing+Artifactory">here</a> need to be followed.<br/>
Once the setup is complete, please add the following remote repositories to your Jfrog configuration and point them to libs-release virtual repository:</p>
<ul>
<li><a href="//repo.maven.apache.org/maven2/"><strong>Maven Central</strong></a></li>
<li><a href="//jcenter.bintray.com"><strong>Jcentre</strong></a></li>
<li><a href="http://maven.openimaj.org"><strong>Openimaj</strong></a></li>
</ul>
<p>To configure Maven to resolve artifacts through Artifactory you need to modify the settings.xml of Jenkins machine's m2_home to point to JFrog.<br/>
To generate these settings, go to  Artifact Repository Browser of the Artifacts module, select Set Me Up. In the Set Me Up dialog, set Maven in the Tool field and click &quot;Generate Maven Settings&quot;. For more information on artifactory configuration refer <a href="//jfrog.com/confluence/display/RTF/Maven+Repository">here</a></p>
<p><strong>NOTE</strong> JFrog Artifactory setup by MOSIP is open to public for read only access. So if any of the modules are dependent on previous modules, that you don't have built, you need to connect to our JFrog server to pull those dependencies. For doing that, in the settings.xml file that you generated above, replace url of ID with repository snapshot and release to our Jfrog URLs which will be : </br></p>
<ol>
<li><code>&lt;url&gt;http://&lt;abcd&gt;.mosip.io/artifactory/libs-snapshot&lt;/url&gt;</code> for libs-snapshot</li>
<li><code>&lt;url&gt;http://&lt;abcd&gt;.mosip.io/artifactory/libs-release&lt;/url&gt;</code> for libs-release</li>
</ol>
<p>Once you are done with pulling the dependencies you need, you can replace it back to your Jfrog URLs. <br/>
Also if you are planning to import all versions of the Mosip modules in Jfrog to your VM or Jfrog, make sure you have enough space in your Jfrog VM where you will be importing these dependencies.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="4-setup-and-configure-sonarqube-version-73-table-of-content"></a><a href="#4-setup-and-configure-sonarqube-version-73-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Setup and Configure SonarQube version 7.3 <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<p>SonarQube server can be setup by following single instructions given <a href="//docs.sonarqube.org/latest/setup/get-started-2-minutes/">here</a>.<br/>
For configuring SonarQube with Jenkins, steps given <a href="//docs.sonarqube.org/display/SCAN/Analyzing+with+SonarQube+Scanner+for+Jenkins">here</a> can be followed.</p>
<p>Steps to install SonarQube on Ubuntu 16.04</p>
<p>**   Perform a system update**</p>
<pre><code class="hljs"> * sudo apt-get update

 * sudo apt-get -y upgrade
</code></pre>
<p>**   Install JDK**</p>
<pre><code class="hljs"> * sudo add-apt-repository ppa:webupd8team/java

 * sudo apt-get update

 * sudo apt install oracle-java8-installer
</code></pre>
<p>We can now check the version of Java by typing:</p>
<pre><code class="hljs"> * java -version
</code></pre>
<p>**   Install and configure PostgreSQL**</p>
<pre><code class="hljs"> * sudo sh -c 'echo &quot;deb http://apt.postgresql.org/pub/repos/apt/ `lsb_release -cs`-pgdg main&quot; &gt;&gt;
   /etc/apt/sources.list.d/pgdg.list'

 * wget -q https://www.postgresql.org/media/keys/ACCC4CF8.asc -O - | sudo apt-key add -

 * sudo apt-get -y install postgresql postgresql-contrib
</code></pre>
<p>Start PostgreSQL server and enable it to start automatically at boot time by running:</p>
<pre><code class="hljs"> * sudo systemctl start postgresql

 * sudo systemctl enable postgresql
</code></pre>
<p>Change the password for the default PostgreSQL user.</p>
<pre><code class="hljs"> * sudo passwd postgres
</code></pre>
<p>Switch to the postgres user.</p>
<pre><code class="hljs"> * su - postgres
</code></pre>
<p>Create a new user by typing:</p>
<pre><code class="hljs"> * createuser sonar
</code></pre>
<p>Switch to the PostgreSQL shell.</p>
<pre><code class="hljs"> * psql
</code></pre>
<p>Set a password for the newly created user for SonarQube database.</p>
<pre><code class="hljs"> * ALTER USER sonar WITH ENCRYPTED password 'StrongPassword';
</code></pre>
<p>Create a new database for PostgreSQL database by running:</p>
<pre><code class="hljs"> * CREATE DATABASE sonar OWNER sonar;
</code></pre>
<p>Exit from the psql shell:</p>
<pre><code class="hljs"> * \q
</code></pre>
<p>Switch back to the sudo user by running the exit command.</p>
<p>**   Download and configure SonarQube**</p>
<pre><code class="hljs"> * wget https://sonarsource.bintray.com/Distribution/sonarqube/sonarqube-6.4.zip
</code></pre>
<p>Install unzip by running:</p>
<pre><code class="hljs"> * apt-get -y install unzip
</code></pre>
<p>Unzip the archive using the following command.</p>
<pre><code class="hljs"> * sudo unzip sonarqube-6.4.zip -d /opt
</code></pre>
<p>Rename the directory:</p>
<pre><code class="hljs"> * sudo mv /opt/sonarqube-6.4 /opt/sonarqube

 * sudo nano /opt/sonarqube/conf/sonar.properties
</code></pre>
<p>Find the following lines.</p>
<pre><code class="hljs"> #sonar.jdbc.username=

 #sonar.jdbc.password=
</code></pre>
<p>Uncomment and provide the PostgreSQL username and password of the database that we have created earlier. It should look like:</p>
<pre><code class="hljs"> sonar.jdbc.username=sonar

 sonar.jdbc.password=StrongPassword
</code></pre>
<p>Next, find:</p>
<p>#sonar.jdbc.url=jdbc:<a href="postgresql://localhost/sonar">postgresql://localhost/sonar</a></p>
<p>Uncomment the line, save the file and exit from the editor.</p>
<p>**   Configure Systemd service**</p>
<p>SonarQube can be started directly using the startup script provided in the installer package. As a matter of convenience, you should setup a Systemd unit file for SonarQube.</p>
<pre><code class="hljs"> * nano /etc/systemd/system/sonar.service

 Populate the file with:

 [Unit]

 Description=SonarQube service

 After=syslog.target network.target

 [Service]

 Type=forking

 ExecStart=/opt/sonarqube/bin/linux-x86-64/sonar.sh start

 ExecStop=/opt/sonarqube/bin/linux-x86-64/sonar.sh stop

 User=root

 Group=root  

 Restart=always

 [Install]

 WantedBy=multi-user.target
</code></pre>
<p>Start the application by running:</p>
<pre><code class="hljs"> * sudo systemctl start sonar
</code></pre>
<p>Enable the SonarQube service to automatically start at boot time.</p>
<pre><code class="hljs"> * sudo systemctl enable sonar
</code></pre>
<p>To check if the service is running, run:</p>
<pre><code class="hljs"> * sudo systemctl status sonar
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="5-setup-and-configure-docker-registry-table-of-content"></a><a href="#5-setup-and-configure-docker-registry-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Setup and Configure Docker Registry <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<p>In this step we will setup and configure a private docker registry, which will be basic authenticated, SSL secured. In our setup we are using azure blobs as storage for our docker images. More options for configuring registry can be found <a href="//docs.docker.com/registry/configuration/">here</a>
We are deploying Docker registry as Containerized services. For setting up the registry, <a href="//docs.docker.com/install/">Docker</a> and <a href="//docs.docker.com/compose/install/">Docker Compose</a> need to be installed. We have setted up the registry in a machine with Redhat 7.6 installed.<br/>
Once installation is done, the yaml files which we will be using to setup the registry can be found in this <a href="https://github.com/mosip/mosip-infra/tree/master/deployment/cloud/docker-registry">link</a>
We are using Registry image : registry:2.5.1, registry with any other version can be deployed from <a href="//hub.docker.com/_/registry">here</a>. <br/>For routing purpose, we are using HAproxy image dockercloud/haproxy:1.6.2, other options such as ngnix etc. can also be used for the same purpose.<br/>
We have the following docker-compose files, under this <a href="https://github.com/mosip/mosip-infra/tree/master/deployment/cloud/docker-registry">link</a></p>
<ol>
<li><strong>registry-docker-compose.yml:</strong>  For basic registry and haproxy setup.</li>
<li><strong>registry-docker-compose-basic-authentication.yml:</strong>  For securing the docker registry through base authentication.
For basic authentication, you have to setup a htpasswd file and add a simple user to it. For generating this htpaswd file:<br/></li>
</ol>
<ul>
<li>Create Htpasswd_dir directory<br/>
<code>mkdir -p ~/htpasswd_dir</code><br/></li>
<li>Create htpasswd file with your username and password<br/>
<code>docker run --rm --entrypoint htpasswd registry:2 -Bbn &lt;username&gt; &quot;&lt;password&gt;&quot; &gt; ~/htpasswd_dir/htpasswd</code><br/></li>
<li>In the registry-docker-compose-basic-authentication.yml file, replace &lt;YOUR-REALM-NAME&gt; and &lt;YOUR-HTPASSWD-PATH&gt; with
specific values.</li>
</ul>
<ol start="3">
<li><strong>registry-docker-compose-azure-storage.yml:</strong>  This file is used for configuring azure blob storage. We are assuming that Azure blob has already been configured by you. Replace REGISTRY_STORAGE_AZURE_ACCOUNTNAME, REGISTRY_STORAGE_AZURE_ACCOUNTKEY, REGISTRY_STORAGE_AZURE_CONTAINER with appropriate values configured by you while setting up azure blob storage.</li>
<li><strong>registry-docker-compose-tls-enabled.yml:</strong>  We are using <strong>Let's Encrypt</strong>, CA signed SSL certificates. Documentation of Let's Encrypt can be referred <a href="//letsencrypt.org/getting-started/">here</a>
Once Certificates have been generated, replace the &lt;REGISTRY_HTTP_TLS_CERTIFICATE&gt; property and &lt;REGISTRY_HTTP_TLS_KEY&gt; property in registry-docker-compose-tls-enabled.yml with appropriate values.
After completing all the above changes, use docker-compose tool to bring up the container using the following command:<br/>
<code>docker-compose -f registry-docker-compose.yml -f registry-docker-compose-basic-authentication.yml -f registry-docker-compose-azure-storage.yml -f registry-docker-compose-tls-enabled.yml up -d</code><br/>
Once the registry is up and running, variables <strong>registryUrl</strong>, <strong>registryName</strong>, <strong>registryCredentials</strong> can be configured accordingly in Jenkinsfile.<br/> For configuring registry Credentials in Jenkins, Username/Password credentials need to be added in Jenkins Global Credentials and credential ID needs to be provided in <strong>registryCredentials</strong> variable in all the Jenkinsfiles.</li>
</ol>
<hr>
<h2><a class="anchor" aria-hidden="true" id="6-installing-external-dependencies-table-of-content"></a><a href="#6-installing-external-dependencies-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. Installing External Dependencies <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<h3><a class="anchor" aria-hidden="true" id="61-install-and-use-postgresql-version-102-on-rhel-75"></a><a href="#61-install-and-use-postgresql-version-102-on-rhel-75" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.1 Install and use PostgreSql Version 10.2 on RHEL 7.5</h3>
<p>Often simply Postgres, is an object-relational database management system (ORDBMS) with an emphasis on extensibility and standards compliance. It can handle workloads ranging from small single-machine applications to large Internet-facing applications (or for data warehousing) with many concurrent users
Postgresql Prerequisites
On a Linux or Mac system, you must have superuser privileges to perform a PostgreSQL installation. To perform an installation on a Windows system, you must have administrator privileges.</p>
<h4><a class="anchor" aria-hidden="true" id="steps-to-install-postgresql-in-rhel-75"></a><a href="#steps-to-install-postgresql-in-rhel-75" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Steps to install Postgresql in RHEL-7.5</h4>
<h5><a class="anchor" aria-hidden="true" id="download-and-install-postgresql"></a><a href="#download-and-install-postgresql" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Download and install PostgreSQL.</h5>
<pre><code class="hljs"><span class="hljs-variable">$ </span>sudo yum install <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/download.postgresql.org/pub</span><span class="hljs-regexp">/repos/yum</span><span class="hljs-regexp">/10/redhat</span><span class="hljs-regexp">/rhel-7-x86_64/pgdg</span>-redhat10<span class="hljs-number">-10-2</span>.noarch.rpm
<span class="hljs-variable">$ </span>sudo  yum-config-manager --disable pgdg95
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="checking-the-postgresql-packages"></a><a href="#checking-the-postgresql-packages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>checking  the postgresql packages</h5>
<pre><code class="hljs"><span class="hljs-variable">$ </span>sudo yum update
</code></pre>
<p>$ sudo yum list postgresql*</p>
<pre><code class="hljs">##### Installation command
</code></pre>
<p>$ sudo yum install postgresql10 postgresql10-server</p>
<pre><code class="hljs"><span class="hljs-variable">$sudo</span> <span class="hljs-regexp">/usr/</span>pgsql-<span class="hljs-number">10</span><span class="hljs-regexp">/bin/</span>postgresql-<span class="hljs-number">10</span>-setup initdb
</code></pre>
<p>$sudo systemctl enable postgresql-10</p>
<pre><code class="hljs">##### Postgresql service stop/start/restart command
</code></pre>
<p>$ sudo systemctl start postgresql-10</p>
<pre><code class="hljs">$ sudo systemctl status postgresql<span class="hljs-number">-10</span>
</code></pre>
<p>$ sudo systemctl stop postgresql-10</p>
<pre><code class="hljs"><span class="hljs-keyword">To</span> changing<span class="hljs-built_in"> default port </span>5432 <span class="hljs-keyword">to</span> 9001 <span class="hljs-keyword">and</span><span class="hljs-built_in"> connection </span>+ buffer size we need <span class="hljs-keyword">to</span> <span class="hljs-builtin-name">edit</span> the postgresql.conf file <span class="hljs-keyword">from</span> below path
PostgreSQL is running on<span class="hljs-built_in"> default port </span>5432.
you decide <span class="hljs-keyword">to</span> change the<span class="hljs-built_in"> default </span>port, please ensure that your new<span class="hljs-built_in"> port </span>number does <span class="hljs-keyword">not</span> conflict with any services running on that port.

<span class="hljs-comment">##### Steps to change the default port :</span>

<span class="hljs-comment">###### Open the file  and modify the below changes</span>
</code></pre>
<p>$ sudo vi /var/lib/pgsql/10/data/postgresql.conf</p>
<pre><code class="hljs">listen_addresses = <span class="hljs-string">'*'</span>   (changed <span class="hljs-keyword">to</span> * instead of local host )<span class="hljs-built_in">
port </span>= 9001       ( uncomment <span class="hljs-attribute">port</span>=5432 <span class="hljs-keyword">and</span> change the<span class="hljs-built_in"> port </span>number
<span class="hljs-comment">###### Open the port 9001 from the VM</span>
</code></pre>
<p>$  sudo firewall-cmd --zone=public --add-port=9001/tcp --permanent</p>
<pre><code class="hljs">$  sudo firewall-<span class="hljs-keyword">cmd</span><span class="bash"> --reload</span>
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="to-increase-the-buffer-size-and-number-of-postgresql-connection-same-fine-modify-the-below-changes-also"></a><a href="#to-increase-the-buffer-size-and-number-of-postgresql-connection-same-fine-modify-the-below-changes-also" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>To increase the buffer size and number of postgreSql connection  same fine modify the below changes also</h5>
<pre><code class="hljs">$ sudo vi /var/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">pgsql</span>/10/<span class="hljs-title">data</span>/<span class="hljs-title">postgresql</span>.<span class="hljs-title">conf</span></span>
</code></pre>
<p>unix_socket_directories = '/var/run/postgresql, /tmp'
max_connections = 1000<br>
shared_buffers = 2GB</p>
<pre><code class="hljs">$ sudo systemctl start postgresql<span class="hljs-number">-10</span>
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="to-change-the-default-password"></a><a href="#to-change-the-default-password" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>To change the default password</h5>
<p>Login to postgrsql</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>sudo su postgres
</code></pre>
<p>bash-4.2$    psql -p 9001</p>
<pre><code class="hljs"><span class="hljs-attr">postgres</span>=<span class="hljs-comment"># \password postgres</span>
</code></pre>
<p>Enter new password:</p>
<pre><code class="hljs">Enter <span class="hljs-keyword">it</span> again:
</code></pre>
<p>postgres=# \q</p>
<pre><code class="hljs">sudo systemctl restart postgresql<span class="hljs-number">-10</span>
</code></pre>
<p>It will ask new password to login to postgresql</p>
<p>####### example  for sourcing the sql file form command line</p>
<pre><code class="hljs">$ psql <span class="hljs-attribute">--username</span>=postgres <span class="hljs-attribute">--host</span>=&lt;server ip&gt; <span class="hljs-attribute">--port</span>=9001 <span class="hljs-attribute">--dbname</span>=postgres
</code></pre>
<p>Open the file <br/>
$ sudo vim /var/lib/pgsql/10/data/pg_hba.conf</p>
<h6><a class="anchor" aria-hidden="true" id="default-lines-are-present-in-pg_habconf-file-br"></a><a href="#default-lines-are-present-in-pg_habconf-file-br" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Default lines are present in pg_hab.conf file <br/></h6>
<p>TYPE  DATABASE        USER            ADDRESS                 METHOD <br/></p>
<p>local   all             all                                     peer <br/>
host    all             all             127.0.0.1/32            ident <br/>
host    all             all             ::1/128                 ident <br/>
local   replication     all                                     peer  <br/>
host    replication     all             127.0.0.1/32            ident <br/>
host    replication     all             ::1/128                 ident <br/></p>
<h6><a class="anchor" aria-hidden="true" id="modify-with-below-changes-in-file-var-lib-pgsql-10-data-pg_hbaconf"></a><a href="#modify-with-below-changes-in-file-var-lib-pgsql-10-data-pg_hbaconf" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modify  with below changes in file  /var/lib/pgsql/10/data/pg_hba.conf</h6>
<p>local   all             all                                     md5 <br/>
host    all             all             127.0.0.1/32            ident <br/>
host    all             all             0.0.0.0/0               md5 <br/>
host    all             all             ::1/128                 ident <br/>
local   replication     all                                     peer <br/>
host    replication     all             127.0.0.1/32            ident <br/>
host    replication     all             ::1/128                 ident <br/></p>
<pre><code class="hljs">sudo systemctl restart postgresql<span class="hljs-number">-10</span>
</code></pre>
<pre><code class="hljs">sudo systemctl status postgresql<span class="hljs-number">-10</span>
</code></pre>
<p>Reference link:
<a href="https://www.tecmint.com/install-postgresql-on-centos-rhel-fedora">https://www.tecmint.com/install-postgresql-on-centos-rhel-fedora</a></div></p>
<hr>
<h3><a class="anchor" aria-hidden="true" id="62-install-and-use-nginx-version-1158-on-rhel-75"></a><a href="#62-install-and-use-nginx-version-1158-on-rhel-75" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.2 Install and use Nginx Version-1.15.8 on RHEL 7.5</h3>
<p>We are using nginx for webserver andalso proxy server for MOSIP project
Create the file named /etc/yum.repos.d/nginx.repo using a text editor such as vim command</p>
<pre><code class="hljs">$ sudo vi /etc/yum<span class="hljs-selector-class">.repos</span>.d/nginx<span class="hljs-selector-class">.repo</span>
</code></pre>
<p>Append following for RHEL 7.5</p>
<pre><code class="hljs"><span class="hljs-section">[nginx]</span>   
<span class="hljs-attr">name</span>=nginx repo
<span class="hljs-attr">baseurl</span>=http://nginx.org/packages/mainline/rhel/<span class="hljs-number">7</span>/<span class="hljs-variable">$basearch</span>/
<span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">0</span>
<span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span>
</code></pre>
<p>After updating repo, please run following commands to install and enable nginx -</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>sudo yum update
</code></pre>
<p>$ sudo yum install nginx</p>
<pre><code class="hljs">$ sudo systemctl <span class="hljs-builtin-name">enable</span> nginx  
</code></pre>
<p>To start, stop, restart or get status of nginx use the following commands -</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>sudo systemctl start nginx

<span class="hljs-variable">$ </span>sudo systemctl stop nginx

<span class="hljs-variable">$ </span>sudo systemctl restart nginx

<span class="hljs-variable">$ </span>sudo systemctl status nginx
</code></pre>
<p>To edit files use a text editor such as vi</p>
<pre><code class="hljs">$ sudo <span class="hljs-keyword">vi</span> /etc/nginx/nginx.<span class="hljs-keyword">conf</span>
</code></pre>
<p>Example to  configure the nginx for dev environment -</p>
<pre><code class="hljs"> <span class="hljs-attr">user</span>  <span class="hljs-string">madmin;</span>
 <span class="hljs-attr">worker_processes</span>  <span class="hljs-string">2;</span>
 <span class="hljs-attr">error_log</span>  <span class="hljs-string">/var/log/nginx/error.log warn;</span>
 <span class="hljs-attr">pid</span>        <span class="hljs-string">/var/run/nginx.pid;</span>
 <span class="hljs-attr">events</span> <span class="hljs-string">{</span>
     <span class="hljs-attr">worker_connections</span>  <span class="hljs-string">1024;</span>
 <span class="hljs-attr">}</span>

 <span class="hljs-attr">http</span> <span class="hljs-string">{</span>
         <span class="hljs-attr">include</span>       <span class="hljs-string">/etc/nginx/mime.types;</span>
         <span class="hljs-attr">default_type</span>  <span class="hljs-string">application/octet-stream;</span>
         <span class="hljs-attr">log_format</span>  <span class="hljs-string">main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
         <span class="hljs-meta">'$status</span> <span class="hljs-string">$body_bytes_sent "$http_referer" '</span>
         <span class="hljs-meta">'"$http_user_agent"</span> <span class="hljs-string">"$http_x_forwarded_for"';</span>
         <span class="hljs-attr">access_log</span>  <span class="hljs-string">/var/log/nginx/access.log  main;</span>
         <span class="hljs-attr">client_max_body_size</span> <span class="hljs-string">10m;</span>
         <span class="hljs-attr">sendfile</span>        <span class="hljs-string">on;</span>
         <span class="hljs-attr">tcp_nopush</span>     <span class="hljs-string">on;</span>
         <span class="hljs-attr">proxy_max_temp_file_size</span> <span class="hljs-string">0;</span>
         <span class="hljs-attr">sendfile_max_chunk</span> <span class="hljs-string">10m;</span>
         <span class="hljs-attr">keepalive_timeout</span>  <span class="hljs-string">65;</span>
         <span class="hljs-attr">gzip</span> <span class="hljs-string">on;</span>
         <span class="hljs-attr">gzip_disable</span> <span class="hljs-string">"msie6";</span>
         <span class="hljs-attr">gzip_vary</span> <span class="hljs-string">on;</span>
         <span class="hljs-attr">gzip_proxied</span> <span class="hljs-string">any;</span>
         <span class="hljs-attr">gzip_comp_level</span> <span class="hljs-string">6;</span>
         <span class="hljs-attr">gzip_buffers</span> <span class="hljs-string">16 8k;</span>
         <span class="hljs-attr">gzip_http_version</span> <span class="hljs-string">1.1;</span>
         <span class="hljs-attr">gzip_min_length</span> <span class="hljs-string">256;</span>
         <span class="hljs-attr">gzip_types</span> <span class="hljs-string">text/plain text/css application/json application/x-javascript text/xml application/xml application/javascript application/octet-stream application/xml+rss text/javascript application/vnd.ms-fontobject application/x-font-ttf font/opentype image/svg+xml image/x-icon image/png image/jpg;</span>
<span class="hljs-comment">         #include /etc/nginx/conf.d/*.conf;</span>
<span class="hljs-comment">

###### HTTP configuration ######</span>

  <span class="hljs-attr">server</span> <span class="hljs-string">{</span>
         <span class="hljs-attr">listen</span>  <span class="hljs-string">80 default_server;</span>
         <span class="hljs-attr">listen</span> <span class="hljs-string">[::]:80 default_server ipv6only=on;</span>
         <span class="hljs-attr">server_name</span> <span class="hljs-string">&lt;your-domain-name&gt;;</span>

         <span class="hljs-attr">location</span> <span class="hljs-string">/ {</span>
                                     <span class="hljs-attr">root</span> <span class="hljs-string">/usr/share/nginx/html;</span>
                 <span class="hljs-attr">index</span>  <span class="hljs-string">index.html index.htm;</span>
                 <span class="hljs-attr">proxy_http_version</span> <span class="hljs-string">1.1;</span>
                 <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Upgrade $http_upgrade;</span>
                 <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Connection "upgrade";</span>
                 <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Host $host;</span>
                 <span class="hljs-attr">proxy_connect_timeout</span>                   <span class="hljs-string">3600s;</span>
                 <span class="hljs-attr">proxy_send_timeout</span>                      <span class="hljs-string">3600s;</span>
                 <span class="hljs-attr">proxy_read_timeout</span>                      <span class="hljs-string">3600s;</span>
         <span class="hljs-attr">}</span>
         <span class="hljs-attr">return</span> <span class="hljs-string">301 https://$host$request_uri;</span>
     <span class="hljs-attr">}</span>
<span class="hljs-comment">
###### HTTPS configuration for your domain ######</span>
     <span class="hljs-attr">server</span> <span class="hljs-string">{</span>

             <span class="hljs-attr">client_max_body_size</span> <span class="hljs-string">20M;</span>
                 <span class="hljs-attr">listen</span> <span class="hljs-string">*:443 ssl http2;</span>
                 <span class="hljs-attr">listen</span> <span class="hljs-string">[::]:443 ssl http2;</span>
                 <span class="hljs-attr">server_name</span> <span class="hljs-string">dev.mosip.io;</span>
                 <span class="hljs-attr">ssl</span> <span class="hljs-string">on;</span>
                 <span class="hljs-attr">ssl_certificate</span>         <span class="hljs-string">&lt;your-letsencrypt-fullchainpem-path&gt;;</span>
                 <span class="hljs-attr">ssl_certificate_key</span>   <span class="hljs-string">&lt;your-letsencrypt-privatekey-pem-path&gt;;</span>
         <span class="hljs-attr">location</span> <span class="hljs-string">/v1/keymanager/ {</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Host $host;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Real-IP $remote_addr;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-For $proxy_add_x_forwarded_for;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-Proto $scheme;</span>
<span class="hljs-comment">                     #proxy_set_header Cookie $http_cookie;</span>
                     <span class="hljs-attr">proxy_pass</span>  <span class="hljs-string">http://&lt;your-keymanager-vm-ip&gt;:&lt;port&gt;/v1/keymanager/;</span>
             <span class="hljs-attr">}</span>

              <span class="hljs-attr">location</span> <span class="hljs-string">/registrationprocessor/v1/packetreceiver/ {</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Host $host;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Real-IP $remote_addr;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-For $proxy_add_x_forwarded_for;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-Proto $scheme;</span>
                    <span class="hljs-attr">proxy_pass</span>  <span class="hljs-string">http://&lt;your-dmz-vm-ip&gt;:&lt;port&gt;/registrationprocessor/v1/packetreceiver/;</span>
             <span class="hljs-attr">}</span>

              <span class="hljs-attr">location</span> <span class="hljs-string">/registrationprocessor/v1/registrationstatus/ {</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Host $host;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Real-IP $remote_addr;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-For $proxy_add_x_forwarded_for;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-Proto $scheme;</span>
                     <span class="hljs-attr">proxy_pass</span>  <span class="hljs-string">http://&lt;your-dmz-vm-ip&gt;:&lt;port&gt;/registrationprocessor/v1/registrationstatus/;</span>

             <span class="hljs-attr">}</span>

             <span class="hljs-attr">location</span> <span class="hljs-string">/ {</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">Host $host;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Real-IP $remote_addr;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-For $proxy_add_x_forwarded_for;</span>
<span class="hljs-comment">                     #proxy_set_header X-Forwarded-Host $proxy_add_x_forwarded_for;</span>
                     <span class="hljs-attr">proxy_set_header</span> <span class="hljs-string">X-Forwarded-Proto $scheme;</span>
                     <span class="hljs-attr">proxy_connect_timeout</span>                   <span class="hljs-string">3600s;</span>
                     <span class="hljs-attr">proxy_send_timeout</span>                      <span class="hljs-string">3600s;</span>
                     <span class="hljs-attr">proxy_read_timeout</span>                      <span class="hljs-string">3600s;</span>
                     <span class="hljs-attr">proxy_pass</span> <span class="hljs-string">https://&lt;your-dev-k8-cluster-endpoint&gt;; //kubernetes end point</span>
<span class="hljs-comment">                     #proxy_intercept_errors on;</span>
<span class="hljs-comment">                     #error_page 301 302 307 = @handle_redirects;</span>

             <span class="hljs-attr">}</span>
  <span class="hljs-attr">}</span>
 <span class="hljs-attr">}</span>
</code></pre>
<p>Use below command to open the port 80/443 from RHEL 7.5 VM</p>
<pre><code class="hljs">$ sudo firewall-cmd <span class="hljs-attribute">--zone</span>=public <span class="hljs-attribute">--add-port</span>=80/tcp --permanent
$ sudo firewall-cmd <span class="hljs-attribute">--zone</span>=public <span class="hljs-attribute">--add-port</span>=443/tcp --permanent
$ sudo firewall-cmd --reload
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="generate-ssl-tls-for-https"></a><a href="#generate-ssl-tls-for-https" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Generate SSL/TLS for HTTPS -</h4>
<p>RHEL 7  version, these are the following commands you have to run to generate certificates for nginx server.</p>
<ol>
<li><p>wget <a href="https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a>
It will install EPEL script for RHEL 7 OS. It is same as PPA for Ubuntu, it will install some extra packages for enterprise linux edition.
You can read more about it <a href="https://fedoraproject.org/wiki/EPEL">https://fedoraproject.org/wiki/EPEL</a>.</p></li>
<li><p>This command will run the EPEL install scripts and enable the EPEL packages for RHEL7</p>
<pre><code class="hljs"><span class="hljs-selector-tag">sudo</span> <span class="hljs-selector-tag">yum</span> <span class="hljs-selector-tag">install</span> <span class="hljs-selector-tag">epel-release-latest-7</span><span class="hljs-selector-class">.noarch</span><span class="hljs-selector-class">.rpm</span>
</code></pre></li>
<li><p>This will list all the EPEL packages available for used.</p>
<pre><code class="hljs">yum --disablerepo=<span class="hljs-string">"*"</span> --enablerepo=<span class="hljs-string">"epel"</span>  <span class="hljs-built_in">list</span> <span class="hljs-built_in">available</span>
</code></pre></li>
<li><p>Check for python2-certbot-nginx package in EPEL Packages.</p>
<pre><code class="hljs">yum <span class="hljs-params">--disablerepo=</span><span class="hljs-string">"*"</span> <span class="hljs-params">--enablerepo=</span><span class="hljs-string">"epel"</span> search python2-certbot-nginx
</code></pre></li>
<li><p>This will install python certbot for nginx into VM.</p>
<pre><code class="hljs">sudo yum <span class="hljs-keyword">install</span> python2-certbot-nginx
</code></pre></li>
<li><p>This will generate the certificate for VM.</p>
<pre><code class="hljs">sudo certbot <span class="hljs-comment">--nginx certonly</span>
</code></pre></li>
</ol>
<p><strong>Troubleshooting:</strong> If you facing getting this issue in nginx <br/> (13: Permission denied) while connecting to upstream:[nginx] <br/>
Please  run below command -</p>
<pre><code class="hljs"><span class="hljs-meta"><span class="hljs-meta-keyword">$sudo</span> setsebool -P httpd_can_network_connect 1</span>
</code></pre>
<p>or refer link -
<a href="https://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx">https://stackoverflow.com/questions/23948527/13-permission-denied-while-connecting-to-upstreamnginx</a><br/></p>
<p><strong>Note: Certficates will be generated at, /etc/letsencrypt/live/&lt;domain_name&gt;/ directory. cert.pem is the certificate and privkey.pem is private key. We are using Let's Encrypt, CA signed SSL certificates. Documentation of Let's Encrypt can be referred <a href="//letsencrypt.org/getting-started/">here</a></strong></p>
<h3><a class="anchor" aria-hidden="true" id="63-clam-antivirus-version-01010"></a><a href="#63-clam-antivirus-version-01010" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.3 Clam AntiVirus Version 0.101.0</h3>
<p>ClamAV is a free, cross-platform and open-source antivirus software toolkit able to detect many types of malicious software, including viruses.</p>
<h4><a class="anchor" aria-hidden="true" id="steps-to-install-clamav-in-rhel-75"></a><a href="#steps-to-install-clamav-in-rhel-75" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Steps to install ClamAV in RHEL-7.5</h4>
<p>To install clamAV first we need to install EPEL Repository:</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>sudo yum install -y <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/dl.fedoraproject.org/pub</span><span class="hljs-regexp">/epel/epel</span>-release-latest<span class="hljs-number">-7</span>.noarch.rpm
</code></pre>
<p>After that we need to install ClamAV and its related tools.</p>
<pre><code class="hljs">$ yum -y install clamav-server clamav-data clamav-update clamav-filesystem clamav clamav-scanner-systemd clamav-devel clamav-<span class="hljs-class"><span class="hljs-keyword">lib</span> <span class="hljs-title">clamav</span>-<span class="hljs-title">server</span>-<span class="hljs-title">systemd</span></span>
</code></pre>
<p>After completion of above steps, we need to configure installed ClamAV. This can be done via editing <strong>/etc/clamd.d/scan.conf</strong>. In this file we have to remove <code>Example</code> lines. So that ClamAV can use this file's configurations. We can easily do it via running following command -</p>
<pre><code class="hljs">$ sed -<span class="hljs-selector-tag">i</span> <span class="hljs-string">'/^Example/d'</span> /etc/clamd.d/scan<span class="hljs-selector-class">.conf</span>
</code></pre>
<p>Another thing we need to do in this file is to define our TCP server type. Open this file using -</p>
<pre><code class="hljs">$ <span class="hljs-keyword">vim</span> /etc/clamd.d/scan.<span class="hljs-keyword">conf</span>
</code></pre>
<p>here this we need to uncomment line with <code>#LocalSocket /var/run/clamd.scan/clamd.sock</code>. Just remove <strong>#</strong> symbol from the beginning of the line.</p>
<p>Now we need to configure FreshClam so that it can update ClamAV db automatically. For doing that follow below steps -</p>
<p>First create a backup of original FreshClam Configuration file -</p>
<pre><code class="hljs">$ cp /etc/freshclam<span class="hljs-selector-class">.conf</span> /etc/freshclam<span class="hljs-selector-class">.conf</span><span class="hljs-selector-class">.bak</span>
</code></pre>
<p>In this <strong>freshclam.conf</strong> file, Here also we need to remove <strong>Example</strong> line from the file. Run following command to delete all <code>Example</code> lines-</p>
<pre><code class="hljs">$ sed -<span class="hljs-selector-tag">i</span> <span class="hljs-string">'/^Example/d'</span> /etc/freshclam<span class="hljs-selector-class">.conf</span>
</code></pre>
<p>Test freshclam via running-</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>freshclam
</code></pre>
<p>After running above command you should see an output similar to this -</p>
<pre><code class="hljs"><span class="hljs-string">ClamAV</span> <span class="hljs-string">update</span> <span class="hljs-string">process</span> <span class="hljs-string">started</span> <span class="hljs-string">at</span> <span class="hljs-string">Thu</span> <span class="hljs-string">May</span> <span class="hljs-number">23</span> <span class="hljs-number">07</span><span class="hljs-string">:25:44</span> <span class="hljs-number">2019</span>
<span class="hljs-string">.</span>
<span class="hljs-string">.</span>
<span class="hljs-string">.</span>
<span class="hljs-string">.</span>
<span class="hljs-string">main.cvd</span> <span class="hljs-string">is</span> <span class="hljs-string">up</span> <span class="hljs-string">to</span> <span class="hljs-string">date</span> <span class="hljs-string">(version:</span> <span class="hljs-number">58</span><span class="hljs-string">,</span> <span class="hljs-attr">sigs:</span> <span class="hljs-number">4566249</span><span class="hljs-string">,</span> <span class="hljs-attr">f-level:</span> <span class="hljs-number">60</span><span class="hljs-string">,</span> <span class="hljs-attr">builder:</span> <span class="hljs-string">sigmgr)</span>
<span class="hljs-string">Downloading</span> <span class="hljs-string">daily-25584.cdiff</span> <span class="hljs-string">[100%]</span>
<span class="hljs-string">daily.cld</span> <span class="hljs-string">updated</span> <span class="hljs-string">(version:</span> <span class="hljs-number">25584</span><span class="hljs-string">,</span> <span class="hljs-attr">sigs:</span> <span class="hljs-number">1779512</span><span class="hljs-string">,</span> <span class="hljs-attr">f-level:</span> <span class="hljs-number">63</span><span class="hljs-string">,</span> <span class="hljs-attr">builder:</span> <span class="hljs-string">raynman)</span>
<span class="hljs-string">bytecode.cld</span> <span class="hljs-string">is</span> <span class="hljs-string">up</span> <span class="hljs-string">to</span> <span class="hljs-string">date</span> <span class="hljs-string">(version:</span> <span class="hljs-number">331</span><span class="hljs-string">,</span> <span class="hljs-attr">sigs:</span> <span class="hljs-number">94</span><span class="hljs-string">,</span> <span class="hljs-attr">f-level:</span> <span class="hljs-number">63</span><span class="hljs-string">,</span> <span class="hljs-attr">builder:</span> <span class="hljs-string">anvilleg)</span>
<span class="hljs-string">Database</span> <span class="hljs-string">updated</span> <span class="hljs-string">(6345855</span> <span class="hljs-string">signatures)</span> <span class="hljs-string">from</span> <span class="hljs-string">database.clamav.net</span> <span class="hljs-string">(IP:</span> <span class="hljs-number">104.16</span><span class="hljs-number">.218</span><span class="hljs-number">.84</span><span class="hljs-string">)</span>
</code></pre>
<p>We will create a service of freshclam so that freshclam will run in the daemon mode and periodically check for updates throughout the day. To do that we will create a service file for freshclam -</p>
<pre><code class="hljs">$ vim /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">systemd</span>/<span class="hljs-title">system</span>/<span class="hljs-title">clam</span>-<span class="hljs-title">freshclam</span>.<span class="hljs-title">service</span></span>
</code></pre>
<p>And add below content -</p>
<pre><code class="hljs"><span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span> = freshclam scanner
<span class="hljs-attr">After</span> = network.target
<span class="hljs-section">
[Service]</span>
<span class="hljs-attr">Type</span> = forking
<span class="hljs-attr">ExecStart</span> = /usr/bin/freshclam -d -c <span class="hljs-number">4</span>
<span class="hljs-attr">Restart</span> = <span class="hljs-literal">on</span>-failure
<span class="hljs-attr">PrivateTmp</span> = <span class="hljs-literal">true</span>
<span class="hljs-attr">RestartSec</span> = <span class="hljs-number">20</span>sec
<span class="hljs-section">
[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
</code></pre>
<p>Now save and quit. Also reload the systemd daemon to refresh the changes -</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>systemctl daemon-reload
</code></pre>
<p>Next start and enable the freshclam service -</p>
<pre><code class="hljs"><span class="hljs-meta">$</span><span class="bash"> systemctl start clam-freshclam.service</span>
<span class="hljs-meta">
$</span><span class="bash"> systemctl <span class="hljs-built_in">enable</span> clam-freshclam.service</span>
</code></pre>
<p>Now freshclam setup is complete and our ClamAV db is upto date. We can continue setting up ClamAV. Now we will copy ClamAV service file to system service folder.</p>
<pre><code class="hljs">$ mv /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">systemd</span>/<span class="hljs-title">system</span>/<span class="hljs-title">clamd</span>@.<span class="hljs-title">service</span> /<span class="hljs-title">usr</span>/<span class="hljs-title">lib</span>/<span class="hljs-title">systemd</span>/<span class="hljs-title">system</span>/<span class="hljs-title">clamd</span>.<span class="hljs-title">service</span></span>
</code></pre>
<p>Since we have changed the name, we need to change it at the file that uses this service as well -</p>
<pre><code class="hljs">$ vim /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">systemd</span>/<span class="hljs-title">system</span>/<span class="hljs-title">clamd</span>@<span class="hljs-title">scan</span>.<span class="hljs-title">service</span></span>
</code></pre>
<p>Remove @ symbol from <code>.include /lib/systemd/system/clamd@.service</code> line and save the file.</p>
<p>We will edit Clamd service file now -</p>
<pre><code class="hljs">$ vim /usr/<span class="hljs-class"><span class="hljs-keyword">lib</span>/<span class="hljs-title">systemd</span>/<span class="hljs-title">system</span>/<span class="hljs-title">clamd</span>.<span class="hljs-title">service</span></span>
</code></pre>
<p>Add following lines at the end of clamd.service file.</p>
<pre><code class="hljs"><span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
</code></pre>
<p>And also remove <code>%i</code> symbol from various locations (ex: Description and ExecStart options). Note that at the end of the editing the service file should look something like this -</p>
<pre><code class="hljs"><span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span> = clamd scanner daemon
<span class="hljs-attr">Documentation</span>=man:clamd(<span class="hljs-number">8</span>) man:clamd.conf(<span class="hljs-number">5</span>) https://www.clamav.net/documents/
<span class="hljs-comment"># Check for database existence</span>
<span class="hljs-comment"># ConditionPathExistsGlob=@DBDIR@/main.{c[vl]d,inc}</span>
<span class="hljs-comment"># ConditionPathExistsGlob=@DBDIR@/daily.{c[vl]d,inc}</span>
<span class="hljs-attr">After</span> = syslog.target nss-lookup.target network.target
<span class="hljs-section">
[Service]</span>
<span class="hljs-attr">Type</span> = forking
<span class="hljs-attr">ExecStart</span> = /usr/sbin/clamd -c /etc/clamd.d/scan.conf
<span class="hljs-attr">Restart</span> = <span class="hljs-literal">on</span>-failure
<span class="hljs-section">
[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
</code></pre>
<p>Now finally start the ClamAV service.</p>
<pre><code class="hljs">$ systemctl <span class="hljs-literal">start</span> clamd.service
</code></pre>
<p>If it works fine, then enable this service and test the status of ClamAV service -</p>
<pre><code class="hljs"><span class="hljs-meta">$</span><span class="bash"> systemctl <span class="hljs-built_in">enable</span> clamd.service</span>
<span class="hljs-meta">
$</span><span class="bash"> systemctl status clamd.service</span>
</code></pre>
<p>Now in MOSIP we require ClamAV to be available on Port 3310. To expose ClamAV service on Port 3310, edit <code>scan.conf</code></p>
<pre><code class="hljs">$ <span class="hljs-keyword">vi</span> /etc/clamd.d/scan.<span class="hljs-keyword">conf</span>
</code></pre>
<p>and Uncomment <code>#TCPSocket 3310</code> by removing <strong>#</strong>. After that restart the clamd@scan service -</p>
<pre><code class="hljs"><span class="hljs-variable">$ </span>systemctl restart clamd<span class="hljs-variable">@scan</span>.service
</code></pre>
<p>Since we are exposing ClamAV on 3310 port, we need to allow incoming traffic through this port. In RHEL 7 run below command to add firewall rule -</p>
<pre><code class="hljs"><span class="hljs-comment">$</span> <span class="hljs-comment">sudo</span> <span class="hljs-comment">firewall</span><span class="hljs-literal">-</span><span class="hljs-comment">cmd</span> --<span class="hljs-comment">zone=public</span> --<span class="hljs-comment">add</span><span class="hljs-literal">-</span><span class="hljs-comment">port=3310/tcp</span> --<span class="hljs-comment">permanent</span>
<span class="hljs-comment">$</span> <span class="hljs-comment">sudo</span> <span class="hljs-comment">firewall</span><span class="hljs-literal">-</span><span class="hljs-comment">cmd</span> --<span class="hljs-comment">reload</span>
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="reference-link-link-https-wwwgolinuxcloudcom-steps-install-configure-clamav-antivirus-centos-linux-div"></a><a href="#reference-link-link-https-wwwgolinuxcloudcom-steps-install-configure-clamav-antivirus-centos-linux-div" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference link: <a href="https://www.golinuxcloud.com/steps-install-configure-clamav-antivirus-centos-linux&lt;/div&gt;">link</a></h5>
<h3><a class="anchor" aria-hidden="true" id="64-steps-to-install-and-configuration-ceph"></a><a href="#64-steps-to-install-and-configuration-ceph" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.4 Steps to Install and configuration CEPH</h3>
<p>NOTE: Required only if CEPH is used for packet storage.
Ceph is an open source software that provides massively scalable and distributed data store. It provides highly scalable object, block and file based storage under a unified system.</p>
<h5><a class="anchor" aria-hidden="true" id="1-on-red-hat-enterprise-linux-7-register-the-target-machine-with-subscription-manager-verify-your-subscriptions-and-enable-the-extras-repository-for-package-dependencies-for-example"></a><a href="#1-on-red-hat-enterprise-linux-7-register-the-target-machine-with-subscription-manager-verify-your-subscriptions-and-enable-the-extras-repository-for-package-dependencies-for-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. On Red Hat Enterprise Linux 7, register the target machine with subscription-manager, verify your subscriptions, and enable the “Extras” repository for package dependencies. For example:</h5>
<pre><code class="hljs">$ sudo subscription-manager repos --enable=rhel-7-server-extras-rpms
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="2-install-and-enable-the-extra-packages-for-enterprise-linux-epel-repository"></a><a href="#2-install-and-enable-the-extra-packages-for-enterprise-linux-epel-repository" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Install and enable the Extra Packages for Enterprise Linux (EPEL) repository:</h5>
<pre><code class="hljs">$ sudo yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="3-add-the-ceph-repository-to-your-yum-configuration-file-at-etc-yumreposd-cephrepo-with-the-following-command-replace-ceph-stable-release-with-a-stable-ceph-release-eg-luminous-for-example"></a><a href="#3-add-the-ceph-repository-to-your-yum-configuration-file-at-etc-yumreposd-cephrepo-with-the-following-command-replace-ceph-stable-release-with-a-stable-ceph-release-eg-luminous-for-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Add the Ceph repository to your yum configuration file at /etc/yum.repos.d/ceph.repo with the following command.  Replace {ceph-stable-release} with a stable Ceph release (e.g., luminous.) For example:</h5>
<pre><code class="hljs">cat &lt;&lt; EOM &gt; /etc/yum.repos.d/ceph.repo
[ceph-noarch]
name=Ceph noarch packages
baseurl=https://download.ceph.com/rpm-{ceph-stable-release}/el7/noarch
enabled=1  
gpgcheck=1
type=rpm-md
gpgkey=https://download.ceph.com/keys/release.asc
EOM
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="4-update-your-repository-and-install-ceph-deploy"></a><a href="#4-update-your-repository-and-install-ceph-deploy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Update your repository and install ceph-deploy:</h5>
<pre><code class="hljs">$ sudo yum update
$ sudo yum install ceph-deploy
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="ceph-node-setup"></a><a href="#ceph-node-setup" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CEPH NODE SETUP</h4>
<pre><code class="hljs">The admin node must have password-less SSH access to Ceph nodes. When ceph-deploy logs in to a Ceph node as a user, that particular user must have passwordless sudo privileges.
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="install-ntp"></a><a href="#install-ntp" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>INSTALL NTP</h4>
<pre><code class="hljs">We recommend installing NTP on Ceph nodes (especially on Ceph Monitor nodes) to prevent issues arising from clock drift. See  [Clock](//docs.ceph.com/docs/mimic/rados/configuration/mon-config-ref/#clock) for details.
$ sudo yum install ntp ntpdate ntp-doc
    Ensure that you enable the NTP service. Ensure that each Ceph Node uses the same NTP time server.
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="install-ssh-server"></a><a href="#install-ssh-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>INSTALL SSH SERVER</h4>
<pre><code class="hljs">sudo yum install openssh-server
    Ensure the SSH server is running on ALL Ceph Nodes.
</code></pre>
<ol>
<li><p>Make a directory on admin node in order to keep all the keys and configuration files that ceph-deploy generates.
a. mkdir cluster-config
b. cd cluster-config</p></li>
<li><p>Now we create a cluster</p>
<p>ceph-deploy new {initial-monitor-node(s)}</p>
<p>ceph-deploy new ceph-demo-1 ceph-demo-2</p></li>
</ol>
<h5><a class="anchor" aria-hidden="true" id="this-step-marks-the-nodes-as-initial-monitors"></a><a href="#this-step-marks-the-nodes-as-initial-monitors" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>This step marks the nodes as initial monitors.</h5>
<ol start="3">
<li><p>Thereafter, we Install ceph packages on required nodes</p>
<p>ceph-deploy install {ceph-node} […]</p>
<p>ceph-deploy install ceph-demo-1 ceph-demo-2</p></li>
</ol>
<h5><a class="anchor" aria-hidden="true" id="this-step-will-install-the-latest-stable-version-of-ceph-ie-mimic-1321-on-the-given-nodes"></a><a href="#this-step-will-install-the-latest-stable-version-of-ceph-ie-mimic-1321-on-the-given-nodes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>This step will install the latest stable version of ceph, i.e. mimic (13.2.1) on the given nodes.</h5>
<ol start="4">
<li><p>Now, we deploy the initial monitor nodes and gather keys</p>
<p>ceph-deploy mon create-initial</p></li>
<li><p>Now we go ahead and copy our config file and admin key to the admin node as well as ceph-nodes in order to use ceph cli without passing these each time we execute a command.</p>
<p>ceph-deploy admin {ceph-node}[…]</p>
<p>ceph-deploy admin ceph-demo-1 ceph-demo-2</p></li>
<li><p>Now, we deploy a manager daemon</p>
<p>ceph-deploy mgr create {ceph-node}[…]</p>
<p>ceph-deploy mgr create ceph-demo-1 ceph-demo-2</p></li>
<li><p>We create 2 OSDs, assuming each osd has a unused disk called dev/sdb</p>
<p>ceph-deploy osd create — data {device} {ceph-node}</p>
<p>ceph-deploy osd create — data /dev/sdb ceph-demo-1
ceph-deploy osd create — data /dev/sdb ceph-demo-2</p></li>
</ol>
<h5><a class="anchor" aria-hidden="true" id="after-successfully-executing-these-steps-our-ceph-cluster-is-up-and-running-the-status-and-health-of-the-cluster-can-be-checked-in-by-executing"></a><a href="#after-successfully-executing-these-steps-our-ceph-cluster-is-up-and-running-the-status-and-health-of-the-cluster-can-be-checked-in-by-executing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>After successfully executing these steps, our ceph cluster is up and running. The status and health of the cluster can be checked in by executing</h5>
<pre><code class="hljs">$ sudo ceph health
$ sudo ceph -s
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="we-should-get-a-status-saying-health_ok-and-a-detailed-status-resembling"></a><a href="#we-should-get-a-status-saying-health_ok-and-a-detailed-status-resembling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>We should get a status saying HEALTH_OK, and a detailed status resembling :</h5>
<pre><code class="hljs">cluster:

id: 651e9802-b3f0–4b1d-a4d6-c57a46635bc9

health: HEALTH_OK

services:

mon: 2 daemons, quorum ceph-demo-1,ceph-demo-2

mgr: ceph-demo-1(active), standbys: ceph-demo-2

osd: 2 osds: 2 up, 2 in

data:

pools: 0 pools, 0 pgs

objects: 0 objects, 0 B

usage: 2.0 GiB used, 18 GiB / 20 GiB avail

pgs:
</code></pre>
<h5><a class="anchor" aria-hidden="true" id="expanding-the-existing-cluster"></a><a href="#expanding-the-existing-cluster" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Expanding the Existing cluster</h5>
<p>Now, to demonstrate the ease of expanding a ceph cluster at runtime, we will be adding one node in our running cluster. We will mark that node as osd, manager and monitor to increase the availability of our existing cluster.
First of all, we need to make a change to our existing ceph.conf which is present inside the cluster-config directory. We add the following line into it</p>
<h5><a class="anchor" aria-hidden="true" id="public-network-ip-address-bits"></a><a href="#public-network-ip-address-bits" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>public network = {ip-address}/{bits}</h5>
<p>public network = 10.142.0.0/24</p>
<h5><a class="anchor" aria-hidden="true" id="for-this-we-need-to-follow-these-sample-steps"></a><a href="#for-this-we-need-to-follow-these-sample-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>For this, we need to follow these sample steps:</h5>
<ol>
<li><p>We install ceph packages on 3rd node</p>
<p>ceph-deploy install {ceph-node}[…]</p>
<p>ceph-deploy install ceph-demo-3</p></li>
<li><p>We need to push the admin keys and conf to 3rd node. We do it using</p>
<p>ceph-deploy admin {ceph-node}[…]</p>
<p>ceph-deploy admin ceph-demo-3</p></li>
<li><p>Now we will add the 3rd node as our monitor</p>
<p>ceph-deploy mon add {ceph-nodes}</p>
<p>ceph-deploy mon add ceph-demo-3</p></li>
<li><p>Now, we go ahead and mark 3rd node as our manager</p>
<p>ceph-deploy mgr create {ceph-node}[…]</p>
<p>ceph-deploy mgr create ceph-demo-3</p></li>
<li><p>We add 3rd node as OSD by following same steps as done while creating the cluster.</p>
<p>ceph-deploy osd create — data {path} {ceph-node}</p></li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="ceph-dashboard"></a><a href="#ceph-dashboard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CEPH Dashboard</h3>
<p>Now, going ahead, we can enable the CEPH dashboard in order to view all the cluster status via a UI console.</p>
<p>Ceph in its mimic release has provided the users with a new and redesigned dashboard plugin, with the features like restricted control with username/password protection and SSL/TLS support.</p>
<h5><a class="anchor" aria-hidden="true" id="to-enable-the-dashboard-we-need-to-follow-these-steps"></a><a href="#to-enable-the-dashboard-we-need-to-follow-these-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>To enable the dashboard, we need to follow these steps:</h5>
<pre><code class="hljs">1) ceph mgr module enable dashboard

2) ceph dashboard create-self-signed-cert
</code></pre>
<p>Note: Self signed certificate is only for quick start purpose.</p>
<pre><code class="hljs">3) ceph mgr module disable dashboard

4) ceph mgr module enable dashboard
</code></pre>
<p>Now, we will be able to see the CEPH dashboard on the port 8443, which is by default but on requirement can be configured using:</p>
<pre><code class="hljs">ceph config set mgr mgr/dashboard/server_addr $IP

ceph config set mgr mgr/dashboard/server_port $PORT
</code></pre>
<p>To access, and to utilize full functionality of the dashboard, we need to create the login credentials.</p>
<pre><code class="hljs">ceph dashboard set-login-credentials &lt;username&gt; &lt;password&gt;
</code></pre>
<p>After these steps, our ceph infrastructure is ready with all the configurations to do some actual input output operations.</p>
<h5><a class="anchor" aria-hidden="true" id="reference-link"></a><a href="#reference-link" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference link:</h5>
<div>http://docs.ceph.com/docs/mimic/start/quick-start-preflight/</div>
<h3><a class="anchor" aria-hidden="true" id="65-steps-to-install-and-configuration-ldap"></a><a href="#65-steps-to-install-and-configuration-ldap" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.5 Steps to Install and configuration LDAP</h3>
<p><a href="ApacheDs-Server-installation-and-config">ApacheDs Server installation and config</a></p>
<p><a href="Apache-Directory-Studio-user-guide">Apache Directory Studio user guide</a></p>
<h3><a class="anchor" aria-hidden="true" id="66-steps-to-install-and-configuration-hdfs"></a><a href="#66-steps-to-install-and-configuration-hdfs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.6 Steps to Install and configuration HDFS</h3>
<p>NOTE: Required only if HDFS is used for packet storage.</p>
<p><a href="Steps-to-Install-and-configuration-HDFS">Refer - Steps-to-Install-and-configuration-HDFS</a></p>
<h3><a class="anchor" aria-hidden="true" id="67-steps-to-deploy-kernel-key-manager-service"></a><a href="#67-steps-to-deploy-kernel-key-manager-service" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.7 Steps to Deploy Kernel Key Manager Service</h3>
<p>Kernel Keymanager Service is setup outside of Kubernetes cluster on a standalone VM. The steps to setup kernel-keymanager-service are given <a href="https://github.com/mosip/mosip-platform/blob/master/kernel/kernel-keymanager-service/README.md"><strong>here</strong></a></p>
<p>To deploy keymanager service, follow below steps -</p>
<ol>
<li>Prerequiste:<br/>
<ul>
<li>A machine with RHEL 7.6 installed.</li>
<li>Docker installed and Docker service enabled.</li>
</ul></li>
</ol>
<p>Steps to install Docker ce.</p>
<pre><code class="hljs"> $ sudo yum install http://mirror.centos.org/centos/7/extras/x86_64/Packages/container-selinux-2.107-3.el7.noarch.rpm

 $ sudo yum -y install lvm2 device-mapper device-mapper-persistent-data device-mapper-event device-mapper-libs    device-mapper-event-libs

$ sudo wget https://download.docker.com/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo

$ sudo yum -y install docker-ce

$ sudo systemctl start docker

$ sudo systemctl status docker
</code></pre>
<ol start="2">
<li>Open port 8088 on the VM:</li>
</ol>
<pre><code class="hljs"><span class="hljs-comment">sudo</span> <span class="hljs-comment">firewall</span><span class="hljs-literal">-</span><span class="hljs-comment">cmd</span> --<span class="hljs-comment">zone=public</span> --<span class="hljs-comment">add</span><span class="hljs-literal">-</span><span class="hljs-comment">port=8088/tcp</span> --<span class="hljs-comment">permanent</span>

<span class="hljs-comment">sudo</span> <span class="hljs-comment">firewall</span><span class="hljs-literal">-</span><span class="hljs-comment">cmd</span> --<span class="hljs-comment">reload</span>
</code></pre>
<p><strong>Note:</strong> if firewall is not installed in VM, install with “sudo yum install firewall”</p>
<p>And also open the port.</p>
<ol start="3">
<li>ensure that config server is already deployed.</li>
</ol>
<p><strong>Process to deploy Services in VM through JenkinsFile:</strong></p>
<ol start="4">
<li>Refer the github url for Jenkinsfile : in root directory of kernel module</li>
</ol>
<p>The last stage in the Jenkinsfile viz 'Key-Manager Deployment' in which we are sshing into this newly created VM through Jenkins to deploy this service, basically, running the docker image of key manager.</p>
<p>For ssh, place the public key of jenkins inside this newly created VM's authorized_keys under .ssh directory. Generate Docker Registry Credential in jenkins by using docker hub username and password. This will generate the credentialsId.</p>
<ul>
<li><p>Replace the value for registryCredentials(credentialsId of docker hub) with yours</p></li>
<li><p>Replace the value for  key_manager_vm_ip with IP of your newly created VM.</p></li>
</ul>
<p>Once done the following command will be used to deploy keymanager to the machine: <br/><br/></p>
<pre><code class="hljs">sudo docker <span class="hljs-builtin-name">run</span> -tid --ulimit <span class="hljs-attribute">memlock</span>=-1 -p 8088:8088 -v softhsm:/softhsm -e <span class="hljs-attribute">spring_config_url_env</span>=<span class="hljs-string">"<span class="hljs-variable">${config_url}</span>"</span> -e <span class="hljs-attribute">spring_config_label_env</span>=<span class="hljs-string">"<span class="hljs-variable">${branch}</span>"</span> -e <span class="hljs-attribute">active_profile_env</span>=<span class="hljs-string">"<span class="hljs-variable">${profile_env}</span>"</span> --name keymanager <span class="hljs-string">"<span class="hljs-variable">${registryAddress}</span>"</span>/kernel-keymanager-service
</code></pre>
<p>**NOTE- Replace the values for spring_config_url_env, spring_config_label_env,
active_profile_env and registryAddress in the above command accordingly</p>
<h3><a class="anchor" aria-hidden="true" id="68-sms-gateway-configuration"></a><a href="#68-sms-gateway-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.8 SMS Gateway configuration</h3>
<p>Refer kernel-smsnotification-servive Readme <a href="https://github.com/mosip/mosip-platform/blob/master/kernel/kernel-smsnotification-service/README.md"><strong>here</strong></a></p>
<h3><a class="anchor" aria-hidden="true" id="69-installation-of-activemq"></a><a href="#69-installation-of-activemq" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.9 Installation of ActiveMQ</h3>
<p>ActiveMQ is the message broker used for MOSIP Registartion processor module.</p>
<h4><a class="anchor" aria-hidden="true" id="installation-steps"></a><a href="#installation-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation steps</h4>
<ul>
<li><code>&lt;version&gt;</code> : please check <a href="http://www.apache.org/dist/activemq/">http://www.apache.org/dist/activemq/</a> to find out the latest version. Tested ActiveMQ version - 5.4.1.</li>
<li>Prerequiste:<br/>
A machine with RHEL 7.6 installed, Docker installed and Docker service enabled.</li>
<li>Download activemq using command - <br/>
<code>wget https://archive.apache.org/dist/activemq/5.14.3/apache-activemq-5.14.3-bin.tar.gz</code></li>
<li>Extract the archive <br/>
<code>tar -zxvf apache-activemq-&lt;version&gt;-bin.tar.gz</code></li>
<li>Change the permission for startup script<br/>
<code>chmod 755 apache-activemq-&lt;version&gt;</code></li>
<li>Start activemq service<br/>
<code>cd apache-activemq-&lt;version&gt; &amp;&amp; sudo ./bin/activemq start</code></li>
<li>Check for the installed and started activemq on port 61616. <br/>
<code>netstat -tulpn</code></li>
<li>Open ports 8161 and 61616  on the VM:</li>
</ul>
<pre><code class="hljs">sudo firewall-cmd <span class="hljs-attribute">--zone</span>=public <span class="hljs-attribute">--add-port</span>=8161/tcp --permanent
sudo firewall-cmd <span class="hljs-attribute">--zone</span>=public <span class="hljs-attribute">--add-port</span>=61616/tcp --permanent
sudo firewall-cmd --reload
</code></pre>
<p><strong>Note:</strong> After Installation of activemq, same needs to be mentioned in RegistrationProcessorAbis_{active_profile}.json
For e.g : Suppose activemq is configured as <a href="tcp://xxx.xxx.xxx.xx:61616">tcp://xxx.xxx.xxx.xx:61616</a>, then we for dev need to mention this in RegistrationProcessorAbis_dev.json as</p>
<pre><code class="hljs">{
    <span class="hljs-attr">"abis"</span>: [{
            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"ABIS1"</span>,
            <span class="hljs-attr">"host"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"port"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"brokerUrl"</span>: <span class="hljs-string">"tcp://xxx.xxx.xxx.xx:61616"</span>,
            <span class="hljs-attr">"inboundQueueName"</span>: <span class="hljs-string">"abis1-inbound-address_dev"</span>,
            <span class="hljs-attr">"outboundQueueName"</span>: <span class="hljs-string">"abis1-outbound-address_dev"</span>,
            <span class="hljs-attr">"pingInboundQueueName"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"pingOutboundQueueName"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"userName"</span>: <span class="hljs-string">"admin"</span>,
            <span class="hljs-attr">"password"</span>: <span class="hljs-string">"admin"</span>,
                <span class="hljs-attr">"typeOfQueue"</span>: <span class="hljs-string">"ACTIVEMQ"</span>
        }
    ]

}
</code></pre>
<p>ActiveMQ is also being used in registration-processor-printing-stage and the details need to be mentioned in registration-processor-{active_profile}.properties in the configuration repository.
E.g : For dev profile, the property in registration-processor-dev.properties, the Property corresponding to printing-stage related to activemq would be</p>
<pre><code class="hljs">Queue username
registration<span class="hljs-selector-class">.processor</span><span class="hljs-selector-class">.queue</span>.username={username}
<span class="hljs-selector-id">#Queue</span> Password
registration<span class="hljs-selector-class">.processor</span><span class="hljs-selector-class">.queue</span>.password={password}
<span class="hljs-selector-id">#Queue</span> Url
registration<span class="hljs-selector-class">.processor</span><span class="hljs-selector-class">.queue</span>.url={queue_url}
<span class="hljs-selector-id">#Type</span> of the Queue
registration<span class="hljs-selector-class">.processor</span><span class="hljs-selector-class">.queue</span>.typeOfQueue=ACTIVEMQ
<span class="hljs-selector-id">#Print</span> Service <span class="hljs-selector-tag">address</span>
registration<span class="hljs-selector-class">.processor</span><span class="hljs-selector-class">.queue</span>.address={queue_address}
<span class="hljs-selector-id">#Post</span> Service <span class="hljs-selector-tag">address</span>
registration<span class="hljs-selector-class">.processor</span><span class="hljs-selector-class">.queue</span>.printpostaladdress={postal_queue_address}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="7-configuring-mosip-table-of-content"></a><a href="#7-configuring-mosip-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. Configuring MOSIP <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<h3><a class="anchor" aria-hidden="true" id="mosip-database-object-deployment-configuration"></a><a href="#mosip-database-object-deployment-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MOSIP database object deployment / configuration</h3>
<p>Database deployment consists of the following 4 categories of objects to be deployed on postgresql database.</p>
<ol>
<li><p><strong>User / Roles:</strong> In MOSIP, the following user / roles are defined to perform various activities</p>
<ul>
<li><p><strong>sysadmin:</strong> sysadmin user/role is a super administrator role, who will have all the privileges to performa any task within the database.</p></li>
<li><p><strong>dbadmin:</strong> dbadmin user / role is created to handle all the database administration activities db monitoring, performance tuning, backups, restore, replication setup, etc.</p></li>
<li><p><strong>appadmin:</strong> appadmin user / role is used to perform all the DDL (Data Definition Language) tasks. All the db objects that are created in these databases will be owned by appadmin user.</p></li>
<li><p><strong>Application User:</strong> Each application will have a user / role created to perform DML (Data Manipulation Language) tasks like CRUD operations (select, insert, update, delete). The user prereguser, is created to connect from the application to perform all the DML activities. Similarly, we will have masteruser, prereguser, reguser, idauser, idrepouser, kerneluser, audituser, regprcuser to perform DML tasks for master, pre-registration, registration, ida, ID repository, kernel, audit and registration processor modules respectively.</p></li>
</ul>
<p><strong>Note:</strong> From the above set of roles only application user / role is specific to a application / module. The other user / roles are common which needs to be  created per postresql db instance / server.</p></li>
<li><p><strong>Database and Schema:</strong> Each application / module of MOSIP platform will have a database and schema defined. All the objects (tables) related to an application / module would be created under the respective database / schema. In MOSIP the following database and scehmas are defined</p></li>
</ol>
<table>
<thead>
<tr><th>application / module name</th><th>Database tool</th><th>database Name</th><th>schema name</th></tr>
</thead>
<tbody>
<tr><td>Master / Administration module</td><td>postgresql</td><td>mosip_master</td><td>master</td></tr>
<tr><td>Kernel</td><td>postgresql</td><td>mosip_kernel</td><td>kernel</td></tr>
<tr><td>Pre-registration</td><td>postgresql</td><td>mosip_prereg</td><td>prereg</td></tr>
<tr><td>Registration</td><td>Apache Derby</td><td>mosip_reg</td><td>reg</td></tr>
<tr><td>Registration Processor</td><td>postgresql</td><td>mosip_regprc</td><td>regprc</td></tr>
<tr><td>ID Authentication</td><td>postgresql</td><td>mosip_ida</td><td>ida</td></tr>
<tr><td>ID Repository</td><td>postgresql</td><td>mosip_idrepo</td><td>idrepo</td></tr>
<tr><td>Audit</td><td>postgresql</td><td>mosip_audit</td><td>audit</td></tr>
<tr><td>IAM</td><td>postgresql</td><td>mosip_iam</td><td>iam</td></tr>
<tr><td>idmap</td><td>postgresql</td><td>mosip_idmap</td><td>idmap</td></tr>
</tbody>
</table>
<p><strong>Note:</strong> These databases can be deployed on single or separate database servers / instances.</p>
<ol start="3">
<li><p><strong>DB Objects (Tables):</strong> All the tables of each application / module will be created in their respective database and schema. appadmin user / role will own these objects and the respective application user / role will have access to perform DML operations on these objects.</p></li>
<li><p><strong>Seed Data:</strong> MOSIP platform is designed to provide most of its features to be configured in the system. These configuration are deployed with default setup on config server and few in database. Few of these configuration can be modified / updated by the MOSIP administrator. These configuration include, system configurations, master datasetup, etc. The steps to add new center, machine / device is detailed in <a href="https://github.com/mosip/mosip-docs/wiki/Guidelines-for-Adding-Centers,-Machine,-User-and-Devices"><strong>Guidelines for Adding Centers, Machine, Users and Devices</strong></a></p></li>
</ol>
<p>The system configuration and master data is available under the respective application / database related folder. for example, the master data configuration is available in csv file format under <a href="https://github.com/mosip/mosip-platform/tree/master/db_scripts/mosip_master/dml"><strong>folder</strong></a>.</p>
<p>The scripts to create the above objects are available under <a href="https://github.com/mosip/mosip-platform/tree/master/db_scripts">db_scripts</a>. To deploy the database objects of each application / module <strong>except registration client</strong>, please refer to <a href="https://github.com/mosip/mosip-platform/blob/master/db_scripts/README.MD">README.MD</a> file. These scripts will contain the deployment of all the DB object categories.</p>
<p><strong>Note: Please skip Registration client related deployment scripts (Apache derby DB specific) as this will be executed as part of registration client software installation.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="setup-and-configure-mosip"></a><a href="#setup-and-configure-mosip" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup and configure MOSIP</h3>
<p>We are using kubernetes configuration server in MOSIP for storing and serving distributed configurations across all the applications and environments.</p>
<p>We are storing all applications' configuration in config-templates folder inside our Github Repository <a href="https://github.com/mosip/mosip-config.git">here</a>.</p>
<p>For getting more details about how to use configuration server with our applications, following developer document can be referred:
<a href="MOSIP-Configuration-Server"><strong>MOSIP CONFIGURATION SERVER</strong></a></p>
<p>For Deployment of configurations server, go to <a href="Getting-Started#firstly-deploy-kernel-configuration-server">firstly-deploy-kernel-configuration-server</a> in this document.</p>
<p>Application specific configuration for all applications and services are placed in MOSIP config server.</p>
<p><strong>A. Global:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/application-env.properties"><strong>link</strong></a></p>
<p><strong>B. Kernel:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/kernel-env.properties"><strong>link</strong></a></p>
<p><strong>C. Pre-Registration:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/pre-registration-env.properties"><strong>link</strong></a></p>
<p><strong>D. Registartion-Processor:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/registration-processor-env.properties"><strong>link</strong></a></p>
<p><strong>E. IDA:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/id-authentication-env.properties"><strong>link</strong></a></p>
<p><strong>F. ID-REPO:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/id-repository-env.properties"><strong>link</strong></a></p>
<p><strong>H. Registration:</strong>
<a href="https://github.com/mosip/mosip-config/blob/master/config-templates/registration-env.properties"><strong>link</strong></a></p>
<p><strong>Properties Sections that need to be changed in above module specific files once the external dependencies are installed as per your setup</strong></p>
<h3><a class="anchor" aria-hidden="true" id="global"></a><a href="#global" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Global</h3>
<ol>
<li>#--Common properties------------</li>
</ol>
<pre><code class="hljs"><span class="hljs-selector-tag">mosip</span><span class="hljs-selector-class">.base</span><span class="hljs-selector-class">.url</span>
</code></pre>
<ol start="2">
<li>#--Virus Scanner-----------------</li>
</ol>
<pre><code class="hljs"><span class="hljs-selector-tag">mosip</span><span class="hljs-selector-class">.kernel</span><span class="hljs-selector-class">.virus-scanner</span><span class="hljs-selector-class">.host</span>
<span class="hljs-selector-tag">mosip</span><span class="hljs-selector-class">.kernel</span><span class="hljs-selector-class">.virus-scanner</span><span class="hljs-selector-class">.port</span>
</code></pre>
<ol start="3">
<li>#--FS Adapter-HDFS -------------</li>
</ol>
<pre><code class="hljs">mosip.kernel.fsadapter.hdfs.name-node-url
# <span class="hljs-keyword">Enable</span> <span class="hljs-keyword">if</span> hadoop <span class="hljs-keyword">security</span> <span class="hljs-keyword">authorization</span> <span class="hljs-keyword">is</span> <span class="hljs-string">'true'</span>, <span class="hljs-keyword">default</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">false</span>
mosip.kernel.fsadapter.hdfs.authentication-enabled
# <span class="hljs-keyword">If</span> HDFS <span class="hljs-keyword">is</span> <span class="hljs-keyword">security</span> <span class="hljs-keyword">is</span> configured <span class="hljs-keyword">with</span> Kerberos, Key Distribution Center <span class="hljs-keyword">domain</span>
mosip.kernel.fsadapter.hdfs.kdc-<span class="hljs-keyword">domain</span>
<span class="hljs-meta">#keytab file path, must be set if authentication-enable is true</span>
<span class="hljs-meta">#read keytab file both classpath and physical path ,append appropriate prefix</span>
<span class="hljs-meta">#for classpath prefix classpath:mosip.keytab</span>
<span class="hljs-meta">#for physical path prefix file:/home/keys/mosip.keytab</span>
mosip.kernel.fsadapter.hdfs.keytab-file=classpath:mosip.keytab
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="kernel"></a><a href="#kernel" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kernel</h3>
<ol>
<li>#--kernel common properties-----------------------</li>
</ol>
<pre><code class="hljs"><span class="hljs-selector-tag">mosip</span><span class="hljs-selector-class">.kernel</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.hostname</span>
<span class="hljs-selector-tag">mosip</span><span class="hljs-selector-class">.kernel</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.port</span>
</code></pre>
<ol start="2">
<li>#--sms notification service-----------------------</li>
</ol>
<pre><code class="hljs"><span class="hljs-selector-tag">mosip</span><span class="hljs-selector-class">.kernel</span><span class="hljs-selector-class">.sms</span><span class="hljs-selector-class">.authkey</span>
</code></pre>
<ol start="3">
<li>#--Email Notification service---------------------</li>
</ol>
<pre><code class="hljs">spring<span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.host</span>
spring<span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.username</span>
spring<span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.password</span>
spring<span class="hljs-selector-class">.mail</span>.port=<span class="hljs-number">587</span>
</code></pre>
<ol start="4">
<li>#--Ldap------------</li>
</ol>
<pre><code class="hljs"><span class="hljs-selector-tag">ldap_1_DS</span><span class="hljs-selector-class">.datastore</span><span class="hljs-selector-class">.ipaddress</span>
<span class="hljs-selector-tag">ldap_1_DS</span><span class="hljs-selector-class">.datastore</span><span class="hljs-selector-class">.port</span>
</code></pre>
<ol start="5">
<li>#--DataBase Properties----------------------------</li>
</ol>
<pre><code class="hljs"><span class="hljs-comment">**_database_password</span>
<span class="hljs-comment">**_database_username</span>
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="8-mosip-deployment-table-of-content"></a><a href="#8-mosip-deployment-table-of-content" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. MOSIP Deployment <a href="#table-of-content"><strong>[↑]</strong></a></h2>
<p>Currently for the Development Process MOSIP Platform is deployed as/in the Kubernetes Cluster. We are using Azure Kubernetes Service for provisioning of Cluster. As of now Kubernetes Deployment is deviced in two parts -</p>
<p>A. One time setup of MOSIP in Kubernetes Cluster</p>
<p>B. Continuous deployment</p>
<h3><a class="anchor" aria-hidden="true" id="a-one-time-setup-of-mosip-in-kubernetes-cluster"></a><a href="#a-one-time-setup-of-mosip-in-kubernetes-cluster" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>A. One time setup of MOSIP in Kubernetes Cluster</h3>
<p>One time setup on Kubernetes involves following Steps <br/>
I. Setting Up local system to communicate with Kubernetes cluster this can be done via <a href="//kubernetes.io/docs/reference/kubectl/overview/"><strong>kubectl</strong></a>.<br/>
II. Setting Up the Basic environment for MOSIP to run in Kubernetes Cluster, In this step we will work on this <a href="https://github.com/mosip/mosip-infra/tree/master/deployment/cloud/kubernetes/commons">link</a> . following are the files -</p>
<p><img src="_images/getting_started_images/kubernetes-commons-files.png" alt="File in commons folder"></p>
<p>We will now go through each of the file and see what changes we need to perform. we will be using <a href="//kubernetes.io/docs/reference/kubectl/overview/"><strong>kubectl</strong></a> to do the deployments from local system.</p>
<ul>
<li><p>DeployIngressController.yaml - We need not to change anything here. we can directly run this file. To run this use this command
<code>kubectl apply -f DeployIngressController.yaml</code></p></li>
<li><p>DeployIngress.yaml -
This file contains information about routing to different Kubernetes services, So whenever any traffic comes to our Load Balancer IP it will look for this file to route the request. For eg. Let's say if <strong>some.example.com</strong> is mapped to our kubernetes loadbalancer then if a request is for <strong>some.example.com/pre-registration-ui</strong> then this request will be redirect to <strong>pre-registration-ui</strong> on port <strong>80</strong> service. Routes referrring to <strong>ping-server</strong> and <strong>sample-nginx</strong> can be removed as these are for testing purpose.To run this use this command
<code>kubectl apply -f DeployIngress.yaml</code></p></li>
<li><p>DeployServiceIngressService.yaml - We need not to change anything here. we can directly run this file. To run this use this command
kubectl apply -f DeployServiceIngressService.yaml</p></li>
<li><p>DeployDefaultBackend.yaml - We need not to change anything here. we can directly run this file. To run this use this command
<code>kubectl apply -f DeployDefaultBackend.yaml</code></p></li>
<li><p>docker-registry-secret.yml -
This file helps Kubernetes to get the Docker Images from Private Docker Registry. This file is a downloaded YAML of secrets that exists in the Kubernetes. You can either create secret or use this file to deploy secret in Kubernetes. For creating secret for the first time, run below command -</p>
<p><code>kubectl create secret docker-registry &lt;registry-credential-name&gt; --docker-server=&lt;your-registry-server&gt; --docker-username=&lt;your-name&gt; --docker-password=&lt;your-pword&gt; --docker-email=&lt;your-email&gt;</code></p>
<p>Once secret is created on the Kubernetes Cluster, as a backup strategy we can download the created secret using this command</p>
<p><code>kubectl get secret &lt;registry-credential-name&gt; -o yaml --export</code></p></li>
</ul>
<p>Once the above deployment is done, we will start deploying MOSIP services. For doing this, we need to look for these directories -</p>
<p><img src="_images/getting_started_images/kubernetes-mosip-services-directory.JPG" alt="Directories"></p>
<h3><a class="anchor" aria-hidden="true" id="firstly-deploy-kernel-configuration-server"></a><a href="#firstly-deploy-kernel-configuration-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Firstly Deploy Kernel Configuration server</h3>
<p>The script is inside ( <a href="https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/kubernetes/configuration-server/config-server-deployment-and-service.yml">https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/kubernetes/configuration-server/config-server-deployment-and-service.yml</a> ) <br/>
Follow below steps:</p>
<ol>
<li><p>Create a ssh key and configure it with your git repository. If you have already configured the ssh key for your repository, you can use that one or else follow <a href="//help.github.com/en/articles/connecting-to-github-with-ssh">this</a> <br/></p></li>
<li><p>Create a secret for Config server to connect to GIT repo. This secret contains your <strong>id_rsa key (private key), id_rsa_pub key (public key) and known_hosts</strong> which you generated above. We need this secret because config server connects to your Source code management repository, to get configuration for all the services(If you are using ssh URL for cloning the repo). For generating the required secret give the following command: ( Firstly try to connect to GIT repository from your system using ssh url and the key you created above, so that GIT service provider such as GitHub or GitLab comes in your known hosts file): <br/></p>
<p><code>kubectl create secret generic config-server-secret --from-file=id_rsa=/path/to/.ssh/id_rsa --from-file=id_rsa.pub=/path/to/.ssh/id_rsa.pub --from-file=known_hosts=/path/to/.ssh/known_hosts</code> <br/></p>
<p><strong>For Encryption Decryption of properties with configuration server</strong> <br/>
<br/>
Create keystore with following command:</p>
<p><code>keytool -genkeypair -alias &lt;your-alias&gt; -keyalg RSA -keystore server.keystore -keypass &lt; key-secret &gt; -storepass &lt; store-password &gt; --dname &quot;CN=&lt;your-CN&gt;,OU=&lt;OU&gt;,O=&lt;O&gt;,L=&lt;L&gt;,S=&lt;S&gt;,C=&lt;C&gt;&quot;</code></p></li>
<li><p>The JKS keystore uses a proprietary format. It is recommended to migrate to PKCS12 which is an industry standard format, migrate it using following command:<br>
<code>keytool -importkeystore -srckeystore server.keystore -destkeystore server.keystore -deststoretype pkcs12</code> <br/>
For more information look <a href="//cloud.spring.io/spring-cloud-config/single/spring-cloud-config.html#_creating_a_key_store_for_testing">here</a> <br/>
<br/></p></li>
<li><p>Create file with following content to create keystore secret for encryption decryption of keys using information from keystore created above: <br/></p>
<pre><code class="hljs"><span class="hljs-symbol">apiVersion:</span> v1
<span class="hljs-symbol">kind:</span> Secret
<span class="hljs-symbol">metadata:</span>
<span class="hljs-symbol">  name:</span> config-server-keystore-values-secret
<span class="hljs-symbol">type:</span> Opaque
<span class="hljs-symbol">data:</span>
<span class="hljs-symbol">  alias:</span> <span class="hljs-params">&lt; base<span class="hljs-number">-64</span>-encoded-alias-for keystore &gt;</span>
<span class="hljs-symbol">  password:</span> <span class="hljs-params">&lt;  base<span class="hljs-number">-64</span>-store-password &gt;</span>
<span class="hljs-symbol">  secret:</span> <span class="hljs-params">&lt; base<span class="hljs-number">-64</span>-encoded-key-secret &gt;</span>
</code></pre></li>
<li><p>Save the above file with any name and apply it using: <br/>
<code>kubectl apply -f &lt; file-name &gt;</code>
<br/></p></li>
<li><p>Create server.keystore as secret to volume mount it inside container: <br/>
<code>kubectl create secret generic config-server-keystore --from-file=server.keystore=&lt; location-of-your-server.keystore-file-generated-above &gt;</code>
<br/>
<br/></p></li>
<li><p>Change <code>git_url_env</code> environment variable in kernel-config-server-deployment-and-service.yml to your git ssh url of configuration repository
<br/>
<br/></p></li>
<li><p>Change <code>git_config_folder_env</code> environment variable in kernel-config-server-deployment-and-service.yml  to your configuration folder in git repository.
<br/>
<br/></p></li>
<li><p>Change <code>spec-&gt;template-&gt;spec-&gt;containers-&gt;image</code> from <code>docker-registry.mosip.io:5000/kernel-config-server</code> to <code>&lt; Your Docker Registry &gt;/kernel-config-server</code> <br/>
<br/></p></li>
<li><p>Change <code>spec-&gt;template-&gt;spec-&gt;imagePullSecrets-&gt;name</code> from <code>pvt-reg-cred</code> to <code>&lt; Your docker registry credentials secret &gt;</code>
<br/>
<br/></p></li>
<li><p>Once above configuration is done, execute <code>kubectl apply -f kernel-config-server-deployment-and-service.yml</code>
<br/>
<br/></p></li>
</ol>
<p>More information can be found <a href="https://github.com/mosip/mosip-platform/blob/master/kernel/kernel-config-server/README.md">here</a></p>
<p><br/></p>
<h3><a class="anchor" aria-hidden="true" id="deploy-other-components-br"></a><a href="#deploy-other-components-br" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy other components: <br/></h3>
<p>Inside each of the directory there is a file for each service of MOSIP that is exposed as Web API. We need to deploy these files to get these running. But before doing that we need to change Private Docker Registry Address and Docker Registry Secret, so that on deployment time Kubernetes can fetch docker images from correct source using correct credentials.
For doing this, follow below steps (for eg. we will use <a href="https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/kubernetes/kernel-deployment/kernel-auditmanager-service-deployment-and-service.yml">https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/kubernetes/kernel-deployment/kernel-auditmanager-service-deployment-and-service.yml</a>, but you have to repeat the process for all such files) - <br/>
I. Open a deployment file. <br/>
II. Change <code>spec-&gt;template-&gt;spec-&gt;containers-&gt;image</code> from <code>docker-registry.mosip.io:5000/kernel-auditmanager-service</code> to <code>&lt;Your Docker Registry&gt;/kernel-auditmanager-service</code> <br/>
III. Change <code>spec-&gt;template-&gt;spec-&gt;imagePullSecrets-&gt;name</code> from <code>pvt-reg-cred</code> to <code>&lt;Your docker registry credentials secret&gt;</code> <br/>
IV. Change <code>active_profile_env</code> to whichever profile you want to activate and <code>spring_config_label_env</code> to the branch from which you want to pick up the configuration<br/>
V. Save the file and Run <code>kubectl apply -f kernel-auditmanager-service-deployment-and-service.yml</code> <br/></p>
<p>After above process is completed, you can run <code>kubectl get services</code> command to see the status of all the MOSIP Services.</p>
<p><strong>For Pre-Registration-UI</strong><br/>
Pre-registration-ui uses a file config.json to configure URLs of backend, which have to be provided as config map in pre-registration-ui-deployment-and-service.yml. For creating the configmap follow below steps:</p>
<ol>
<li>Edit the file scripts -&gt; <a href="https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/kubernetes/pre-registration-deployment/pre-registration-ui-configuration.yaml">https://github.com/mosip/mosip-infra/blob/master/deployment/cloud/kubernetes/pre-registration-deployment/pre-registration-ui-configuration.yaml</a></li>
<li>Update <code>https://dev.mosip.io/</code> value with url of proxy server which points to pre-registration services. (Note: While editing, be careful with escape sequence characters)</li>
<li>Execute command <code>Kubectl apply -f pre-registration-ui-configuration.yaml</code></li>
</ol>
<hr>
<h3><a class="anchor" aria-hidden="true" id="81-registration-processor-dmz-services-deployment"></a><a href="#81-registration-processor-dmz-services-deployment" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8.1  Registration-Processor DMZ services deployment</h3>
<p>Registration Processor DMZ Services are setup externally(deployed in a separate VM).</p>
<p>Firstly, update below files present in config folder in configuration repository, and replace the line<br/>
<code>&lt;to uri=&quot;https://&lt;dns name&gt;/registrationprocessor/v1/uploader/securezone&quot; /&gt;</code><br/>
with the URL of packet uploader stage.<br/></p>
<ol>
<li><code>registration-processor-camel-routes-new-dmz-&lt;env-name&gt;.xml</code></li>
<li><code>registration-processor-camel-routes-update-dmz-&lt;env-name&gt;.xml</code></li>
<li><code>registration-processor-camel-routes-lost-dmz-&lt;env-name&gt;.xml</code></li>
<li><code>registration-processor-camel-routes-activate-dmz-&lt;env-name&gt;.xml</code></li>
<li><code>registration-processor-camel-routes-deactivate-dmz-&lt;env-name&gt;.xml</code></li>
<li><code>registration-processor-camel-routes-res_update-dmz-&lt;env-name&gt;.xml</code></li>
</ol>
<p>We are deploying DMZ services into another VM having docker installed. The steps to setup DMZ environment and services deployment:</p>
<ol>
<li><p>Need to set Up VM with RHEL 7.6</p></li>
<li><p>Installing the Docker ce:</p>
<pre><code class="hljs">   $ sudo yum install http://mirror.centos.org/centos/7/extras/x86_64/Packages/container-selinux-2.107-
     3.el7.noarch.rpm

  $ sudo yum -y install lvm2 device-mapper device-mapper-persistent-data device-mapper-event device-mapper-libs
    device-mapper-event-libs

  $ sudo wget https://download.docker.com/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo

  $ sudo yum -y install docker-ce

  $ sudo systemctl start docker

  $ sudo systemctl status docker
</code></pre></li>
<li><p>Need to copy the Jenkins server public key(id_rsa.pub) inside this newly created VM's authorized_keys(because through jenkins job, we will ssh into new VM and deploy)</p></li>
</ol>
<p>After installing Docker Start the Docker Service</p>
<p><strong>command to start the Docker service</strong></p>
<ul>
<li>systemctl start docker</li>
</ul>
<p><strong>command to check Docker is running:</strong></p>
<ul>
<li>systemctl status docker</li>
</ul>
<ol start="3">
<li><strong>Open the port 8081, 8083 from the VM:</strong>
Mosip uses port 8081 for registration-processor-packet-receiver-stage and 8083 for registration-processor-registration-status-service. The port ids need to be updated in ngnix configuration.</li>
</ol>
<p>sudo firewall-cmd --zone=public --add-port=8081/tcp --permanent</p>
<p>sudo firewall-cmd --reload</p>
<p>sudo firewall-cmd --zone=public --add-port=8083/tcp --permanent</p>
<p>sudo firewall-cmd --reload</p>
<p><strong>Note:</strong> if firewall is not installed in VM, install with “sudo yum install firewall”</p>
<p>And also open the port from AZURE OR AWS or any cloud where the VM is launched.</p>
<p><strong>Process to deploy Services in VM through JenkinsFile:</strong></p>
<ol start="4">
<li><p>The last stage in the Jenkinsfile viz DMZ_Deployment in which we are sshing into this newly created VM through Jenkins to deploy these services, basically, running the docker images of registration processor.
Changes to be made in this stage-&gt;</p>
<p>a. Replace the value for registryCredentials(credentialsId of docker hub) with yours.</p>
<p>b. Replace the value for the variable -&gt; dmz_reg_proc_dev_ip with the IP of your newly created VM.</p></li>
</ol>
<p>Refer the github url for Jenkinsfile : <a href="https://github.com/mosip/mosip-infra/blob/master/scripts/jenkinsfile/registration-processor-Jenkinsfile">here</a></p>
<ol start="5">
<li>Also, instead of following as described in 4th point to use Jenkinsfile, we can do it manually. Steps are -&gt;</li>
</ol>
<p>a. Login into the DMZ VM.</p>
<p>b. Perform docker hub login</p>
<p>c. Execute the following commands</p>
<pre><code class="hljs">docker <span class="hljs-builtin-name">run</span> --restart always -it -d -p 8083:8083 -e <span class="hljs-attribute">active_profile_env</span>=<span class="hljs-string">"<span class="hljs-variable">${profile_env}</span>"</span> -e <span class="hljs-attribute">spring_config_label_env</span>=<span class="hljs-string">"<span class="hljs-variable">${label_env}</span>"</span> -e <span class="hljs-attribute">spring_config_url_env</span>=<span class="hljs-string">"<span class="hljs-variable">${config_url}</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${registryAddress}</span>"</span>/registration-processor-registration-status-service
</code></pre>
<pre><code class="hljs">docker <span class="hljs-builtin-name">run</span> --restart always -it -d --network host <span class="hljs-attribute">--privileged</span>=<span class="hljs-literal">true</span> -v /home/ftp1/LANDING_ZONE:/home/ftp1/LANDING_ZONE -v /home/ftp1/ARCHIVE_PACKET_LOCATION:/home/ftp1/ARCHIVE_PACKET_LOCATION -e <span class="hljs-attribute">active_profile_env</span>=<span class="hljs-string">"<span class="hljs-variable">${profile_env}</span>"</span> -e <span class="hljs-attribute">spring_config_label_env</span>=<span class="hljs-string">"<span class="hljs-variable">${label_env}</span>"</span> -e <span class="hljs-attribute">spring_config_url_env</span>=<span class="hljs-string">"<span class="hljs-variable">${config_url}</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${registryAddress}</span>"</span>/registration-processor-packet-receiver-stage
</code></pre>
<pre><code class="hljs">docker <span class="hljs-builtin-name">run</span> --restart always -it -d --network host <span class="hljs-attribute">--privileged</span>=<span class="hljs-literal">true</span> -e <span class="hljs-attribute">active_profile_env</span>=<span class="hljs-string">"<span class="hljs-variable">${profile_env}</span>"</span> -e <span class="hljs-attribute">spring_config_label_env</span>=<span class="hljs-string">"<span class="hljs-variable">${label_env}</span>"</span> -e <span class="hljs-attribute">spring_config_url_env</span>=<span class="hljs-string">"<span class="hljs-variable">${config_url}</span>"</span> -e <span class="hljs-attribute">zone_env</span>=dmz  <span class="hljs-string">"<span class="hljs-variable">${registryAddress}</span>"</span>/registration-processor-common-camel-bridge
</code></pre>
<p><strong>Note</strong> - Please change the environmental variables(active_profile_env, spring_config_label_env, spring_config_url_env ,registryAddress) in the above commands accordingly whether you are executing manually in your new VM or through Jenkinsfile.</p>
<ol start="6">
<li>Packet uploader stage in secure zone will fetch file from dmz to upload it into Distributed File System,to connect to
dmz vm either we can login using username and password or using ppk file.
If password value is available in config property name
registration.processor.dmz.server.password then uploader will connect using username and password.
otherwise it will login using ppk file available in config with property name registration.processor.vm.ppk.
PPK generation command ssh-keygen -t rsa -b 4096 -f mykey.</li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="82-kernel-salt-generator"></a><a href="#82-kernel-salt-generator" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8.2 Kernel Salt Generator</h3>
<p>Kernel Salt Generator Job is a one-time job which is run to populate salts to be used to hash and encrypt data. This generic job takes schema and table name as input, and generates and populates salts in the given schema and table.</p>
<p><strong>Salt Generator Deployment steps</strong></p>
<p>a. Login into the VM.
Open the port 8092 from the VM:</p>
<p>sudo firewall-cmd --zone=public --add-port=8092/tcp --permanent</p>
<p>sudo firewall-cmd --reload</p>
<p>And also open the port from AZURE OR AWS or any cloud where the VM is launched.</p>
<p>b. Perform docker hub login</p>
<p>c. Execute the following commands sequentially one after the other. Wait for the completion of previous command before
executing next commands.</p>
<pre><code class="hljs">  1.  docker run -it -p 8092:8092 -e active_profile_env=&quot;${profile_env}&quot; -e spring_config_label_env=&quot;${label_env}&quot;  
     -e spring_config_url_env=&quot;${config_url}&quot; -e spring_config_name_env=id-repository -e db_url=mosip.idrepo.identity.db.shard.url -e schema_name=idrepo -e table_name=uin_hash_salt
     &quot;${registryAddress}&quot;/id-repository-salt-generator

  2.  docker run -it -p 8092:8092 -e active_profile_env=&quot;${profile_env}&quot; -e spring_config_label_env=&quot;${label_env}&quot;  
     -e spring_config_url_env=&quot;${config_url}&quot; -e spring_config_name_env=id-repository -e db_url=mosip.idrepo.identity.db.shard.url -e schema_name=idrepo -e table_name=uin_encrypt_salt
     &quot;${registryAddress}&quot;/id-repository-salt-generator

  3.  docker run -it -p 8092:8092 -e active_profile_env=&quot;${profile_env}&quot; -e spring_config_label_env=&quot;${label_env}&quot;  
     -e spring_config_url_env=&quot;${config_url}&quot; -e spring_config_name_env=id-repository -e db_url=mosip.idrepo.vid.db.url -e schema_name=idmap -e table_name=uin_hash_salt
     &quot;${registryAddress}&quot;/id-repository-salt-generator

  4.  docker run -it -p 8092:8092 -e active_profile_env=&quot;${profile_env}&quot; -e spring_config_label_env=&quot;${label_env}&quot;       
     -e spring_config_url_env=&quot;${config_url}&quot; -e spring_config_name_env=id-repository -e db_url=mosip.idrepo.vid.db.url -e schema_name=idmap -e table_name=uin_encrypt_salt
     &quot;${registryAddress}&quot;/id-repository-salt-generator

  5.  docker run -it -d -p 8092:8092 -e active_profile_env=&quot;${profile_env}&quot; -e spring_config_label_env=&quot;${label_env}&quot;
      -e spring_config_url_env=&quot;${config_url}&quot; -e spring_config_name_env=id-authentication -e schema_name=ida -e table_name=uin_hash_salt
      &quot;${registryAddress}&quot;/authentication-salt-generator

  6. docker run -it -d -p 8092:8092 -e active_profile_env=&quot;${profile_env}&quot; -e spring_config_label_env=&quot;${label_env}&quot;
     -e spring_config_url_env=&quot;${config_url}&quot; -e spring_config_name_env=id-authentication -e schema_name=ida -e table_name=uin_encrypt_salt
     &quot;${registryAddress}&quot;/authentication-salt-generator
</code></pre>
<p><strong>Note</strong> - Please change the value for variables active_profile_env, spring_config_label_env, spring_config_url_env and registryAddress in the above four commands accordingly</p>
<h3><a class="anchor" aria-hidden="true" id="83-first-user-registration-and-onboarding"></a><a href="#83-first-user-registration-and-onboarding" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8.3 First User Registration and Onboarding</h3>
<p><a href="First-User-Registration-and-Onboarding">Refer to wiki for detailed procedure on First User Registration and Onboarding</a></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/Platform-Documentation"><span class="arrow-prev">← </span><span>Table Of Contents</span></a><a class="docs-next button" href="/docs/Hardware-Software-requirements"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#table-of-content">Table Of Content</a></li><li><a href="#1-getting-the-source-code">1. Getting the Source Code <a href="#table-of-content"><strong>[↑]</strong></a></a></li><li><a href="#2-setup-and-configure-jenkins">2. Setup and Configure Jenkins <a href="#table-of-content"><strong>[↑]</strong></a></a><ul class="toc-headings"><li><a href="#a-installing-jenkins-version-21501">A. Installing Jenkins version 2.150.1</a></li><li><a href="#b-setting-up-github-for-in-jenkins">B. Setting Up Github for/in Jenkins</a></li><li><a href="#c-create-pipelines">C. Create Pipelines</a></li></ul></li><li><a href="#3-setup-and-configure-jfrog-artifactory-version-652">3. Setup and Configure Jfrog Artifactory Version 6.5.2 <a href="#table-of-content"><strong>[↑]</strong></a></a></li><li><a href="#4-setup-and-configure-sonarqube-version-73">4. Setup and Configure SonarQube version 7.3 <a href="#table-of-content"><strong>[↑]</strong></a></a></li><li><a href="#5-setup-and-configure-docker-registry">5. Setup and Configure Docker Registry <a href="#table-of-content"><strong>[↑]</strong></a></a></li><li><a href="#6-installing-external-dependencies">6. Installing External Dependencies <a href="#table-of-content"><strong>[↑]</strong></a></a><ul class="toc-headings"><li><a href="#61-install-and-use-postgresql-version-102-on-rhel-75">6.1 Install and use PostgreSql Version 10.2 on RHEL 7.5</a></li><li><a href="#62-install-and-use-nginx-version-1158-on-rhel-75">6.2 Install and use Nginx Version-1.15.8 on RHEL 7.5</a></li><li><a href="#63-clam-antivirus-version-01010">6.3 Clam AntiVirus Version 0.101.0</a></li><li><a href="#64-steps-to-install-and-configuration-ceph">6.4 Steps to Install and configuration CEPH</a></li><li><a href="#ceph-dashboard">CEPH Dashboard</a></li><li><a href="#65-steps-to-install-and-configuration-ldap">6.5 Steps to Install and configuration LDAP</a></li><li><a href="#66-steps-to-install-and-configuration-hdfs">6.6 Steps to Install and configuration HDFS</a></li><li><a href="#67-steps-to-deploy-kernel-key-manager-service">6.7 Steps to Deploy Kernel Key Manager Service</a></li><li><a href="#68-sms-gateway-configuration">6.8 SMS Gateway configuration</a></li><li><a href="#69-installation-of-activemq">6.9 Installation of ActiveMQ</a></li></ul></li><li><a href="#7-configuring-mosip">7. Configuring MOSIP <a href="#table-of-content"><strong>[↑]</strong></a></a><ul class="toc-headings"><li><a href="#mosip-database-object-deployment-configuration">MOSIP database object deployment / configuration</a></li><li><a href="#setup-and-configure-mosip">Setup and configure MOSIP</a></li><li><a href="#global">Global</a></li><li><a href="#kernel">Kernel</a></li></ul></li><li><a href="#8-mosip-deployment">8. MOSIP Deployment <a href="#table-of-content"><strong>[↑]</strong></a></a><ul class="toc-headings"><li><a href="#a-one-time-setup-of-mosip-in-kubernetes-cluster">A. One time setup of MOSIP in Kubernetes Cluster</a></li><li><a href="#firstly-deploy-kernel-configuration-server">Firstly Deploy Kernel Configuration server</a></li><li><a href="#deploy-other-components">Deploy other components:</a></li><li><a href="#81-registration-processor-dmz-services-deployment">8.1  Registration-Processor DMZ services deployment</a></li><li><a href="#82-kernel-salt-generator">8.2 Kernel Salt Generator</a></li><li><a href="#83-first-user-registration-and-onboarding">8.3 First User Registration and Onboarding</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon.ico" alt="MOSIP Documentation" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/docs/en/doc2.html">Guides (or other categories)</a><a href="/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Your Name or Your Company Name</section></footer></div></body></html>