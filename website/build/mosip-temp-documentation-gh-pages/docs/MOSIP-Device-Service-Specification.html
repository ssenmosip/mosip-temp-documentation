<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>MOSIP-Device-Service-Specification · MOSIP Documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="#### Aug 2019 | Version: 0.9.2 "/><meta name="docsearch:language" content="en"/><meta property="og:title" content="MOSIP-Device-Service-Specification · MOSIP Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://ssenmosip.github.io/mosip-temp-documentationindex"/><meta property="og:description" content="#### Aug 2019 | Version: 0.9.2 "/><meta property="og:image" content="https://ssenmosip.github.io/mosip-temp-documentation/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://ssenmosip.github.io/mosip-temp-documentation/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/mosip-temp-documentationimg/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://ssenmosip.github.io/mosip-temp-documentation/blog/atom.xml" title="MOSIP Documentation Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://ssenmosip.github.io/mosip-temp-documentation/blog/feed.xml" title="MOSIP Documentation Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/mosip-temp-documentationjs/scrollSpy.js"></script><link rel="stylesheet" href="/mosip-temp-documentationcss/main.css"/><script src="/mosip-temp-documentationjs/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/mosip-temp-documentation"><img class="logo" src="/mosip-temp-documentationimg/favicon.ico" alt="MOSIP Documentation"/><h2 class="headerTitleWithLogo">MOSIP Documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/mosip-temp-documentationdocs/Platform-Documentation" target="_self">Docs</a></li><li class=""><a href="/mosip-temp-documentationdocs/Getting-Started" target="_self">API</a></li><li class=""><a href="/mosip-temp-documentationContributor-Guide" target="_self">Help</a></li><li class=""><a href="/mosip-temp-documentationblog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">MOSIP-Device-Service-Specification</h1></header><article><div><span><h4><a class="anchor" aria-hidden="true" id="aug-2019-version-092"></a><a href="#aug-2019-version-092" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Aug 2019 | Version: 0.9.2</h4>
<h4><a class="anchor" aria-hidden="true" id="status-draft"></a><a href="#status-draft" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Status: Draft</h4>
<h2><a class="anchor" aria-hidden="true" id="table-of-contents"></a><a href="#table-of-contents" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table of Contents</h2>
<ol>
<li><p><a href="#1-introduction--background">Introduction &amp; Background</a></p></li>
<li><p><a href="#2-glossary-of-terms">Glossary of Terms</a></p></li>
<li><p><a href="#3-device-specification">Device Specification</a></p></li>
<li><p><a href="#4-device-trust">Device Trust</a></p></li>
<li><p><a href="#5-device-service---communication-interfaces">Device Service - Communication Interfaces</a></p>
<p>5.1. <a href="#51-device-discovery">Device Discovery</a></p>
<p>5.2. <a href="#52-device-info">Device Info</a></p>
<p>5.3 <a href="#53-capture">Capture</a></p>
<p>5.4 <a href="#54-device-stream">Device Stream</a></p>
<p>5.5 <a href="#55-device-registration-capture">Device Registration Capture</a></p></li>
<li><p><a href="#6-device-server">Device Server</a></p>
<p>6.1 <a href="#61-registration">Registration</a></p>
<p>6.2. <a href="#62-de-register">De-Register</a></p></li>
<li><p><a href="#7-management-server">Management Server</a></p></li>
<li><p><a href="#8-compliance">Compliance</a></p></li>
</ol>
<hr>
<h2><a class="anchor" aria-hidden="true" id="1-introduction-background"></a><a href="#1-introduction-background" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Introduction &amp; Background</h2>
<h3><a class="anchor" aria-hidden="true" id="objective"></a><a href="#objective" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objective</h3>
<p>The objective of this specification document is to establish the technical and compliance standards/ protocols that are necessary for a biometric device to be used in MOSIP solutions.</p>
<h3><a class="anchor" aria-hidden="true" id="target-audience"></a><a href="#target-audience" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Target Audience</h3>
<p>This is a biometric device specification document and aims to help the biometric device manufactures, their developers, and their designers in building MOSIP compliant devices.
This document assumes that the readers are familiar with MOSIP registration and authentication services.</p>
<h3><a class="anchor" aria-hidden="true" id="mosip-devices"></a><a href="#mosip-devices" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MOSIP Devices</h3>
<p>All devices that collect biometric data for MOSIP should operate within the specification of this document.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="2-glossary-of-terms"></a><a href="#2-glossary-of-terms" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Glossary of Terms</h2>
<ul>
<li>Device Provider - An entity that manufactures or imports the devices in their name. This entity should have legal rights to obtain an organization level digital certificate from the respective authority in the country.</li>
<li>Foundational Trust Provider - An entity that manufactures the foundational trust module.</li>
<li>Device - A hardware capable of capturing biometric information.</li>
<li>L1 Certified Device / L1 Device - A device certified as capable of performing encryption in line with this spec in its trusted zone.</li>
<li>L0 Certified Device / L0 Device - A device certified as one where the encryption is done on the host machine device driver or the MOSIP device service.</li>
<li>Foundational Trust Provider Certificate - A digital certificate issued to the “Foundational Trust Provider”. This certificate proves that the provider has successfully gone through the required Foundational Trust Provider evaluation. The entity is expected to keep this certificate in secure possession in an HSM. All the individual trust certificates are issued using this certificate as the root. This certificate would be issued  by the countries in conjunction with MOSIP.</li>
<li>Device Provider Certificate - A digital certificate issued to the “Device Provider”. This certificate proves that the provider has been certified for L0/L1 respective compliance. The entity is expected to keep this certificate in secure possession in an HSM. All the individual trust certificates are issued using this certificate as the root. This certificate is issued by the countries in conjunction with MOSIP.</li>
<li>Registration - The process of applying for a Foundational Id.</li>
<li>KYC - Know Your Customer. The process of providing consent to perform profile verification and update.</li>
<li>Auth - The process of verifying one’s identity.</li>
<li>FPS - Frames Per Second</li>
<li>Management Server - A server run by the device provider to manage the life cycle of the biometric devices.</li>
<li>Device Registration - The process of registering the device with MOSIP servers.</li>
<li>Signature - All signature are formated as per RFC 7515.</li>
<li>header in signature - Header in signature means the attribute with &quot;type&quot; set to &quot;MDSSign&quot; &quot;alg&quot; set to RS256 and x5c set to base64encoded certificate.</li>
<li>payload is the byte array of the actual data, always represented as base64urlencoded.</li>
<li>signature - base64urlencoded signature bytes</li>
</ul>
<hr>
<h2><a class="anchor" aria-hidden="true" id="3-device-specification"></a><a href="#3-device-specification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Device Specification</h2>
<p>The MOSIP device specification provides compliance guidelines to devices for them to work with MOSIP. The compliance is based on device capability, trust and communication protocols. A MOSIP compliant device would follow the standards established in this document. It is expected that the devices are compliant to this specification and tested and validated. The details of each of these are outlined in the subsequent sections.</p>
<p><strong>Device Capability:</strong>
The MOSIP compliant device is expected to perform the following:</p>
<ul>
<li>Should have the ability to collect one or more biometric</li>
<li>Should have the ability to sign the captured biometric image or template.</li>
<li>Should have the ability to protect secret keys</li>
<li>Should have no mechanism to inject the biometric</li>
</ul>
<p><strong>Base Specifications for Devices:</strong></p>
<ol>
<li>Fingerprint Capture</li>
</ol>
<table>
  <tr>
   <td><strong>Factor</strong>
   </td>
   <td><strong>Registration Devices</strong>
   </td>
   <td><strong>Authentication Devices</strong>
   </td>
  </tr>
  <tr>
   <td>Minimum Resolution
   </td>
   <td>> 500 native dpi. Bare minimum recommended. Higher densities are preferred
   </td>
   <td>> 500 native dpi. Bare minimum recommended. Higher densities are preferred
   </td>
  </tr>
  <tr>
   <td>Extractor Quality
   </td>
   <td>MINEX compliance
<p>
Number of Minutiae generated by extractor to be in conformance to ISO Specification. Tested for at least 12 Minutiae points generated under test conditions
   </td>
   <td>MINEX compliance
<p>
Number of Minutiae generated by extractor to be in conformance to ISO Specification. Tested for at least 12 Minutiae points generated under test conditions
   </td>
  </tr>
  <tr>
   <td>FRR **
   </td>
   <td>< 2% FRR in respective country
   </td>
   <td>< 2% FRR in respective country
   </td>
  </tr>
  <tr>
   <td>FAR **
   </td>
   <td>0.01%
   </td>
   <td>0.01%
   </td>
  </tr>
  <tr>
   <td>DPI
   </td>
   <td>500 *
   </td>
   <td>500
   </td>
  </tr>
  <tr>
   <td>Image Specification
   </td>
   <td>ISO 19794-4
   </td>
   <td>ISO 19794-4 and ISO 19794-2
   </td>
  </tr>
  <tr>
   <td>ESD
   </td>
   <td>>= 8kv
   </td>
   <td>>= 8kv
   </td>
  </tr>
  <tr>
   <td>EMC compliance
   </td>
   <td>FCC class A or equivalent
   </td>
   <td>FCC class A or equivalent
   </td>
  </tr>
  <tr>
   <td>Operating Temperature**
   </td>
   <td>0 - 50 C
   </td>
   <td>-30 -to 50 C
   </td>
  </tr>
  <tr>
   <td>Liveness detection***
   </td>
   <td>As per IEEE 2790
   </td>
   <td>As per IEEE 2790
   </td>
  </tr>
  <tr>
   <td>Preview
   </td>
   <td>> 3 FPS Jpeg lossless frames with NFIQ 2 score superimposed
   </td>
   <td> None
   </td>
  </tr>
  <tr>
   <td>Image Format
   </td>
   <td>JPEG 2000 lossless
   </td>
   <td>JPEG2000 lossless
   </td>
  </tr>
  <tr>
   <td>Quality Score
   </td>
   <td>NFIQ 2
   </td>
   <td>NFIQ 2
   </td>
  </tr>
</table>
<pre><code class="hljs">* Sufficiency <span class="hljs-keyword">to</span> be validated <span class="hljs-keyword">for</span> registration
** MOSIP adapters can change <span class="hljs-keyword">this</span> <span class="hljs-keyword">if</span> needed 
*** MOSIP adapters <span class="hljs-keyword">to</span> decide <span class="hljs-literal">on</span> the availability <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span> feature
</code></pre>
<ol start="2">
<li>IRIS Capture</li>
</ol>
<p>Refer ISO 19796-6:2011 Part 6 Specifications.</p>
<table>
  <tr>
   <td><strong>Factor</strong>
   </td>
   <td><strong>Registration Devices</strong>
   </td>
   <td><strong>Authentication Devices</strong>
   </td>
  </tr>
  <tr>
   <td>Rotation angle
   </td>
   <td>Before compression, the Iris image will have to be pre-processed to calculate rotation angle. Refer section 6.3.1 of ISO 19794-6 for rotation angle calculation for rectilinear images.
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Rotation Uncertainty
   </td>
   <td>Refer ISO 19794-6
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Minimum Diameter
   </td>
   <td>As per ISO 19794-6:2011 medium and higher quality images are only acceptable,. Hence for this Standard, minimum acceptable Iris diameter will be 150 pixels
   </td>
   <td>Same
   </td>
  </tr>
  <tr>
   <td>Margin
   </td>
   <td>50% left and right of Iris diameter 25% top and bottom of Iris diameter
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Color
   </td>
   <td>The iris images shall be captured and stored in grey scale with pixel depth of 8 bits/pixel.
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Illumination
   </td>
   <td>The eye should be illuminated using infrared or any other source that could produce high quality grayscale image.
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Image Format
   </td>
   <td>JPEG 2000 lossless
   </td>
   <td>JPEG 2000 lossless
   </td>
  </tr>
  <tr>
   <td>Aspect Ratio
   </td>
   <td>1:1
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Image Quality
   </td>
   <td>76-100  IREXII - IQCE
   </td>
   <td>
    76-100  IREXII - IQCE
   </td>
  </tr>
  <tr>
   <td>Operation Temperature*
   </td>
   <td>-30 C to +50 C
   </td>
   <td>-30 C to +50 C
   </td>
  </tr>
  <tr>
   <td>EMC compliance
   </td>
   <td>FCC Class A or equivalent
   </td>
   <td>FCC Class A or equivalent
   </td>
  </tr>
  <tr>
   <td>Preview
   </td>
   <td>> 3 FPS Jpeg lossless frames with quality score superimposed
   </td>
   <td>Not Applicable
   </td>
  </tr>
  <tr>
   <td>Image Specification
   </td>
   <td>ISO 19794-6
   </td>
   <td>ISO 19794-6
   </td>
  </tr>
  <tr>
   <td>ISO Format
   </td>
   <td>K3
   </td>
   <td>K7
   </td>
  </tr>
</table>
<pre><code class="hljs">* MOSIP adopters <span class="hljs-keyword">to</span> decide <span class="hljs-keyword">and</span> <span class="hljs-keyword">finalize</span>
</code></pre>
<ol start="3">
<li>Face Capture</li>
</ol>
<p>Refer ISO 19794-5:2011</p>
<table>
  <tr>
   <td><strong>Factor</strong>
   </td>
   <td><strong>Registration Devices</strong>
   </td>
   <td><strong>Authentication Devices</strong>
   </td>
  </tr>
  <tr>
   <td>Minimum Resolution
   </td>
   <td>1080 Pixels at 2.8 mm with 110 degree view
   </td>
   <td>1080 Pixels at 2.8 mm
   </td>
  </tr>
  <tr>
   <td>Skin Tone
   </td>
   <td>All
   </td>
   <td>All
   </td>
  </tr>
  <tr>
   <td>Operation Temperature*
   </td>
   <td>-30 C to +50 C
   </td>
   <td>-30 C to +50 C
   </td>
  </tr>
  <tr>
   <td>EMC compliance
   </td>
   <td>FCC Class A or equivalent
   </td>
   <td>FCC Class A or equivalent
   </td>
  </tr>
  <tr>
   <td>Image Specification
   </td>
   <td>ISO/IEC 19794 - 5
   </td>
   <td>ISO/IEC 19794 - 5
   </td>
  </tr>
  <tr>
   <td>Image quality
   </td>
   <td>ICAO - Full frontal image, +/- 5 degrees rotation, 24 bit RGB, white background, 35 mm width, 45 mm height
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>Image format
   </td>
   <td>JPEG 2000 lossless
   </td>
   <td>JPEG 2000 lossless
   </td>
  </tr>
</table>
<p>We recommend that countries look at ergonomics, accessibility, ease of usage, and common availability of devices while choosing devices for use in registration and authentication scenarios.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="4-device-trust"></a><a href="#4-device-trust" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Device Trust</h2>
<p>MOSIP compliant devices provide a trust environment for the devices to be used in registration, KYC and auth scenarios. The trust level is established based on the device support for trusted execution.</p>
<h3><a class="anchor" aria-hidden="true" id="foundational-trust-module-ftm"></a><a href="#foundational-trust-module-ftm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Foundational Trust Module (FTM):</h3>
<p>The foundational trust module would be created using a secure microprocessor capable of performing all required biometric processing and secure storage of keys. The foundational device trust would satisfy the below requirements.</p>
<ol>
<li>The module has the ability to securely generate, store and process cryptographic keys.</li>
<li>Generation of asymmetric keys and symmetric keys in random.</li>
<li>The module has the ability to protect keys from extraction.</li>
<li>The module has to protect the keys from physical tampering, temperature, frequency and voltage related attacks.</li>
<li>The module has the ability to perform a cryptographically validatable secure boot.</li>
<li>The module has the ability to run trusted applications.
The foundational device trust derived from this module is used to enable trust-based computing for biometric capture.
The foundational device trust module provides for a trusted execution environment based on the following.</li>
<li>Secure Boot
<ol>
<li>Ability to cryptographically verify code before execution.</li>
<li>Ability to check for integrity violation of the module/device</li>
<li>Halt upon failure.</li>
<li>Ability to securely upgrade and perform forward only upgrades, to thwart downgrade attacks.</li>
</ol></li>
<li>Secure application
<ol>
<li>Ability to run applications that are trusted.</li>
<li>Protect against downgrading of applications.</li>
</ol></li>
</ol>
<p><strong>Foundational Trust Module Identity:</strong></p>
<p>The foundational module upon its first boot is expected to generate a random asymmetric key pair and provide the public part of the key to obtain a valid certificate. The entire certificate issuance would be in a secured provisioning facility. The certificate issued to the module will have a defined validity period as per the MOSIP certificate policy document defined by the MOSIP adopters.</p>
<p><strong>Device Identity:</strong></p>
<p>As MOSIP deals with biometrics it is imperative that all devices that connect to MOSIP are identifiable. MOSIP believes in cryptographic Identity as its basis for trust.</p>
<p><strong>Physical Id:</strong> An identification mark that shows MOSIP compliance and a readable unique device serial number (minimum of 12 digits), make and model. The same information has to be available over a 2D QR Code or Barcode.</p>
<p><strong>Digital Id:</strong> A digital device Id in MOSIP would be a signed JSON (RFC 7515) as follows:</p>
<pre><code class="hljs">{
    “serialNo”: <span class="hljs-string">"Serial number"</span>,

    “make”: <span class="hljs-string">"Make of the device"</span>,

    “model” : <span class="hljs-string">"Model of the device"</span>,

    “type”: [“Fingerprint”, “Iris”, “Face<span class="hljs-string">"], //More types will be added.

    “subType”: "</span>subtypes of the biometric device<span class="hljs-string">",

    “deviceProvider”: "</span>Device provider name<span class="hljs-string">",

    “deviceProviderId”: "</span>Device provider Id<span class="hljs-string">",

    “dateTime”: "</span>Datetime <span class="hljs-keyword">in</span> ISO format with timezone. <span class="hljs-built_in"> Identity </span>request time<span class="hljs-string">"

}
</span></code></pre>
<p>Signed with the JSON Web Signature (RFC 7515) using the “Foundational Trust Module” Identity key, this data is the fundamental identity of the device.  Every MOSIP compliant device will need the foundational trust module.</p>
<p>The only exception to this rule is for the devices that have the purpose (explained below during device registration)  as &quot;Registration&quot;. Those devices are called as L0 where there is not FTM. These devices would sign the request with device key.</p>
<p>Signed Digital Id would look as follows.</p>
<pre><code class="hljs"><span class="hljs-string">"digitalId"</span>: <span class="hljs-string">"base64urlencoded(header).base64urlencoded(payload).base64urlencoded(signature)"</span>
</code></pre>
<p>Unsigned digital Id would look as follows.</p>
<pre><code class="hljs"><span class="hljs-string">"digitalId"</span>: <span class="hljs-string">"base64urlencoded(payload)"</span>
</code></pre>
<p>payload is the Digital ID json object.</p>
<p><strong>Accepted Values</strong>:</p>
<pre><code class="hljs">    serialNo - Same <span class="hljs-keyword">as</span> the Physical Id

    make - Brand <span class="hljs-type">name</span>

    model - Model <span class="hljs-keyword">of</span> the device

    <span class="hljs-keyword">type</span> - [“Fingerprint”, “Iris”, “Face’’], //More <span class="hljs-keyword">types</span> will be added.
    
    subType - subtype <span class="hljs-keyword">is</span> based <span class="hljs-keyword">on</span> the <span class="hljs-keyword">type</span>.

    Finger - “Slab”, “Single”, “Touchless”

                Iris - “Single”, “<span class="hljs-type">Double</span>”,

               Face - <span class="hljs-keyword">Full</span> face

    deviceProvider - Device provider <span class="hljs-type">name</span>, This would be a legal entity <span class="hljs-keyword">in</span> the country,

    deviceProviderId: Device provider Id issued <span class="hljs-keyword">by</span> MOSIP
    
    dateTime:  ISO <span class="hljs-keyword">format</span> <span class="hljs-keyword">with</span> timezone.  <span class="hljs-keyword">Identity</span> request <span class="hljs-type">time</span> 
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="5-device-service-communication-interfaces"></a><a href="#5-device-service-communication-interfaces" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Device Service - Communication Interfaces</h2>
<p>The section explains the necessary details of the biometric device connectivity, accessibility, discoverability and protocols used to build and communicate with the device.</p>
<p>The device should implement only the following set of APIs.  All the API’s are independent of the physical layer and the operating system, with the invocation being different across operating systems. While the operating system names are defined in this spec a similar technology can be used for unspecified operating systems.</p>
<p>It is expected that the device service ensures that the device is connected  locally to the host.</p>
<h3><a class="anchor" aria-hidden="true" id="51-device-discovery"></a><a href="#51-device-discovery" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.1 Device Discovery:</h3>
<h4><a class="anchor" aria-hidden="true" id="specifications-for-windows-and-linux"></a><a href="#specifications-for-windows-and-linux" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Specifications for Windows and Linux</h4>
<p>Device discovery would be used to identify MOSIP compliant devices in a system by the applications. The protocol is designed as simple plug and play with all the necessary abstraction to the specifics.
Discovery Request:</p>
<p><strong>Request:</strong></p>
<pre><code class="hljs">{

“<span class="hljs-keyword">type</span>”: "<span class="hljs-keyword">type</span> of the device"

}
</code></pre>
<p>**Accepted Values **</p>
<pre><code class="hljs"><span class="hljs-attribute">type</span>: “Biometric Device”, “Fingerprint”, “Face”, “Iris”

<span class="routeros">Note: “Biometric Device” - is a special<span class="hljs-built_in"> type </span><span class="hljs-keyword">and</span> used <span class="hljs-keyword">in</span> case <span class="hljs-keyword">if</span> you are looking <span class="hljs-keyword">for</span> any biometric device.
</span></code></pre>
<p><strong>Response:</strong></p>
<pre><code class="hljs">[
    {    
    “deviceId”: <span class="hljs-string">"internal Id"</span>,
    “deviceStatus”: <span class="hljs-string">"device status"</span>,
    “certification”: <span class="hljs-string">"certification level"</span>,
    “serviceVersion”: <span class="hljs-string">"device service version"</span>,
    “deviceSubId”: <span class="hljs-string">"device sub Id’s"</span>,
    “callbackId”: <span class="hljs-string">"baseurl to reach to the device“,
    "</span>digitalId<span class="hljs-string">": "</span>unsigned digital id of the device<span class="hljs-string">",
    "</span>deviceCode<span class="hljs-string">": "</span>A unique code given by MOSIP after successful registration<span class="hljs-string">",
    "</span>specVersion<span class="hljs-string">": ["</span>Array of supported MDS specification version<span class="hljs-string">"],
    "</span>purpose<span class="hljs-string">": "</span>Auth  <span class="hljs-keyword">or</span> Registration <span class="hljs-keyword">or</span> empty <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> registered<span class="hljs-string">",
    "</span>error<span class="hljs-string">": {
        "</span>errorcode<span class="hljs-string">": "</span>101<span class="hljs-string">",
        "</span>errorinfo<span class="hljs-string">": "</span>Invalid JSON Value<span class="hljs-built_in"> Type </span><span class="hljs-keyword">For</span> Discovery<span class="hljs-built_in">..</span> 
        }
    },
    <span class="hljs-built_in">..</span>.
]
</code></pre>
<p><strong>Accepted values:</strong></p>
<pre><code class="hljs">
deviceStatus - “Active”, “Inactive <span class="hljs-keyword">or</span> <span class="hljs-keyword">Not</span> Registered”

certification - “L0”, “L1” - <span class="hljs-keyword">Level</span> <span class="hljs-keyword">of</span> certification

serviceVersion - <span class="hljs-keyword">Version</span> <span class="hljs-keyword">of</span> the MDS specification that <span class="hljs-keyword">is</span> supported.

deviceId - <span class="hljs-type">Internal</span> Id <span class="hljs-keyword">to</span> identify the actual biometric device <span class="hljs-keyword">within</span> the device service.

deviceSubId - <span class="hljs-keyword">is</span> the <span class="hljs-type">internal</span> Id <span class="hljs-keyword">of</span> the device. <span class="hljs-keyword">For</span> example <span class="hljs-keyword">in</span> <span class="hljs-keyword">case</span> <span class="hljs-keyword">of</span> iris capture, the device can have two modules <span class="hljs-keyword">in</span> a single device, it <span class="hljs-keyword">is</span> possible <span class="hljs-keyword">to</span> address <span class="hljs-keyword">each</span> device <span class="hljs-keyword">with</span> a sub Id so we can identify <span class="hljs-keyword">or</span> command <span class="hljs-keyword">each</span> <span class="hljs-keyword">of</span> it <span class="hljs-keyword">in</span> <span class="hljs-keyword">isolation</span>. Sub Id <span class="hljs-keyword">is</span> a simple <span class="hljs-keyword">index</span> which <span class="hljs-keyword">always</span> starts <span class="hljs-keyword">with</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> increases sequentially <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> sub device present.

callbackId - this differs <span class="hljs-keyword">as</span> per the OS. <span class="hljs-keyword">In</span> <span class="hljs-keyword">case</span> <span class="hljs-keyword">of</span> Linux <span class="hljs-keyword">and</span> windows operating systems it <span class="hljs-keyword">is</span> a http URL. <span class="hljs-keyword">In</span> the <span class="hljs-keyword">case</span> <span class="hljs-keyword">of</span> android, it <span class="hljs-keyword">is</span> the intent <span class="hljs-type">name</span>. <span class="hljs-keyword">In</span> IOS it <span class="hljs-keyword">is</span> the URL scheme. The <span class="hljs-keyword">call</span> back url takes precedence <span class="hljs-keyword">over</span> future request <span class="hljs-keyword">as</span> a base URL.

digitalId - unsigned digital id <span class="hljs-keyword">as</span> per the Digital Id definition.  

deviceCode: A <span class="hljs-keyword">unique</span> code given <span class="hljs-keyword">by</span> MOSIP <span class="hljs-keyword">after</span> successful registration,

specVersion - <span class="hljs-keyword">Array</span> <span class="hljs-keyword">of</span> supported MDS specification <span class="hljs-keyword">version</span>",

purpose - Purpose of the device in the MOSIP ecosystem.

errorCode - standardized error code.
errorInfo - description of the error that can be displayed to end user. Multi lingual support. 

</code></pre>
<p>Note: The response is an array that we could have a single device enumerating with multiple biometric options.</p>
<p>Note: The service should ensure to respond only if the type parameter matches the type of device or the type parameter is a “Biometric Device”.</p>
<h4><a class="anchor" aria-hidden="true" id="windows-linux"></a><a href="#windows-linux" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows/Linux:</h4>
<p>All the device API will be based on the HTTP specification. The device always binds to 127.0.0.1 with any of the available ports ranging from 4501 - 4600.  The IP address used for binding has to be 127.0.0.1 and not localhost.
The applications that require access to MOSIP devices could discover them by sending the http request to the supported port range.</p>
<p><strong><em>HTTP Request:</em></strong></p>
<pre><code class="hljs">MOSIPDISC http:<span class="hljs-comment">//127.0.0.1:&lt;device_service_port&gt;/device</span>
<span class="hljs-symbol">HOST:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>: <span class="hljs-params">&lt;apps port&gt;</span>
<span class="hljs-symbol">EXT:</span> <span class="hljs-params">&lt;app name&gt;</span>
</code></pre>
<p><strong><em>HTTP Response:</em></strong></p>
<pre><code class="hljs">HTTP/1.1 200 ok
<span class="hljs-keyword">CACHE</span>-CONTROL:<span class="hljs-keyword">no</span>-<span class="hljs-keyword">store</span>
LOCATION:<span class="hljs-keyword">http</span>://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:&lt;device_service_port&gt;
<span class="hljs-keyword">Content</span>-<span class="hljs-keyword">Length</span>: <span class="hljs-keyword">length</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">bytes</span> <span class="hljs-keyword">of</span> the <span class="hljs-keyword">body</span>
<span class="hljs-keyword">Content</span>-<span class="hljs-keyword">Type</span>: application/<span class="hljs-keyword">json</span>
<span class="hljs-keyword">Connection</span>: Closed
</code></pre>
<p>Note: the pay loads are json in both the cases and are part of the body.</p>
<p>*callbackId would be set to the <a href="http://127.0.0.1">http://127.0.0.1</a>:&lt;device_service_port&gt;. So, the caller will use the respective verb and the url to call the service.</p>
<h4><a class="anchor" aria-hidden="true" id="android"></a><a href="#android" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Android:</h4>
<p>All devices on an android device should listen to the following intent io.mosip.device
Upon invocation of this intent the devices are expected to respond back with the json response filtered by the respective type.</p>
<p>*callbackId would be set to the appId. So, the caller will create the intent appId.Info or appId.Capture</p>
<h4><a class="anchor" aria-hidden="true" id="ios"></a><a href="#ios" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IOS:</h4>
<p>All device on an IOS device would respond to the url schema as follows.
MOSIPDISC://&lt;call-back-app-url&gt;?ext=<caller app name>&amp;type=<type as defined in mosip device request>
If a MOSIP compliant device service app exist then the url would launch the service. The service in return should respond back to the caller using the call-back-app-url with the base64 encoded json as the url parameter for the key data.</p>
<p>Note: In IOS there are restrictions to have multiple apps registering to the same URL schema.</p>
<p>*callbackId would be set to the device service appname. So, the caller has to call appnameInfo or appnameCapture as the url scheme.</p>
<h3><a class="anchor" aria-hidden="true" id="52-device-info"></a><a href="#52-device-info" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.2 Device Info:</h3>
<p>The device information API would be used to identify the MOSIP compliant devices and their status by the applications.</p>
<p>Device Info Request:</p>
<p><strong>Request:</strong></p>
<p>NONE</p>
<p><strong>Accepted Values</strong></p>
<p><strong>Response:</strong></p>
<pre><code class="hljs">[
    {
        deviceInfo: { 
        “status”: <span class="hljs-string">"current status"</span>,
        “deviceId”: <span class="hljs-string">"internal Id"</span>,
        “deviceStatus”: <span class="hljs-string">"device status"</span>,
        “firmware”: <span class="hljs-string">"firmware version"</span>,
        “certification”: <span class="hljs-string">"certification level"</span>,
        “serviceVersion”: <span class="hljs-string">"device service version"</span>,
        “deviceSubId”: <span class="hljs-string">"device sub Id’s"</span>,
        “callbackId”: <span class="hljs-string">"baseurl to reach to the device“,
        "</span>digitalId<span class="hljs-string">": "</span>signed digital <span class="hljs-built_in">id</span> <span class="hljs-keyword">as</span> described <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> digital <span class="hljs-built_in">id</span> section <span class="hljs-keyword">of</span> this document<span class="hljs-string">",
        "</span>deviceCode<span class="hljs-string">": "</span>A unique code <span class="hljs-keyword">given</span> <span class="hljs-keyword">by</span> MOSIP <span class="hljs-keyword">after</span> successful registration<span class="hljs-string">",
        "</span>purpose<span class="hljs-string">": "</span>Auth  <span class="hljs-keyword">or</span> Registration<span class="hljs-string">",
        "</span>specVersion<span class="hljs-string">": ["</span>Array <span class="hljs-keyword">of</span> supported MDS specification <span class="hljs-built_in">version</span><span class="hljs-string">"],
         },
        "</span><span class="hljs-keyword">error</span><span class="hljs-string">": {
            "</span>errorcode<span class="hljs-string">": "</span><span class="hljs-number">101</span><span class="hljs-string">",
            "</span>errorinfo<span class="hljs-string">": "</span>Invalid JSON Value <span class="hljs-string">"
        }
    }
    ...
]
</span></code></pre>
<p>The final JSON is Signed with the JSON Web Signature using the “Foundational Trust Module” Identity key, this data is the fundamental identity of the device.  Every MOSIP compliant device will need the foundational trust module.</p>
<p>So the API would respond in the following format.</p>
<pre><code class="hljs">[
 {
  <span class="hljs-attr">"deviceInfo"</span>: <span class="hljs-string">"base64urlencode(header).base64urlencode(payload).base64urlencode(signature)"</span>
  <span class="hljs-string">"error"</span>: {
     <span class="hljs-attr">"errorcode"</span>: <span class="hljs-string">"100"</span>,
      <span class="hljs-attr">"errorinfo"</span>: <span class="hljs-string">"Device not registered. In this case the device info will be only base64urlencode(payload)"</span>
   }
 }
]
</code></pre>
<p><strong>Allowed values:</strong></p>
<pre><code class="hljs">
deviceInfo.status - “Ready”, “Busy”, “Not Ready”, <span class="hljs-string">"Not Registered"</span> 
deviceInfo.deviceId - Internal Id <span class="hljs-built_in">to</span> identify <span class="hljs-keyword">the</span> actual biometric device <span class="hljs-keyword">within</span> <span class="hljs-keyword">the</span> device service.
deviceInfo.deviceStatus - <span class="hljs-string">"Active"</span> <span class="hljs-keyword">or</span> <span class="hljs-string">"InActive"</span>
deviceInfo.firmware - Exact <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> firmware
deviceInfo.certification - “L0”, “L1” - Level <span class="hljs-keyword">of</span> certification
deviceInfo.serviceVersion - Version <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> current document.
deviceInfo.biometric device <span class="hljs-keyword">within</span> <span class="hljs-keyword">the</span> device service.
deviceInfo.deviceSubId - is <span class="hljs-keyword">the</span> internal id <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> device. In <span class="hljs-keyword">case</span> <span class="hljs-keyword">of</span> iris when we have <span class="hljs-literal">two</span> iris capture modules <span class="hljs-keyword">in</span> <span class="hljs-keyword">a</span> single device, <span class="hljs-keyword">it</span> is possible <span class="hljs-built_in">to</span> address <span class="hljs-keyword">each</span> device <span class="hljs-keyword">with</span> <span class="hljs-keyword">a</span> sub Id so we can identify <span class="hljs-keyword">or</span> <span class="hljs-keyword">command</span> <span class="hljs-title">each</span> <span class="hljs-title">of</span> <span class="hljs-title">it</span> <span class="hljs-title">in</span> <span class="hljs-title">isolation</span>. <span class="hljs-title">This</span> <span class="hljs-title">in</span> <span class="hljs-title">an</span> <span class="hljs-title">index</span> <span class="hljs-title">that</span> <span class="hljs-title">always</span> <span class="hljs-title">starts</span> <span class="hljs-title">with</span> <span class="hljs-title">1</span> <span class="hljs-title">and</span> <span class="hljs-title">increments</span> <span class="hljs-title">sequentially</span>.
deviceInfo.callbackId - base <span class="hljs-built_in">URL</span> <span class="hljs-built_in">to</span> communicate
deviceInfo.digitalId - <span class="hljs-keyword">as</span> defined under <span class="hljs-keyword">the</span> digital id section <span class="hljs-keyword">for</span> unsigned digital id.
deviceInfo.purpose - <span class="hljs-string">"Auth"</span> <span class="hljs-keyword">or</span> <span class="hljs-string">"Registration"</span> <span class="hljs-keyword">or</span> <span class="hljs-literal">empty</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">case</span> <span class="hljs-keyword">the</span> status is <span class="hljs-string">"Not Registered"</span>
deviceInfo.specVersion: <span class="hljs-string">"Array of MDS specification version"</span>,
error - relevant errors <span class="hljs-keyword">as</span> defined under <span class="hljs-keyword">the</span> <span class="hljs-string">"Error section"</span> <span class="hljs-keyword">of</span> this document

</code></pre>
<p><strong><em>Note</em></strong>: The response is an array that we could have a single device enumerating with multiple biometric options.</p>
<p><strong><em>Note</em></strong>: The service should ensure to respond only if the type parameter matches the type of device or the type parameter is a “Biometric Device”.</p>
<h4><a class="anchor" aria-hidden="true" id="windows-linux-1"></a><a href="#windows-linux-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows/Linux:</h4>
<p>The applications that require more details of the MOSIP devices could get them by sending the http request to the supported port range.</p>
<p><strong><em>HTTP Request:</em></strong></p>
<pre><code class="hljs">MOSIPDINFO http:<span class="hljs-comment">//127.0.0.1:4501/info</span>
<span class="hljs-symbol">HOST:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>: <span class="hljs-params">&lt;apps port&gt;</span>
<span class="hljs-symbol">EXT:</span> <span class="hljs-params">&lt;app name&gt;</span>
</code></pre>
<p><strong><em>HTTP Response:</em></strong></p>
<pre><code class="hljs">HTTP/1.1 200 ok
<span class="hljs-keyword">CACHE</span>-CONTROL:<span class="hljs-keyword">no</span>-<span class="hljs-keyword">store</span>
LOCATION:<span class="hljs-keyword">http</span>://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:&lt;device_service_port&gt;
<span class="hljs-keyword">Content</span>-<span class="hljs-keyword">Length</span>: <span class="hljs-keyword">length</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">bytes</span> <span class="hljs-keyword">of</span> the <span class="hljs-keyword">body</span>
<span class="hljs-keyword">Content</span>-<span class="hljs-keyword">Type</span>: application/<span class="hljs-keyword">json</span>
<span class="hljs-keyword">Connection</span>: Closed
</code></pre>
<p>Note: the pay loads are json in both the cases and are part of the body.</p>
<h4><a class="anchor" aria-hidden="true" id="android-1"></a><a href="#android-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Android:</h4>
<p>On an android device should listen to the following intent appId.Info
Upon invocation of this intent the devices are expected to respond back with the json response filtered by the respective type.</p>
<h4><a class="anchor" aria-hidden="true" id="ios-1"></a><a href="#ios-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IOS:</h4>
<p>On an IOS device would respond to the url schema as follows.
APPIDINFO://&lt;call-back-app-url&gt;?ext=<caller app name>&amp;type=<type as defined in mosip device request>
If a MOSIP compliant device service app exist then the url would launch the service. The service in return should respond back to the called using the call-back-app-url with the base64 encoded json as the url parameter for the key data.</p>
<p>Note: In IOS there are restrictions to have multiple app registering to the same URL schema.</p>
<h3><a class="anchor" aria-hidden="true" id="53-capture"></a><a href="#53-capture" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.3 Capture:</h3>
<p>The capture request would be used to capture a biometric from MOSIP compliant devices by the applications.  The capture call will respond with success to only one call at a time. So in case of a parallel call the device info details are sent with status as “Busy”</p>
<p>Capture Request:</p>
<p><strong>Request:</strong></p>
<pre><code class="hljs">{
    “env”:  <span class="hljs-string">"target environment"</span>,
    <span class="hljs-string">"purpose"</span>: <span class="hljs-string">"Auth  or Registration"</span>,
    <span class="hljs-string">"specVersion"</span>: <span class="hljs-string">"expected version of the biometric element"</span>,
    <span class="hljs-string">"timeout"</span> : &lt;timeout <span class="hljs-keyword">for</span> capture&gt;,
    “captureTime”: &lt;time of capture request in ISO format including timezone&gt;,
    <span class="hljs-string">"domainUri"</span>: &lt;uri of the auth server&gt;,
    “transactionId”: &lt;transaction Id <span class="hljs-keyword">for</span> the current capture&gt;,

    “bio”: [
        {
            “<span class="hljs-built_in">type</span>”: &lt;<span class="hljs-built_in">type</span> of the biometric data&gt;,
            “<span class="hljs-built_in">count</span>”:  &lt;fingerprint/Iris <span class="hljs-built_in">count</span>, in case of face <span class="hljs-built_in">max</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span> <span class="hljs-number">1</span>&gt;,

            “requestedScore”: &lt;expected quality score that should <span class="hljs-keyword">match</span> <span class="hljs-keyword">to</span> <span class="hljs-built_in">complete</span> <span class="hljs-keyword">a</span> successful capture&gt;,
            “deviceId”: &lt;internal Id&gt;,
            “deviceSubId”: &lt;specific device Id&gt;,
            “previousHash”: &lt;hash of the <span class="hljs-keyword">previous</span> block&gt;
        }
    ],
    customOpt<span class="hljs-variable">s:</span>
    {
        //<span class="hljs-built_in">max</span> of <span class="hljs-number">50</span> key value pair. This <span class="hljs-keyword">is</span> <span class="hljs-keyword">so</span> that vendor specific parameters can <span class="hljs-keyword">be</span> sent <span class="hljs-keyword">if</span> necessary. The <span class="hljs-built_in">values</span> cannot <span class="hljs-keyword">be</span> hardcoded <span class="hljs-built_in">and</span> have <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> configured by the apps server <span class="hljs-built_in">and</span> should <span class="hljs-keyword">be</span> modifiable upon need by the applications. Vendors are free <span class="hljs-keyword">to</span> include additional parameters <span class="hljs-built_in">and</span> fine-tuning parameters. None of these <span class="hljs-built_in">values</span> should <span class="hljs-keyword">go</span> undocumented by the vendor. No sensitive data should <span class="hljs-keyword">be</span> available in the customOpts.
    }

}
</code></pre>
<p><strong>Allowed Values:</strong></p>
<pre><code class="hljs">
env - Allowed <span class="hljs-keyword">values</span> <span class="hljs-keyword">are</span> Staging| Developer| Pre-Production | Production

purpose - Allowed <span class="hljs-keyword">values</span> <span class="hljs-keyword">are</span> Auth| Registration

<span class="hljs-keyword">version</span> - <span class="hljs-keyword">version</span> <span class="hljs-keyword">of</span> the biometric <span class="hljs-keyword">block</span> <span class="hljs-keyword">as</span> specified <span class="hljs-keyword">in</span> the <span class="hljs-keyword">authentication</span> <span class="hljs-keyword">or</span> customer registration specification.

<span class="hljs-keyword">timeout</span> - <span class="hljs-keyword">Max</span> <span class="hljs-built_in">time</span> the app will <span class="hljs-keyword">wait</span> <span class="hljs-keyword">for</span> the capture. Its expected that the api will respond back <span class="hljs-keyword">before</span> <span class="hljs-keyword">timeout</span> <span class="hljs-keyword">with</span> the best frame. <span class="hljs-keyword">All</span> timeouts <span class="hljs-keyword">are</span> <span class="hljs-keyword">in</span> milliseconds

captureTime - <span class="hljs-built_in">time</span> <span class="hljs-keyword">of</span> capture <span class="hljs-keyword">in</span> ISO <span class="hljs-keyword">format</span> <span class="hljs-keyword">with</span> timezone.

domainUri - <span class="hljs-keyword">unique</span> uri per auth providers. This can be used <span class="hljs-keyword">to</span> federate across multiple providers <span class="hljs-keyword">or</span> countries <span class="hljs-keyword">or</span> unions.

transactionId - unqiue <span class="hljs-keyword">Id</span> <span class="hljs-keyword">of</span> the transaction. This <span class="hljs-keyword">is</span> an internal <span class="hljs-keyword">Id</span> <span class="hljs-keyword">to</span> the application thats providing the service. <span class="hljs-keyword">Use</span> different <span class="hljs-keyword">id</span> <span class="hljs-keyword">for</span> every successfull auth. So even <span class="hljs-keyword">if</span> the trnsaction fails <span class="hljs-keyword">after</span> auth we expect this <span class="hljs-built_in">number</span> <span class="hljs-keyword">to</span> be unique.

bio.type -  “FIR” , “IIR”, “Face”

bio.count - <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> biometric <span class="hljs-keyword">data</span> that <span class="hljs-keyword">is</span> collected <span class="hljs-keyword">for</span> a given type. The device should <span class="hljs-keyword">validate</span> <span class="hljs-keyword">and</span> ensure that this <span class="hljs-built_in">number</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">with</span> the <span class="hljs-keyword">type</span> <span class="hljs-keyword">of</span> biometric that<span class="hljs-string">'s captured.

bio.requestedScore - what is the expected quality? Upon reaching the necessary quality the biometric device is expected to auto capture the image.

bio.deviceId - a unique Id per device service. In case a single device handles both face and iris the device Id will identify iris and camera uniquely. In case the Id is sent as 0 then the device is expected to capture biometric from both the devices.

bio.deviceSubId  - a specific device sub Id.  Should be set to 0 if we don'</span>t know <span class="hljs-keyword">any</span> specific device sub Id.

bio.previousHash - <span class="hljs-keyword">For</span> the <span class="hljs-keyword">first</span> capture the previousHash <span class="hljs-keyword">is</span> <span class="hljs-keyword">hash</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">empty</span> utf8 string. <span class="hljs-keyword">From</span> the <span class="hljs-keyword">second</span> capture the previous captures <span class="hljs-keyword">hash</span> (<span class="hljs-keyword">as</span> <span class="hljs-keyword">hex</span> encoded) <span class="hljs-keyword">is</span> used <span class="hljs-keyword">as</span> input. This <span class="hljs-keyword">is</span> used <span class="hljs-keyword">to</span> <span class="hljs-keyword">chain</span> <span class="hljs-keyword">all</span> the captures across modalities so <span class="hljs-keyword">all</span> captures have happened <span class="hljs-keyword">for</span> the same <span class="hljs-keyword">transaction</span> <span class="hljs-keyword">and</span> during the same <span class="hljs-built_in">time</span> period. 

customOpts - <span class="hljs-keyword">If</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">case</span> the device vendor has additional <span class="hljs-keyword">parameters</span> that they can take <span class="hljs-keyword">and</span> act accordingly <span class="hljs-keyword">then</span> those <span class="hljs-keyword">values</span> can be sent <span class="hljs-keyword">by</span> the application developers <span class="hljs-keyword">to</span> the device service.
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="hljs">[

        {
          <span class="hljs-attr">"specVersion"</span> : <span class="hljs-string">"MDS spec version"</span>,
          <span class="hljs-attr">"data"</span>: { 

            <span class="hljs-attr">"digitalId"</span> : <span class="hljs-string">"unsigned digital Id as described in this document"</span>,

            <span class="hljs-attr">"deviceCode"</span>: <span class="hljs-string">"A unique code given by MOSIP after successfull registration"</span>,

            <span class="hljs-attr">"deviceServiceVersion"</span>: <span class="hljs-string">"Service version"</span>,

            <span class="hljs-attr">"bioType"</span>: <span class="hljs-string">"FIR"</span>,

            <span class="hljs-attr">"bioSubType"</span>: <span class="hljs-string">"UNKNOWN"</span>,
            
            <span class="hljs-attr">"purpose"</span>: <span class="hljs-string">"Auth  or Registration"</span>,

            <span class="hljs-attr">"env"</span>:  <span class="hljs-string">"target environment"</span>,

            <span class="hljs-attr">"domainUri"</span>: <span class="hljs-string">"uri of the auth server"</span>,

            <span class="hljs-attr">"bioValue"</span>: <span class="hljs-string">"encrypted with session key and base64urlencoded biometric data"</span>,

            <span class="hljs-attr">"transactionId"</span>: <span class="hljs-string">"unique transaction id"</span>,

            <span class="hljs-attr">"timestamp"</span>: <span class="hljs-string">"ISO format datetime with time zone"</span>,

            <span class="hljs-attr">"requestedScore"</span>: <span class="hljs-string">"floating point number to represent the minimum required score for the capture"</span>,

            <span class="hljs-attr">"qualityScore"</span>: <span class="hljs-string">"floating point number representing the score for the current capture"</span>

          },

          <span class="hljs-attr">"hash"</span>: <span class="hljs-string">"sha256(sha256 hash in hex format of the previous data block + sha256 hash in hex format of the current data block before encryption)"</span>,

          <span class="hljs-attr">"sessionKey"</span>: <span class="hljs-string">"encrypted with MOSIP public key (dynamically selected based on the uri) and encoded session key biometric"</span>,

          <span class="hljs-attr">"error"</span>: {

        <span class="hljs-attr">"errorcode"</span>: <span class="hljs-string">"101"</span>,

        <span class="hljs-attr">"errorinfo"</span>: <span class="hljs-string">"Invalid JSON Value"</span>

    }

    },

        {
          <span class="hljs-attr">"specVersion"</span> : <span class="hljs-string">"MDS spec version"</span>,
          <span class="hljs-attr">"data"</span>: {

            <span class="hljs-attr">"digitalId"</span>: <span class="hljs-string">"unsigned digital Id as described in this document"</span>,
 
            <span class="hljs-attr">"deviceCode"</span>: <span class="hljs-string">"A unique code given by MOSIP after successfull registration"</span>,

            <span class="hljs-attr">"deviceServiceVersion"</span>: <span class="hljs-string">"Service version"</span>,

            <span class="hljs-attr">"bioType"</span>: <span class="hljs-string">"FIR"</span>,

            <span class="hljs-attr">"bioSubType"</span>: <span class="hljs-string">"LEFT"</span>,

            <span class="hljs-attr">"purpose"</span>: <span class="hljs-string">"Auth  or Registration"</span>,
            
            <span class="hljs-attr">"env"</span>:  <span class="hljs-string">"target environment"</span>, 
            
            <span class="hljs-attr">"domainUri"</span>: <span class="hljs-string">"uri of the auth server"</span>,          

            <span class="hljs-attr">"bioValue"</span>: <span class="hljs-string">"encrypted with session key and base64urlencoded biometric data"</span>,

            <span class="hljs-attr">"transactionId"</span>: <span class="hljs-string">"unique transaction id"</span>,

            <span class="hljs-attr">"timestamp"</span>: <span class="hljs-string">"ISO Format date time with timezone"</span>

          },

          <span class="hljs-attr">"hash"</span>: <span class="hljs-string">"sha256(sha256 hash in hex format of the previous data block + sha256 hash in hex format of the current data block before encryption)"</span>,

          <span class="hljs-attr">"sessionKey"</span>: <span class="hljs-string">"encrypted with MOSIP public key and encoded session key biometric"</span>,

          <span class="hljs-attr">"error"</span>: {

             <span class="hljs-attr">"errorcode"</span>: <span class="hljs-string">"101"</span>,

              <span class="hljs-attr">"errorinfo"</span>: <span class="hljs-string">"Invalid JSON Value"</span>

         }

    }

]
</code></pre>
<p><strong>Accepted values:</strong></p>
<p>data.bioValue - Encrypted and Encoded to base64urlencode biometric value. AES GCM encryption with a random key. The IV for the encryption is set to last 16 digits of the timestamp. ISO formated bioValue. Look at the Authentication document to understand more about the encryption.</p>
<p>data - The entire data object is stored as follows.</p>
<pre><code class="hljs"><span class="hljs-string">"data"</span> : "<span class="hljs-type">base64urlencode</span>(header).base64urlencode(payload).base64urlencode(signature)

payload <span class="hljs-keyword">is</span> defined as the entire byte <span class="hljs-keyword">array</span> <span class="hljs-keyword">of</span> data block. The data block
</code></pre>
<p>hash - the value of the previousHash atribute in the request object or the value of hash atribute of the previous data block (used to chain every single data block) concatenated with the hex encode sha256 hash of the current data block before encryption.<br>
sessionKey - Random AES key used for the encryption of the bioValue. The encryption key is encrypted using the public key with RSA OAEP. Sent as base64urlencoded</p>
<h4><a class="anchor" aria-hidden="true" id="windows-linux-2"></a><a href="#windows-linux-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows/Linux:</h4>
<p>The applications that requires to capture biometric data from a MOSIP devices could do so by sending the http request to the supported port range.</p>
<p><strong><em>HTTP Request:</em></strong></p>
<p>CAPTURE <a href="http://127.0.0.1">http://127.0.0.1</a>:<device service port>/capture</p>
<p>HOST: 127.0.0.1: <apps port></p>
<p>EXT: <app name></p>
<p><strong><em>HTTP Response:</em></strong></p>
<pre><code class="hljs">HTTP/1.1 <span class="hljs-number">200</span> ok

<span class="sql"><span class="hljs-keyword">CACHE</span>-CONTROL:<span class="hljs-keyword">no</span>-<span class="hljs-keyword">store</span>

LOCATION:[<span class="hljs-keyword">http</span>://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>](<span class="hljs-keyword">http</span>://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>):&lt;device service port&gt;

<span class="hljs-keyword">Content</span>-<span class="hljs-keyword">Length</span>: <span class="hljs-keyword">length</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">bytes</span> <span class="hljs-keyword">of</span> the <span class="hljs-keyword">body</span>

<span class="hljs-keyword">Content</span>-<span class="hljs-keyword">Type</span>: application/<span class="hljs-keyword">json</span>

<span class="hljs-keyword">Connection</span>: Closed
</span></code></pre>
<p>Note: the pay loads are json in both the cases and are part of the body.</p>
<h4><a class="anchor" aria-hidden="true" id="android-2"></a><a href="#android-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Android:</h4>
<p>All device on an android device should listen to the following intent appid.capture</p>
<p>Upon this intend the devices are expected to respond back with the json response filtered by the respective type.</p>
<h4><a class="anchor" aria-hidden="true" id="ios-2"></a><a href="#ios-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IOS:</h4>
<p>All device on an IOS device would respond to the url schema as follows.</p>
<p>APPIDCAPTURE://&lt;call-back-app-url&gt;?ext=<caller app name>&amp;type=<type as defined in mosip device request></p>
<p>If a MOSIP compliant device service app exist then the url would launch the service. The service in return should respond back to the called using the call-back-app-url with the base64 encoded json as the url parameter for the key data.</p>
<h3><a class="anchor" aria-hidden="true" id="54-device-stream"></a><a href="#54-device-stream" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.4 Device Stream</h3>
<p>The device would open a stream channel to send the live video streams. This would help when there is an assisted operation to collect biometric.  Please note the stream API’s are available only for registration environment.</p>
<p><strong>Device Stream Request:</strong></p>
<p>Used only for the registration module compatible devices. This api is visible only for the devices that are registered for the purpose as &quot;Registration&quot;.</p>
<p><strong>Request:</strong></p>
<pre><code class="hljs">{
    “deviceId”: <span class="hljs-string">"internal Id"</span>,
    “deviceSubId”: <span class="hljs-string">"device sub Id’s"</span>,
}
</code></pre>
<p>**Accepted Values **</p>
<pre><code class="hljs"><span class="hljs-symbol">deviceId</span> - Internal Id
<span class="hljs-symbol">deviceSubId</span> - The <span class="hljs-keyword">sub </span>id of the device thats responsoible to <span class="hljs-keyword">stream </span>the <span class="hljs-meta">data</span>.
</code></pre>
<p><strong>Response:</strong></p>
<p>Live Video stream with quality of 3 frames per second or more using M-JPEG2000 <a href="https://en.wikipedia.org/wiki/Motion_JPEG">https://en.wikipedia.org/wiki/Motion_JPEG</a></p>
<p><strong><em>Note:</em></strong> Preview should have the quality markings and segement marking. The preview would also be used to display any error message to the user screen. All error messages should be localizable.</p>
<p><strong>Accepted values:</strong></p>
<h4><a class="anchor" aria-hidden="true" id="windows-linux-3"></a><a href="#windows-linux-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows/Linux:</h4>
<p>The applications that require more details of the MOSIP devices could get them by sending the http request to the supported port range.</p>
<p><strong><em>HTTP Request:</em></strong></p>
<p>STREAM   <a href="http://127.0.0.1:4501/stream">http://127.0.0.1:4501/stream</a></p>
<p>HOST: 127.0.0.1: <apps port></p>
<p>EXT: <app name></p>
<p><strong><em>HTTP Response:</em></strong></p>
<p>HTTP Chunk of frames to be displayed. Minimum frames 3 per second</p>
<h4><a class="anchor" aria-hidden="true" id="android-3"></a><a href="#android-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Android:</h4>
<p>No support for streaming</p>
<h4><a class="anchor" aria-hidden="true" id="ios-3"></a><a href="#ios-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IOS:</h4>
<p>No support for streaming</p>
<h3><a class="anchor" aria-hidden="true" id="55-device-registration-capture"></a><a href="#55-device-registration-capture" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.5 Device Registration Capture:</h3>
<p>The registration client application will send sample API. The sample API’s response will provide the actual biometric data in a digitally signed non encrypted form.   When the Device Registration Capture API is called the frames should not be added to the stream. The device is expected to send the images as well as its extraction values. For e.g. the segmented JPEG image is in the bioValue and the segmented and extracted will fit into the bioExtract.</p>
<p>The requestedScore is in the scale of 1-100.  In case the requestedScore is for all the count as average. So, in cases where you have four fingers the average of all will be considered for capture threshold.</p>
<p>Device Registration Capture Request:</p>
<p>The API is used by the devices that are compatible for the registration module.</p>
<p><strong>Request:</strong></p>
<pre><code class="hljs">{

“env”:  <span class="hljs-string">"target environment"</span>,

<span class="hljs-string">"specVersion"</span>: <span class="hljs-string">"expected MDS spec version"</span>,

<span class="hljs-string">"timeout"</span>: <span class="hljs-string">"timeout for registration capture"</span>,

“captureTime”: <span class="hljs-string">"time of capture request in ISO format including timezone"</span>,

“registrationId”: <span class="hljs-string">"registration Id for the current capture"</span>,

“bio”: [

    {

            “<span class="hljs-built_in">type</span>”: <span class="hljs-string">"type of the biometric data"</span>,

            “<span class="hljs-built_in">count</span>”:  <span class="hljs-string">"fingerprint/Iris count, in case of face max is set to 1"</span>,

            “exception”: [<span class="hljs-string">"finger or iris to be excluded"</span>],


            “requestedScore”: <span class="hljs-string">"expected quality score that should match to complete a successful capture."</span>,

            “deviceId”: <span class="hljs-string">"internal Id"</span>,

            “deviceSubId”: <span class="hljs-string">"specific device Id"</span>,

            “previousHash”: <span class="hljs-string">"hash of the previous block"</span>

    }

],

customOpt<span class="hljs-variable">s:</span>

{

    //<span class="hljs-built_in">max</span> of <span class="hljs-number">50</span> key value pair. This <span class="hljs-keyword">is</span> <span class="hljs-keyword">so</span> that vendor specific parameters can <span class="hljs-keyword">be</span> sent <span class="hljs-keyword">if</span> necessary. The <span class="hljs-built_in">values</span> cannot <span class="hljs-keyword">be</span> hardcoded <span class="hljs-built_in">and</span> have <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> configured by the apps server <span class="hljs-built_in">and</span> should <span class="hljs-keyword">be</span> modifiable upon need by the applications. Vendors are free <span class="hljs-keyword">to</span> include additional parameters <span class="hljs-built_in">and</span> fine-tuning parameters. None of these <span class="hljs-built_in">values</span> should <span class="hljs-keyword">go</span> undocumented by the vendor. No sensitive data should <span class="hljs-keyword">be</span> available in the customOpts.

 }

}
</code></pre>
<p><strong>Accepted Values</strong></p>
<pre><code class="hljs">env - Allowed values are Staging| Developer| Pre-Production | Production

<span class="hljs-built_in">version</span> - <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> biometric block <span class="hljs-keyword">as</span> specified <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> registration specification.

<span class="hljs-keyword">timeout</span> - Max <span class="hljs-built_in">time</span> <span class="hljs-keyword">the</span> app will wait <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> capture.

captureTime - <span class="hljs-built_in">time</span> <span class="hljs-keyword">of</span> capture <span class="hljs-keyword">in</span> ISO format <span class="hljs-keyword">with</span> timezone.

bio.type - “FMR”,  “FIR” , “IIR”, “Face”

bio.<span class="hljs-built_in">count</span> - <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> biometric data <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span> collected <span class="hljs-keyword">for</span> a <span class="hljs-keyword">given</span> type. The device should validate <span class="hljs-keyword">and</span> ensure this <span class="hljs-built_in">number</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">in</span> line <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> type <span class="hljs-keyword">of</span> biometric <span class="hljs-keyword">that</span>'s captured.

bio.exception: “LF_INDEX”, “LF_MIDDLE”, “LF_RING”, “LF_LITTLE”,  “LF_THUMB” “RF_INDEX”, “RF_MIDDLE”, “RF_RING”, “RF_LITTLE”,  “RF_THUMB”, “L_IRIS”, “R_IRIS”. This <span class="hljs-keyword">is</span> an array <span class="hljs-keyword">and</span> all <span class="hljs-keyword">the</span> exceptions are marked. In case <span class="hljs-keyword">of</span> an empty element assume there <span class="hljs-keyword">is</span> no exception.

bio.requestedScore - what <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> expected quality? Upon reaching <span class="hljs-keyword">the</span> necessary quality <span class="hljs-keyword">the</span> biometric device <span class="hljs-keyword">is</span> expected <span class="hljs-keyword">to</span> auto capture <span class="hljs-keyword">the</span> image.

bio.deviceId - a unique Id per device service. In case a single device handles both face <span class="hljs-keyword">and</span> iris <span class="hljs-keyword">the</span> device Id will identify iris <span class="hljs-keyword">and</span> camera uniquely. In case <span class="hljs-keyword">the</span> Id <span class="hljs-keyword">is</span> sent <span class="hljs-keyword">as</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">the</span> device <span class="hljs-keyword">is</span> expected <span class="hljs-keyword">to</span> capture biometric <span class="hljs-keyword">from</span> both <span class="hljs-keyword">the</span> devices.

bio.deviceSubId  - a specific device sub Id.  Should be <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span> <span class="hljs-number">0</span> <span class="hljs-keyword">if</span> we don't know any specific device sub Id. In case <span class="hljs-keyword">of</span> Fingerprint/IRIS <span class="hljs-keyword">its</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> left <span class="hljs-keyword">and</span> <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> right fingerprint/iris. <span class="hljs-number">3</span> <span class="hljs-keyword">for</span> thumb/two iris.

bio.previousHash - The previous hash <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> image captured <span class="hljs-keyword">by</span> this device per registration. For <span class="hljs-keyword">the</span> <span class="hljs-keyword">first</span> capture (per registration) use <span class="hljs-keyword">the</span> hash <span class="hljs-keyword">of</span> empty <span class="hljs-built_in">string</span>.
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="hljs">{<span class="hljs-attr">"biometrics"</span>: [

        {
          <span class="hljs-attr">"specVersion"</span> : <span class="hljs-string">"MDS Spec version"</span>,
          
          <span class="hljs-attr">"data"</span>: { 

            <span class="hljs-attr">"digitalId"</span>: <span class="hljs-string">"Unsigned digital id of the device as per the Digital Id definition.."</span>,

            <span class="hljs-attr">"deviceCode"</span>: <span class="hljs-string">"A unique code given by MOSIP after successfull registration"</span>,

            <span class="hljs-attr">"deviceServiceVersion"</span>: <span class="hljs-string">""</span>,

            <span class="hljs-attr">"bioSubType"</span>: <span class="hljs-string">"Middle Finger"</span>,

            <span class="hljs-attr">"purpose"</span>: <span class="hljs-string">"Auth  or Registration"</span>,
            <span class="hljs-attr">"env"</span>:  <span class="hljs-string">"target environment"</span>,

            <span class="hljs-attr">"bioValue"</span>: <span class="hljs-string">"&lt;base64urlencoded biometric data (raw image)&gt;"</span>,

            <span class="hljs-attr">"bioExtract"</span>: <span class="hljs-string">"&lt;base64urlencoded extracted biometric (ISO format)"</span>,

            <span class="hljs-attr">"registrationId"</span>: <span class="hljs-string">"1234567890"</span>,

            <span class="hljs-attr">"timestamp"</span>: <span class="hljs-string">"2019-02-15T10:01:57.086+05:30"</span>,

            <span class="hljs-attr">"requestedScore"</span>: <span class="hljs-string">"&lt;floating point number to represent the minimum required score for the capture. This ranges from 0-100&gt;"</span>,

            <span class="hljs-attr">"qualityScore"</span>: <span class="hljs-string">"&lt;floating point number representing the score for the current capture. This ranges from 0-100&gt;"</span>

          },

          <span class="hljs-attr">"hash"</span>: <span class="hljs-string">"sha256(sha256 hash in hex format of the previous data block + sha256 hash in hex format of the current data block)"</span>,         

         <span class="hljs-attr">"error"</span>: {

        <span class="hljs-attr">"errorcode"</span>: <span class="hljs-string">"101"</span>,

        <span class="hljs-attr">"errorinfo"</span>: <span class="hljs-string">"Invalid JSON Value Type For Discovery.. ex: {type: “Biometric Device” or “Fingerprint” or “Face” or “Iris” or “Vein”} "</span>

    }

        },

        {
          <span class="hljs-attr">"specVersion"</span> : <span class="hljs-string">"MDS Spec version"</span>,
          <span class="hljs-attr">"data"</span>: {

            <span class="hljs-attr">"deviceCode"</span>: <span class="hljs-string">""</span>,

            <span class="hljs-attr">"digitalId"</span>: <span class="hljs-string">"Unsigned digital id of the device as per the Digital Id definition."</span>, 

            <span class="hljs-attr">"deviceServiceVersion"</span>: <span class="hljs-string">""</span>,

            <span class="hljs-attr">"bioSubType"</span>: <span class="hljs-string">"LEFT"</span>,

            <span class="hljs-attr">"purpose"</span>: <span class="hljs-string">"Auth  or Registration"</span>,
            <span class="hljs-attr">"env"</span>:  <span class="hljs-string">"&lt;target environment&gt;"</span>,             

            <span class="hljs-attr">"bioValue"</span>: <span class="hljs-string">"&lt;base64urlencoded biometric data (raw image)&gt;"</span>,

            <span class="hljs-attr">"bioExtract"</span>: <span class="hljs-string">"&lt;base64urlencoded extracted biometric (ISO format)"</span>,

            <span class="hljs-attr">"registrationId"</span>: <span class="hljs-string">"1234567890"</span>,

            <span class="hljs-attr">"timestamp"</span>: <span class="hljs-string">"2019-02-15T10:01:57.086+05:30"</span>

          },

          <span class="hljs-attr">"hash"</span>: <span class="hljs-string">"sha256(sha256 hash in hex format of the previous data block + sha256 hash in hex format of the current data block before encryption)"</span>,

    <span class="hljs-attr">"error"</span>: {

            <span class="hljs-attr">"errorcode"</span>: <span class="hljs-string">"101"</span>,

            <span class="hljs-attr">"errorinfo"</span>: <span class="hljs-string">"Invalid JSON Value Type For Discovery.. ex: {type: “Biometric Device” or “Fingerprint” or “Face” or “Iris” or “Vein”} "</span>

        }

        }

      ]
}
</code></pre>
<p><strong>Accepted values:</strong>
data - base64urlencode(header).base64urlencode(payload).base64urlencode(signature)</p>
<h4><a class="anchor" aria-hidden="true" id="windows-linux-4"></a><a href="#windows-linux-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows/Linux:</h4>
<p>The applications that require more details of the MOSIP devices could get them by sending the http request to the supported port range.</p>
<p><strong><em>HTTP Request:</em></strong></p>
<p>RCAPTURE  <a href="http://127.0.0.1:4501/capture">http://127.0.0.1:4501/capture</a></p>
<p>HOST: 127.0.0.1: <apps port></p>
<p>EXT: <app name></p>
<p><strong><em>HTTP Response:</em></strong></p>
<p>HTTP response.</p>
<h4><a class="anchor" aria-hidden="true" id="android-4"></a><a href="#android-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Android:</h4>
<p>No support for Registration Capture</p>
<h4><a class="anchor" aria-hidden="true" id="ios-4"></a><a href="#ios-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IOS:</h4>
<p>No support for Registration Capture</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="6-device-server"></a><a href="#6-device-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. Device Server</h2>
<p>The device server exposes two external device APIs to manage devices. These will be consumed from Management Server created by the device provider. Refer to the subsequent section in this document.</p>
<h3><a class="anchor" aria-hidden="true" id="61-registration"></a><a href="#61-registration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.1 Registration:</h3>
<p>The MOSIP server would provide the following device registration API which is whitelisted to the management servers of the device provider or their partners.
Note: This API is exposed by the MOSIP server to the device providers.
<a href="http://device.mosip.io">http://device.mosip.io</a> /device/register
HTTP Request
Type: POST</p>
<pre><code class="hljs">{

“deviceData”: { 

“deviceId”: <span class="hljs-comment">"unique Id to identify a biometric capture device"</span>,

<span class="hljs-comment">"purpose"</span>: <span class="hljs-comment">"Auth  or Registration. Can not be empty"</span>,

“deviceInfo”: {
    “deviceSubId”: <span class="hljs-comment">"an array of sub Ids that are available"</span>,
    
    “certification”:  <span class="hljs-comment">"certification level"</span>,

    <span class="hljs-comment">"digitalId"</span>: <span class="hljs-comment">"signed digital id of the device"</span>,

    “firmware”: <span class="hljs-comment">"firmware version"</span>,

    “deviceExpiry”: <span class="hljs-comment">"device expiry date"</span>,

    “timestamp”:  <span class="hljs-comment">"ISO format datetime with timezone"</span>
    },
“foundationalTrustProviderId” : <span class="hljs-comment">"foundation trust provider Id, in case of L0 this is empty"</span>

}

}
</code></pre>
<p>Accepted Values:
device data is sent in the following format.</p>
<p>&quot;deviceData&quot; : base64urlencode(header).base64urlencode(payload).base64urlencode(signature)</p>
<p>payload is the object in deviceData.</p>
<p>Response:</p>
<pre><code class="hljs">{

<span class="hljs-string">"response"</span>: {

    “status”:  <span class="hljs-string">"registration status"</span>,

    “error”: {

     <span class="hljs-string">"code"</span>: <span class="hljs-string">"error code if registration fails"</span>,

     <span class="hljs-string">"message"</span>: <span class="hljs-string">"description of the error code"</span>,

    }

    <span class="hljs-string">"deviceCode"</span>: <span class="hljs-string">"UUID RFC4122 Version 4 for the device issued by the mosip server"</span>,

    <span class="hljs-string">"timestamp"</span>: <span class="hljs-string">"timestamp in ISO format"</span>,

    <span class="hljs-string">"env"</span>: <span class="hljs-string">"prod/development/stage"</span>

    }

}

</code></pre>
<p>The response is of the following format</p>
<p>&quot;response&quot; : base64urlencode(header).base64urlencode(payload).base64urlencode(signature)</p>
<p>The response should be sent to the device. The device is expected to store the deviceCode within its storage in a safe manner. This device code is used during the capture stage.</p>
<p><b>Note</b>: The device once registered for a specific purpose can not be changed after successfull registration. The device can only be used for that specific mosip process.</p>
<h3><a class="anchor" aria-hidden="true" id="62-de-register"></a><a href="#62-de-register" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6.2 De-Register:</h3>
<p><a href="http://device.mosip.io">http://device.mosip.io</a> /device/deregister
Request:</p>
<pre><code class="hljs">{
 <span class="hljs-attribute">device</span>: {
“deviceCode”: &lt;device code&gt;,
“env”: &lt;environment&gt;
 “timestamp”: &lt;iso format time of successful registration of the device&gt;
}
 “<span class="hljs-selector-tag">signature</span>”: “<span class="hljs-selector-tag">signature</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">device</span> <span class="hljs-selector-tag">element</span> <span class="hljs-selector-tag">using</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">device</span> <span class="hljs-selector-tag">provider</span> <span class="hljs-selector-tag">certificate</span>”
}
</code></pre>
<hr>
<h2><a class="anchor" aria-hidden="true" id="7-management-server"></a><a href="#7-management-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. Management Server</h2>
<p>The management server has the following objectives.</p>
<ol>
<li>Validate the devices to ensure its a genuine device from the respective device provider. This can be achieved using the device info and the certificates for the Foundational Trust Module.</li>
<li>Register the genuine device with the MOSIP device server.</li>
<li>Manage/Sync time between the end device the server. The time to be synced should be the only trusted time accepted by the device.</li>
<li>Ability to issue commands to the end device for
<ol>
<li>Key rotation of the end device</li>
<li>De-registration of the device</li>
<li>Collect device info</li>
</ol></li>
<li>A central repository of all the approved devices from the device provider.</li>
<li>Safe storage of keys using HSM FIPS 140-2 Level 3. These keys are used to issue the device certificate upon registration.
The Management Server is created and hosted by the device provider outside of MOSIP software. The communication protocols between the MDS and the Management Server can be decided by the respective device provider. Such communication should be restricted to the above specified interactions only. No transactional information should be sent to this server.</li>
</ol>
<hr>
<h2><a class="anchor" aria-hidden="true" id="8-compliance"></a><a href="#8-compliance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. Compliance</h2>
<p>L1 Certified Device / L1 Device - A device certified as capable of performing encryption on the device inside its trusted zone.
L0 Certified Device / L0 Device - A device certified as one where the encryption is done on the host inside its device driver or the MOSIP device service.</p>
<table>
  <tr>
   <td>API
   </td>
   <td>Compatible
   </td>
  </tr>
  <tr>
   <td>Device Discovery
   </td>
   <td>L0/L1
   </td>
  </tr>
  <tr>
   <td>Device Info
   </td>
   <td>L0/L1
   </td>
  </tr>
  <tr>
   <td>Capture
   </td>
   <td>L1
   </td>
  </tr>
  <tr>
   <td>Registration Capture
   </td>
   <td>L0/L1
   </td>
  </tr>
</table>
<hr>
<h2><a class="anchor" aria-hidden="true" id="9-error-codes"></a><a href="#9-error-codes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. Error Codes</h2>
<table>
<tr> <td>0</td> <td> Success </td> </tr>
<tr> <td>100</td> <td> Device not registered </td> </tr>
<tr> <td>101</td> <td> Unable to detect a biometric object </td> </tr>
<tr> <td>102</td> <td> Technical error during extraction. </td> </tr>
<tr> <td>103</td> <td> Device tamper detected </td> </tr>
<tr><td>104</td> <td> Unable to connect to management server </td> </tr>
<tr><td>105</td> <td> Image orientation error </td> </tr>
<tr><td>106</td> <td> Device not found </td> </tr>
<tr><td>107</td> <td> Device public key expired </td> </tr>
<tr><td>108</td> <td> Domain public key missing </td> </tr>
<tr> <td>5xx</td> <td> Custom errors. The device provider is free to choose his error code and error messages. </td> </tr>
</table></span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#1-introduction-amp-background">1. Introduction &amp; Background</a><ul class="toc-headings"><li><a href="#objective">Objective</a></li><li><a href="#target-audience">Target Audience</a></li><li><a href="#mosip-devices">MOSIP Devices</a></li></ul></li><li><a href="#2-glossary-of-terms">2. Glossary of Terms</a></li><li><a href="#3-device-specification">3. Device Specification</a></li><li><a href="#4-device-trust">4. Device Trust</a><ul class="toc-headings"><li><a href="#foundational-trust-module-ftm">Foundational Trust Module (FTM):</a></li></ul></li><li><a href="#5-device-service-communication-interfaces">5. Device Service - Communication Interfaces</a><ul class="toc-headings"><li><a href="#51-device-discovery">5.1 Device Discovery:</a></li><li><a href="#52-device-info">5.2 Device Info:</a></li><li><a href="#53-capture">5.3 Capture:</a></li><li><a href="#54-device-stream">5.4 Device Stream</a></li><li><a href="#55-device-registration-capture">5.5 Device Registration Capture:</a></li></ul></li><li><a href="#6-device-server">6. Device Server</a><ul class="toc-headings"><li><a href="#61-registration">6.1 Registration:</a></li><li><a href="#62-de-register">6.2 De-Register:</a></li></ul></li><li><a href="#7-management-server">7. Management Server</a></li><li><a href="#8-compliance">8. Compliance</a></li><li><a href="#9-error-codes">9. Error Codes</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/mosip-temp-documentation" class="nav-home"><img src="/mosip-temp-documentationimg/favicon.ico" alt="MOSIP Documentation" width="66" height="58"/></a><div><h5>Docs</h5><a href="/mosip-temp-documentationdocs/en/doc1.html">Getting Started (or other categories)</a><a href="/mosip-temp-documentationdocs/en/doc2.html">Guides (or other categories)</a><a href="/mosip-temp-documentationdocs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/mosip-temp-documentationen/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/mosip-temp-documentationblog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/mosip-temp-documentationimg/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2019 Your Name or Your Company Name</section></footer></div></body></html>