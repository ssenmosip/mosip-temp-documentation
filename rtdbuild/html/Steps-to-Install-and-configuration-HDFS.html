

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="java" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="java" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Setup HDFS version 2.8.1 &mdash; MOSIP 0.9 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html" class="icon icon-home"> MOSIP
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">1. Setup HDFS version 2.8.1</a><ul>
<li><a class="reference internal" href="#before-you-begin">Before you begin</a><ul>
<li><a class="reference internal" href="#edit-bashrc-sh">Edit ~/bashrc.sh:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-hadoop-user">Creating Hadoop User</a></li>
<li><a class="reference internal" href="#distribute-authentication-key-pairs-for-the-hadoop-user">Distribute Authentication Key-pairs for the Hadoop User</a></li>
<li><a class="reference internal" href="#verify-ssh-from-master-node-to-slave-node-and-vice-versa">Verify ssh from Master node to slave node and vice versa.</a></li>
<li><a class="reference internal" href="#download-and-unpack-hadoop-binaries">Download and Unpack Hadoop Binaries</a></li>
<li><a class="reference internal" href="#set-environment-variables-in-each-machine-in-the-cluster">Set Environment Variables in each machine in the cluster</a></li>
<li><a class="reference internal" href="#configure-the-master-node">Configure the Master Node</a><ul>
<li><a class="reference internal" href="#set-namenode">Set NameNode</a></li>
<li><a class="reference internal" href="#set-path-for-hdfs">Set path for HDFS</a></li>
<li><a class="reference internal" href="#configure-master">Configure Master</a></li>
<li><a class="reference internal" href="#configure-slaves">Configure Slaves</a></li>
</ul>
</li>
<li><a class="reference internal" href="#duplicate-config-files-on-each-node">Duplicate Config Files on Each Node</a></li>
<li><a class="reference internal" href="#format-hdfs">Format HDFS</a></li>
<li><a class="reference internal" href="#start-hdfs">Start HDFS</a></li>
<li><a class="reference internal" href="#create-hdfs-users">Create hdfs users</a><ul>
<li><a class="reference internal" href="#enabling-configured-port-through-firewall-in-each-machine-in-cluster">enabling configured port through firewall in each machine in cluster</a><ul>
<li><a class="reference internal" href="#note">NOTE:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#securing-hdfs">2. Securing HDFS</a><ul>
<li><a class="reference internal" href="#install-kerberos">Install Kerberos</a></li>
<li><a class="reference internal" href="#before-installing-kerberos-install-the-jce-policy-file">Before Installing Kerberos Install the JCE Policy File</a></li>
<li><a class="reference internal" href="#kerberos">Kerberos</a></li>
<li><a class="reference internal" href="#configuring-the-master-kdc-server">Configuring the Master KDC Server</a></li>
<li><a class="reference internal" href="#create-and-deploy-the-kerberos-principals-and-keytab-files">Create and Deploy the Kerberos Principals and Keytab Files</a><ul>
<li><a class="reference internal" href="#to-create-the-kerberos-principals">To create the Kerberos principals</a></li>
<li><a class="reference internal" href="#to-create-the-kerberos-keytab-files">To create the Kerberos keytab files</a><ul>
<li><a class="reference internal" href="#creating-keytab-mosip-keytab-file-for-application-to-authenticate-with-hdfs-cluster">Creating keytab [mosip.keytab] file for application to authenticate  with hdfs cluster</a></li>
<li><a class="reference internal" href="#to-view-the-principals-in-keytab">to view the principals in keytab</a></li>
</ul>
</li>
<li><a class="reference internal" href="#to-deploy-the-kerberos-keytab-file">To deploy the Kerberos keytab file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#to-configure-kernel-hdfs-adapter">To configure Kernel HDFS Adapter</a></li>
<li><a class="reference internal" href="#enable-security-in-hdfs">Enable security in hdfs</a></li>
<li><a class="reference internal" href="#enable-hadoop-security">Enable Hadoop Security</a></li>
<li><a class="reference internal" href="#configuring-https-in-hdfs">Configuring https in hdfs</a><ul>
<li><a class="reference internal" href="#generating-the-key-and-certificate">Generating the key and certificate</a></li>
<li><a class="reference internal" href="#creating-your-own-ca">Creating your own CA</a></li>
<li><a class="reference internal" href="#signing-the-certificate">Signing the certificate:</a></li>
<li><a class="reference internal" href="#configuring-hdfs">Configuring Hdfs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MOSIP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>1. Setup HDFS version 2.8.1</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Steps-to-Install-and-configuration-HDFS.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setup-hdfs-version-2-8-1">
<h1>1. Setup HDFS version 2.8.1<a class="headerlink" href="#setup-hdfs-version-2-8-1" title="Permalink to this headline">¶</a></h1>
<p><strong>documentation for setting up hdfs cluster with one namenode and one datanode</strong></p>
<div class="section" id="before-you-begin">
<h2>Before you begin<a class="headerlink" href="#before-you-begin" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Create 2 VMs. They’ll be referred to throughout this guide as</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">node</span><span class="o">-</span><span class="n">slave1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Install java (java-8-openjdk) to all the machines in the cluster and setup the JAVA_HOME environment variable for the same.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">yum</span> <span class="n">install</span> <span class="n">java</span><span class="o">-</span><span class="mf">1.8</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">openjdk</span><span class="o">-</span><span class="n">devel</span>
</pre></div>
</div>
<p>Get your Java installation path.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">update</span><span class="o">-</span><span class="n">alternatives</span> <span class="o">--</span><span class="n">display</span> <span class="n">java</span>
</pre></div>
</div>
<p><strong>NOTE :</strong> Take the value of the current link and remove the trailing /bin/java. <br/>
For example on RHEL 7, the link is /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64/jre/bin/java, <br/>
so JAVA_HOME should be /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64/jre.</p>
<div class="section" id="edit-bashrc-sh">
<h3>Edit ~/bashrc.sh:<a class="headerlink" href="#edit-bashrc-sh" title="Permalink to this headline">¶</a></h3>
<p>export JAVA_HOME={path-tojava} <br/>
with your actual java installation path. For example on a Debian with open-jdk-8:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">JAVA_HOME</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jvm</span><span class="o">/</span><span class="n">java</span><span class="o">-</span><span class="mf">1.8</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">openjdk</span><span class="o">-</span><span class="mf">1.8</span><span class="o">.</span><span class="mf">0.191</span><span class="o">.</span><span class="n">b12</span><span class="o">-</span><span class="mf">1.</span><span class="n">el7_6</span><span class="o">.</span><span class="n">x86_64</span><span class="o">/</span><span class="n">jre</span>
</pre></div>
</div>
<p>Note: in the further steps when u login to the hadoop account set the java path in ~/hadoop/etc/hadoop/hadoop-env.sh also.</p>
<ol class="simple">
<li><p>Get the IP of master and slave nodes using:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ifconfig</span>
</pre></div>
</div>
<p>Adjust /etc/hosts on all nodes according to your configuration:<br/>
NOTE: while adding same machine ip to /etc/hosts , use private ip that machine instead of public ip. for other machine in the cluster use public ip.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>NOTE : Editing the Master node VM /etc/hosts file  use private IP of Master node and public IP of the Slave node
         Editing the Slave node  VM /etc/hosts file use private IP of Slave node and Public IP of Master node 
</pre></div>
</div>
<p>example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">10.0</span><span class="o">.</span><span class="mf">22.11</span> <span class="n">node</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="mf">10.0</span><span class="o">.</span><span class="mf">3.12</span> <span class="n">node</span><span class="o">-</span><span class="n">slave1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-hadoop-user">
<h2>Creating Hadoop User<a class="headerlink" href="#creating-hadoop-user" title="Permalink to this headline">¶</a></h2>
<p><strong>create a hadoop user</strong> in every machine in the cluster to followup the documentation <br/>
or <strong>replace the hadoop user</strong> in the documentation with your own user.</p>
<p>Log in to the system as the root user.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">su</span> <span class="o">-</span>
</pre></div>
</div>
<p>Create a hadoop user account using the <strong>useradd</strong> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">adduser</span> <span class="n">hadoop</span>
</pre></div>
</div>
<p>Set a password for the new hadoop user using the <strong>passwd</strong> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">passwd</span> <span class="n">hadoop</span>
<span class="n">Changing</span> <span class="n">password</span> <span class="k">for</span> <span class="n">user</span> <span class="n">hadoop</span><span class="o">.</span>
<span class="n">New</span> <span class="n">password</span><span class="p">:</span> 
<span class="n">Retype</span> <span class="n">new</span> <span class="n">password</span><span class="p">:</span> 
<span class="n">passwd</span><span class="p">:</span> <span class="nb">all</span> <span class="n">authentication</span> <span class="n">tokens</span> <span class="n">updated</span> <span class="n">successfully</span><span class="o">.</span>
</pre></div>
</div>
<p>Add the haddop user to the wheel group using the <strong>usermod</strong> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usermod</span> <span class="o">-</span><span class="n">aG</span> <span class="n">wheel</span> <span class="n">hadoop</span>
</pre></div>
</div>
<p>Test that the updated configuration allows the user you created to run commands using sudo.
Use the <strong>su</strong> to switch to the new user account that you created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">su</span> <span class="n">hadoop</span>
</pre></div>
</div>
<p>Use the groups to verify that the user is in the wheel group.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">groups</span>
</pre></div>
</div>
<p>Use the sudo command to run the <strong>whoami</strong> command. As this is the first time you have run a command using sudo from hadoop user account the banner message will be displayed. You will be also be prompted to enter the password for the hadoop account.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">whoami</span>
<span class="n">We</span> <span class="n">trust</span> <span class="n">you</span> <span class="n">have</span> <span class="n">received</span> <span class="n">the</span> <span class="n">usual</span> <span class="n">lecture</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">local</span> <span class="n">System</span>
<span class="n">Administrator</span><span class="o">.</span> <span class="n">It</span> <span class="n">usually</span> <span class="n">boils</span> <span class="n">down</span> <span class="n">to</span> <span class="n">these</span> <span class="n">three</span> <span class="n">things</span><span class="p">:</span>

    <span class="c1">#1) Respect the privacy of others.</span>
    <span class="c1">#2) Think before you type.</span>
    <span class="c1">#3) With great power comes great responsibility.</span>

<span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">hadoop</span><span class="p">:</span>
<span class="n">root</span>
</pre></div>
</div>
<p>The last line of the output is the user name returned by the <strong>whoami</strong> command. If sudo is configured correctly this value will be <strong>root</strong>.</p>
<p><strong>You have successfully configured a hadoop user with sudo access</strong>. You can now log in to this hadoop account and use sudo to run commands as if you were logged in to the account of the root user.</p>
</div>
<div class="section" id="distribute-authentication-key-pairs-for-the-hadoop-user">
<h2>Distribute Authentication Key-pairs for the Hadoop User<a class="headerlink" href="#distribute-authentication-key-pairs-for-the-hadoop-user" title="Permalink to this headline">¶</a></h2>
<p>The master node will use an ssh-connection to connect to other nodes with key-pair authentication, to manage the cluster.<br/></p>
<ol class="simple">
<li><p>Login to node-master as the hadoop user, and generate an ssh-key:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span>
</pre></div>
</div>
<p>id_rsa.pub will contains the generated public key</p>
<ol class="simple">
<li><p>Copy the public key to all the other nodes.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ssh-copy-id -i $HOME/.ssh/id_rsa.pub hadoop@node-master.example.com
ssh-copy-id -i $HOME/.ssh/id_rsa.pub hadoop@node-slave1.example.com
</pre></div>
</div>
<p>or</p>
<p>update the $HOME/.ssh/id_rsa.pub file contents of slave node to Master node $HOME/.ssh/authorized_keys file <br/> and also
update $HOME/.ssh/id_rsa.pub file contents of Master node to Slave node $HOME/.ssh/authorized_keys manually.<br/></p>
</div>
<div class="section" id="verify-ssh-from-master-node-to-slave-node-and-vice-versa">
<h2>Verify ssh from Master node to slave node and vice versa.<a class="headerlink" href="#verify-ssh-from-master-node-to-slave-node-and-vice-versa" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">hadoop</span><span class="nd">@node</span><span class="o">-</span><span class="n">slave1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>NOTE: if ssh fails, try setting up again the authorized_keys to the machine.</p>
</div>
<div class="section" id="download-and-unpack-hadoop-binaries">
<h2>Download and Unpack Hadoop Binaries<a class="headerlink" href="#download-and-unpack-hadoop-binaries" title="Permalink to this headline">¶</a></h2>
<p>Login to node-master as the hadoop user, download the Hadoop tarball from Hadoop project page, and unzip it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span>

<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">archive</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">dist</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">hadoop</span><span class="o">-</span><span class="mf">2.8</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">hadoop</span><span class="o">-</span><span class="mf">2.8</span><span class="o">.</span><span class="mf">1.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>

<span class="n">tar</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">hadoop</span><span class="o">-</span><span class="mf">2.8</span><span class="o">.</span><span class="mf">1.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>

<span class="n">mv</span> <span class="n">hadoop</span><span class="o">-</span><span class="mf">2.8</span><span class="o">.</span><span class="mi">1</span> <span class="n">hadoop</span>
</pre></div>
</div>
</div>
<div class="section" id="set-environment-variables-in-each-machine-in-the-cluster">
<h2>Set Environment Variables in each machine in the cluster<a class="headerlink" href="#set-environment-variables-in-each-machine-in-the-cluster" title="Permalink to this headline">¶</a></h2>
<p>Add Hadoop binaries to your PATH. Edit <code class="docutils literal notranslate"><span class="pre">/home/hadoop/.bashrc</span></code> or <code class="docutils literal notranslate"><span class="pre">/home/hadoop/.bash_profile</span></code> and add the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export HADOOP_HOME=$HOME/hadoop
export HADOOP_CONF_DIR=$HOME/hadoop/etc/hadoop
export HADOOP_MAPRED_HOME=$HOME/hadoop
export HADOOP_COMMON_HOME=$HOME/hadoop
export HADOOP_HDFS_HOME=$HOME/hadoop
export YARN_HOME=$HOME/hadoop
export PATH=$PATH:$HOME/hadoop/bin
export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64/jre
</pre></div>
</div>
<p>run following command to apply environment variable changes, using source command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/.</span><span class="n">bashrc</span>
<span class="ow">or</span>
<span class="n">source</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/.</span><span class="n">bash_profile</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-the-master-node">
<h2>Configure the Master Node<a class="headerlink" href="#configure-the-master-node" title="Permalink to this headline">¶</a></h2>
<p>Configuration will be done on node-master and replicated to other slave nodes.</p>
<div class="section" id="set-namenode">
<h3>Set NameNode<a class="headerlink" href="#set-namenode" title="Permalink to this headline">¶</a></h3>
<p>Update ~/hadoop/etc/hadoop/core-site.xml :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">configuration</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">fs</span><span class="o">.</span><span class="n">defaultFS</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">hdfs</span><span class="p">:</span><span class="o">//</span><span class="n">node</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">example</span><span class="p">:</span><span class="mi">51000</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
     <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">configuration</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="set-path-for-hdfs">
<h3>Set path for HDFS<a class="headerlink" href="#set-path-for-hdfs" title="Permalink to this headline">¶</a></h3>
<p>Edit ~/hadoop/etc/hadoop/hdfs-site.xml :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">configuration</span><span class="o">&gt;</span>
    	<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">dir</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">nameNode</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">datanode</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dir</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">dataNode</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">replication</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">permissions</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
		<span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
	<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">secondary</span><span class="o">.</span><span class="n">http</span><span class="o">-</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51090</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">secondary</span><span class="o">.</span><span class="n">https</span><span class="o">-</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51091</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">datanode</span><span class="o">.</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51010</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">datanode</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51075</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">datanode</span><span class="o">.</span><span class="n">ipc</span><span class="o">.</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51020</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">http</span><span class="o">-</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51070</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">https</span><span class="o">-</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51470</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">backup</span><span class="o">.</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51100</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">dfs</span><span class="o">.</span><span class="n">namenode</span><span class="o">.</span><span class="n">backup</span><span class="o">.</span><span class="n">http</span><span class="o">-</span><span class="n">address</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">51105</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">configuration</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>create directories</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">nameNode</span> <span class="p">[</span><span class="n">where</span> <span class="n">on</span> <span class="n">the</span> <span class="n">filesystem</span> <span class="n">the</span> <span class="n">DFS</span> <span class="n">name</span> <span class="n">node</span> <span class="n">should</span> <span class="n">store</span> <span class="n">the</span> <span class="n">name</span> <span class="n">table</span><span class="p">(</span><span class="n">fsimage</span><span class="p">)]</span>
<span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">dataNode</span>  <span class="p">[</span><span class="n">where</span> <span class="n">data</span> <span class="n">node</span> <span class="n">should</span> <span class="n">store</span> <span class="n">its</span> <span class="n">blocks</span><span class="o">.</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-master">
<h3>Configure Master<a class="headerlink" href="#configure-master" title="Permalink to this headline">¶</a></h3>
<p>Edit ~/hadoop/etc/hadoop/masters to be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">-</span><span class="n">master</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-slaves">
<h3>Configure Slaves<a class="headerlink" href="#configure-slaves" title="Permalink to this headline">¶</a></h3>
<p>Edit ~/hadoop/etc/hadoop/slaves to be:<br/>
this slaves file will specifies the datanode to be setup in which machine</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">-</span><span class="n">slave1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="duplicate-config-files-on-each-node">
<h2>Duplicate Config Files on Each Node<a class="headerlink" href="#duplicate-config-files-on-each-node" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Copy the hadoop binaries to slave nodes:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span>
<span class="n">scp</span> <span class="n">hadoop</span><span class="o">-*.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="n">node</span><span class="o">-</span><span class="n">slave1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span>
</pre></div>
</div>
<p>or copy each configured files to other nodes</p>
<ol class="simple">
<li><p>Connect to node1 via ssh. A password isn’t required, thanks to the ssh keys copied above:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="n">node</span><span class="o">-</span><span class="n">slave1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Unzip the binaries, rename the directory, and exit node-slave1.example.com to get back on the node-master.example.com:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">hadoop</span><span class="o">-</span><span class="mf">2.8</span><span class="o">.</span><span class="mf">1.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">mv</span> <span class="n">hadoop</span><span class="o">-</span><span class="mf">2.8</span><span class="o">.</span><span class="mi">1</span> <span class="n">hadoop</span>
<span class="n">exit</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Copy the Hadoop configuration files to the slave nodes:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for node in node-slave1.example.com; do
    scp ~/hadoop/etc/hadoop/* $node:/home/hadoop/hadoop/etc/hadoop/;
done
</pre></div>
</div>
</div>
<div class="section" id="format-hdfs">
<h2>Format HDFS<a class="headerlink" href="#format-hdfs" title="Permalink to this headline">¶</a></h2>
<p>HDFS needs to be formatted like any classical file system. On node-master, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hdfs</span> <span class="n">namenode</span> <span class="o">-</span><span class="nb">format</span>
</pre></div>
</div>
<p>Your Hadoop installation is now configured and ready to run.</p>
</div>
<div class="section" id="start-hdfs">
<h2>Start HDFS<a class="headerlink" href="#start-hdfs" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Start the HDFS by running the following script from node-master:
start-dfs.sh , stop-dfs.sh script files will be present in hadoop_Installation_Dir/sbin/start.dfs.sg</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hadoop</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">start</span><span class="o">-</span><span class="n">dfs</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>It’ll start NameNode and SecondaryNameNode on node-master.example.com, and DataNode on node-slave1.example.com, according to the configuration in the slaves config file.<br/>
2. Check that every process is running with the jps command on each node. You should get on node-master.example.com (PID will be different):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">21922</span> <span class="n">Jps</span>
<span class="mi">21603</span> <span class="n">NameNode</span>
<span class="mi">21787</span> <span class="n">SecondaryNameNode</span>
</pre></div>
</div>
<p>and on node-slave1.example.com:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">19728</span> <span class="n">DataNode</span>
<span class="mi">19819</span> <span class="n">Jps</span>
</pre></div>
</div>
<p>Hdfs has been Configured Successfully
<br/>
<br/>
<strong>NOTE :</strong> if datanode and namenode has not started.
look into hdfs logs to debug: $HOME/hadoop/logs/</p>
</div>
<div class="section" id="create-hdfs-users">
<h2>Create hdfs users<a class="headerlink" href="#create-hdfs-users" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>To create users for hdfs (regprocessor, prereg, idrepo), run this command:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">useradd</span>  <span class="n">regprocessor</span>
<span class="n">sudo</span> <span class="n">useradd</span>  <span class="n">prereg</span>
<span class="n">sudo</span> <span class="n">useradd</span>  <span class="n">idrepo</span>
</pre></div>
</div>
<p><strong>NOTE : Configure the user in module specific properties file (ex- pre-registration-qa.properties) as mosip.kernel.fsadapter.hdfs.user-name=prereg</strong></p>
<ol class="simple">
<li><p>Create a directory and give permission for each user</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hdfs</span> <span class="n">dfs</span> <span class="o">-</span><span class="n">mkdir</span> <span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">regprocessor</span>
<span class="n">hdfs</span> <span class="n">dfs</span> <span class="o">-</span><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">regprocessor</span><span class="p">:</span><span class="n">regprocessor</span>  <span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">regprocessor</span>
<span class="n">hdfs</span> <span class="n">dfs</span> <span class="o">-</span><span class="n">mkdir</span> <span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">prereg</span>
<span class="n">hdfs</span> <span class="n">dfs</span> <span class="o">-</span><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">prereg</span><span class="p">:</span><span class="n">prereg</span>  <span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">prereg</span>
<span class="n">hdfs</span> <span class="n">dfs</span> <span class="o">-</span><span class="n">mkdir</span> <span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">idrepo</span>
<span class="n">hdfs</span> <span class="n">dfs</span> <span class="o">-</span><span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">idrepo</span><span class="p">:</span><span class="n">idrepo</span>  <span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">idrepo</span>
</pre></div>
</div>
<div class="section" id="enabling-configured-port-through-firewall-in-each-machine-in-cluster">
<h3>enabling configured port through firewall in each machine in cluster<a class="headerlink" href="#enabling-configured-port-through-firewall-in-each-machine-in-cluster" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ssh notranslate"><div class="highlight"><pre><span></span>sudo firewall-cmd --zone=public --add-port=51000/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51090/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51010/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51075/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51020/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51070/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51470/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51100/tcp --permanent
sudo firewall-cmd --zone=public --add-port=51105/tcp --permanent
sudo firewall-cmd --reload
</pre></div>
</div>
<div class="section" id="note">
<h4>NOTE:<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h4>
<p>if different port has been configured , enable those port.</p>
</div>
</div>
</div>
</div>
<div class="section" id="securing-hdfs">
<h1>2. Securing HDFS<a class="headerlink" href="#securing-hdfs" title="Permalink to this headline">¶</a></h1>
<p>Following configuration is required to run HDFS in secure mode.
Read more about kerberos here:
<a class="reference external" href="//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/managing_smart_cards/using_Kerberos"><strong>link</strong></a></p>
<div class="section" id="install-kerberos">
<h2>Install Kerberos<a class="headerlink" href="#install-kerberos" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="before-installing-kerberos-install-the-jce-policy-file">
<h2>Before Installing Kerberos Install the JCE Policy File<a class="headerlink" href="#before-installing-kerberos-install-the-jce-policy-file" title="Permalink to this headline">¶</a></h2>
<p>Install Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy File on all cluster and Hadoop user machines.
Follow this <a class="reference external" href="//dzone.com/articles/install-java-cryptography-extension-jce-unlimited"><strong>link</strong></a></p>
</div>
<div class="section" id="kerberos">
<h2>Kerberos<a class="headerlink" href="#kerberos" title="Permalink to this headline">¶</a></h2>
<p>Kerberos server(KDC) and the client needs to be installed. Install the client on both master and slave nodes. KDC server will be installed on the master node.</p>
<ol class="simple">
<li><p>To install packages for a Kerberos server:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">krb5</span><span class="o">-</span><span class="n">server</span> <span class="n">krb5</span><span class="o">-</span><span class="n">libs</span> <span class="n">krb5</span><span class="o">-</span><span class="n">auth</span><span class="o">-</span><span class="n">dialog</span>
</pre></div>
</div>
<ol class="simple">
<li><p>To install packages for a Kerberos client:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">krb5</span><span class="o">-</span><span class="n">workstation</span> <span class="n">krb5</span><span class="o">-</span><span class="n">libs</span> <span class="n">krb5</span><span class="o">-</span><span class="n">auth</span><span class="o">-</span><span class="n">dialog</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-the-master-kdc-server">
<h2>Configuring the Master KDC Server<a class="headerlink" href="#configuring-the-master-kdc-server" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Edit the /etc/krb5.conf:</p></li>
</ol>
<pre>
# Configuration snippets may be placed in this directory as well
includedir /etc/krb5.conf.d/

[logging]
 default = FILE:/var/log/krb5libs.log
 kdc = FILE:/var/log/krb5kdc.log
 admin_server = FILE:/var/log/kadmind.log

[libdefaults]
 <b>udp_preference_limit = 1</b>
 dns_lookup_realm = false
 ticket_lifetime = 365d
 renew_lifetime = 365d
 forwardable = true
 rdns = false
 pkinit_anchors = /etc/pki/tls/certs/ca-bundle.crt
 default_realm =  <b>NODE-MASTER.EXAMPLE.COM</b>
 #default_ccache_name = KEYRING:persistent:%{uid}

[realms]
   <b>NODE-MASTER.EXAMPLE.COM</b> = {
   kdc = <b>node-master.example.com:51088</b>
   admin_server = <b>node-master.example.com</b>
 }

[domain_realm]
   <b>.node-master.example.com = NODE-MASTER.EXAMPLE.COM
   node-master.example.com = NODE-MASTER.EXAMPLE.COM</b>
</pre><p><strong>NOTE: Place this krb5.conf /kernel/kernel-fsadapter-hdfs/src/main/resources</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mosip</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">fsadapter</span><span class="o">.</span><span class="n">hdfs</span><span class="o">.</span><span class="n">krb</span><span class="o">-</span><span class="n">file</span><span class="o">=</span><span class="n">classpath</span><span class="p">:</span><span class="n">krb5</span><span class="o">.</span><span class="n">conf</span> 
</pre></div>
</div>
<p>OR If Kept outside resource then give absolute path</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mosip</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">fsadapter</span><span class="o">.</span><span class="n">hdfs</span><span class="o">.</span><span class="n">krb</span><span class="o">-</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">kdc</span><span class="o">/</span><span class="n">krb5</span><span class="o">.</span><span class="n">conf</span> 
</pre></div>
</div>
<ol class="simple">
<li><p>Edit /var/kerberos/krb5kdc/kdc.conf</p></li>
</ol>
<pre>
[kdcdefaults]
 kdc_ports = <b>51088</b>
 kdc_tcp_ports = <b>51088</b>

[realms]
 <b>NODE-MASTER.EXAMPLE.COM</b> = {
  #master_key_type = aes256-cts
  acl_file = /var/kerberos/krb5kdc/kadm5.acl
  dict_file = /usr/share/dict/words
  admin_keytab = /var/kerberos/krb5kdc/kadm5.keytab
  supported_enctypes = aes256-cts:normal aes128-cts:normal des3-hmac-sha1:normal arcfour-hmac:normal camellia256-cts:normal camellia128-cts:normal des-hmac-sha1:normal des-cbc-md5:normal des-cbc-crc:normal
 }
</pre><ol class="simple">
<li><p>Create the database using the kdb5_util utility.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">kdb5_util</span> <span class="n">create</span> <span class="o">-</span><span class="n">s</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Edit the /var/kerberos/krb5kdc/kadm5.acl</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*/</span><span class="n">admin</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>	<span class="o">*</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Create the first principal using kadmin.local at the KDC terminal:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">kadmin</span><span class="o">.</span><span class="n">local</span> <span class="o">-</span><span class="n">q</span> <span class="s2">&quot;addprinc root/admin&quot;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Start Kerberos using the following commands:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">service</span> <span class="n">krb5kdc</span> <span class="n">start</span>
<span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">service</span> <span class="n">kadmin</span> <span class="n">start</span>
</pre></div>
</div>
<p>to set up the KDC server to auto-start on boot.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RHEL</span><span class="o">/</span><span class="n">CentOS</span><span class="o">/</span><span class="n">Oracle</span> <span class="n">Linux</span> <span class="mi">6</span>

<span class="n">chkconfig</span> <span class="n">krb5kdc</span> <span class="n">on</span>

<span class="n">chkconfig</span> <span class="n">kadmin</span> <span class="n">on</span>

<span class="n">RHEL</span><span class="o">/</span><span class="n">CentOS</span><span class="o">/</span><span class="n">Oracle</span> <span class="n">Linux</span> <span class="mi">7</span>

<span class="n">systemctl</span> <span class="n">enable</span> <span class="n">krb5kdc</span>

<span class="n">systemctl</span> <span class="n">enable</span> <span class="n">kadmin</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Verify that the KDC is issuing tickets.
First, run kinit to obtain a ticket and store it in a credential cache file.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kinit</span> <span class="n">root</span><span class="o">/</span><span class="n">admin</span>
</pre></div>
</div>
<p>Next, use klist to view the list of credentials in the cache.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">klist</span>
</pre></div>
</div>
<p>Use kdestroy to destroy the cache and the credentials it contains.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kdestroy</span> <span class="o">-</span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="section" id="create-and-deploy-the-kerberos-principals-and-keytab-files">
<h2>Create and Deploy the Kerberos Principals and Keytab Files<a class="headerlink" href="#create-and-deploy-the-kerberos-principals-and-keytab-files" title="Permalink to this headline">¶</a></h2>
<p>For more information, check here:
<a class="reference external" href="//cloudera.com/documentation/enterprise/5-16-x/topics/cdh_sg_kerberos_prin_keytab_deploy.html"><strong>link</strong></a></p>
<p>If you have root access to the KDC machine, use kadmin.local, else use kadmin.
To start kadmin.local (on the KDC machine), run this command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">kadmin</span><span class="o">.</span><span class="n">local</span>
</pre></div>
</div>
<div class="section" id="to-create-the-kerberos-principals">
<h3>To create the Kerberos principals<a class="headerlink" href="#to-create-the-kerberos-principals" title="Permalink to this headline">¶</a></h3>
<p>Do the following steps for masternode.</p>
<ol class="simple">
<li><p>In the kadmin.local or kadmin shell, create the hadoop principal. This principal is used for the NameNode, Secondary NameNode, and DataNodes.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kadmin</span><span class="p">:</span>  <span class="n">addprinc</span> <span class="n">hadoop</span><span class="o">/</span><span class="n">admin</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Create the HTTP principal.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kadmin</span><span class="p">:</span>  <span class="n">addprinc</span> <span class="n">HTTP</span><span class="o">/</span><span class="n">admin</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Create principal for all user of hdfs (regprocessor, prereg, idrepo)</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kadmin</span><span class="p">:</span>  <span class="n">addprinc</span> <span class="n">regprocessor</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
<span class="n">kadmin</span><span class="p">:</span>  <span class="n">addprinc</span> <span class="n">prereg</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
<span class="n">kadmin</span><span class="p">:</span>  <span class="n">addprinc</span> <span class="n">idrepo</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
</pre></div>
</div>
</div>
<div class="section" id="to-create-the-kerberos-keytab-files">
<h3>To create the Kerberos keytab files<a class="headerlink" href="#to-create-the-kerberos-keytab-files" title="Permalink to this headline">¶</a></h3>
<p>Create the hdfs keytab file that will contain the hdfs principal and HTTP principal. This keytab file is used for the NameNode, Secondary NameNode, and DataNodes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kadmin</span><span class="p">:</span>  <span class="n">xst</span> <span class="o">-</span><span class="n">norandkey</span> <span class="o">-</span><span class="n">k</span> <span class="n">hadoop</span><span class="o">.</span><span class="n">keytab</span> <span class="n">hadoop</span><span class="o">/</span><span class="n">admin</span> <span class="n">HTTP</span><span class="o">/</span><span class="n">admin</span>
</pre></div>
</div>
<p>Use klist to display the keytab file entries; a correctly-created hdfs keytab file should look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ klist -k -e -t hadoop.keytab
Keytab name: FILE:hadoop.keytab
KVNO Timestamp           Principal
---- ------------------- ------------------------------------------------------
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (aes256-cts-hmac-sha1-96)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (aes128-cts-hmac-sha1-96)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (des3-cbc-sha1)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (arcfour-hmac)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (camellia256-cts-cmac)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (camellia128-cts-cmac)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (des-hmac-sha1)
   1 02/11/2019 08:53:51 hadoop/admin@NODE-MASTER.EXAMPLE.COM (des-cbc-md5)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (aes256-cts-hmac-sha1-96)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (aes128-cts-hmac-sha1-96)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (des3-cbc-sha1)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (arcfour-hmac)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (camellia256-cts-cmac)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (camellia128-cts-cmac)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (des-hmac-sha1)
   1 02/11/2019 08:53:51 HTTP/admin@NODE-MASTER.EXAMPLE.COM (des-cbc-md5)
</pre></div>
</div>
<div class="section" id="creating-keytab-mosip-keytab-file-for-application-to-authenticate-with-hdfs-cluster">
<h4>Creating keytab [mosip.keytab] file for application to authenticate  with hdfs cluster<a class="headerlink" href="#creating-keytab-mosip-keytab-file-for-application-to-authenticate-with-hdfs-cluster" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$sudo kadmin
   kadmin: xst -norandkey -k mosip.keytab {user1}
   kadmin: xst -norandkey -k mosip.keytab {user2} 
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">replace</span> <span class="p">{</span><span class="n">user</span><span class="p">}</span> <span class="k">with</span> <span class="n">username</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="to-view-the-principals-in-keytab">
<h4>to view the principals in keytab<a class="headerlink" href="#to-view-the-principals-in-keytab" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">klist</span> <span class="o">-</span><span class="n">k</span> <span class="o">-</span><span class="n">e</span> <span class="o">-</span><span class="n">t</span> <span class="n">mosip</span><span class="o">.</span><span class="n">keytab</span>
</pre></div>
</div>
<p>and so on add all the users to keytab. if you want create the separate keytab file for each application and distribute them</p>
</div>
</div>
<div class="section" id="to-deploy-the-kerberos-keytab-file">
<h3>To deploy the Kerberos keytab file<a class="headerlink" href="#to-deploy-the-kerberos-keytab-file" title="Permalink to this headline">¶</a></h3>
<p>On every node in the cluster, copy or move the keytab file to a directory that Hadoop can access, such as /home/hadoop/hadoop/etc/hadoop/hadoop.keytab.</p>
</div>
</div>
<div class="section" id="to-configure-kernel-hdfs-adapter">
<h2>To configure Kernel HDFS Adapter<a class="headerlink" href="#to-configure-kernel-hdfs-adapter" title="Permalink to this headline">¶</a></h2>
<p>Place this mosip.keytab file in /kernel/kernel-fsadapter-hdfs/src/main/resources and update the application properties for</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mosip</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">fsadapter</span><span class="o">.</span><span class="n">hdfs</span><span class="o">.</span><span class="n">keytab</span><span class="o">-</span><span class="n">file</span><span class="o">=</span><span class="n">classpath</span><span class="p">:</span><span class="n">mosip</span><span class="o">.</span><span class="n">keytab</span>
<span class="n">mosip</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">fsadapter</span><span class="o">.</span><span class="n">hdfs</span><span class="o">.</span><span class="n">authentication</span><span class="o">-</span><span class="n">enabled</span><span class="o">=</span><span class="n">true</span>
<span class="n">mosip</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">fsadapter</span><span class="o">.</span><span class="n">hdfs</span><span class="o">.</span><span class="n">kdc</span><span class="o">-</span><span class="n">domain</span><span class="o">=</span><span class="n">NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span>
<span class="n">mosip</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">fsadapter</span><span class="o">.</span><span class="n">hdfs</span><span class="o">.</span><span class="n">name</span><span class="o">-</span><span class="n">node</span><span class="o">-</span><span class="n">url</span><span class="o">=</span><span class="n">hdfs</span><span class="p">:</span><span class="o">//</span><span class="n">host</span><span class="o">-</span><span class="n">ip</span><span class="p">:</span><span class="n">port</span>
</pre></div>
</div>
<p><strong>NOTE : Configure the user in module specific properties file (ex- pre-registration-qa.properties) as mosip.kernel.fsadapter.hdfs.user-name=prereg</strong></p>
</div>
<div class="section" id="enable-security-in-hdfs">
<h2>Enable security in hdfs<a class="headerlink" href="#enable-security-in-hdfs" title="Permalink to this headline">¶</a></h2>
<p>To enable security in hdfs, you must stop all Hadoop daemons in your cluster and then change some configuration properties.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="n">hadoop</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">stop</span><span class="o">-</span><span class="n">dfs</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="enable-hadoop-security">
<h2>Enable Hadoop Security<a class="headerlink" href="#enable-hadoop-security" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>To enable Hadoop security, add the following properties to the ~/hadoop/etc/hadoop/core-site.xml file on every machine in the cluster:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">security</span><span class="o">.</span><span class="n">authentication</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">kerberos</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span> 
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">security</span><span class="o">.</span><span class="n">authorization</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
 
<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">initializers</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">hadoop</span><span class="o">.</span><span class="n">security</span><span class="o">.</span><span class="n">AuthenticationFilterInitializer</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">type</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">kerberos</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">simple</span><span class="o">.</span><span class="n">anonymous</span><span class="o">.</span><span class="n">allowed</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">true</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">kerberos</span><span class="o">.</span><span class="n">principal</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">HTTP</span><span class="o">/</span><span class="n">admin</span><span class="nd">@NODE</span><span class="o">-</span><span class="n">MASTER</span><span class="o">.</span><span class="n">EXAMPLE</span><span class="o">.</span><span class="n">COM</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">hadoop</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">kerberos</span><span class="o">.</span><span class="n">keytab</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">hadoop</span><span class="o">.</span><span class="n">keytab</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Add the following properties to the ~/hadoop/etc/hadoop/hdfs-site.xml file on every machine in the cluster.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;property&gt;
  &lt;name&gt;dfs.block.access.token.enable&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;!-- NameNode security config --&gt;
&lt;property&gt;
  &lt;name&gt;dfs.namenode.keytab.file&lt;/name&gt;
  `&lt;value&gt;/home/hadoop/hadoop/etc/hadoop/hadoop.keytab&lt;/value&gt; &lt;!-- path to the HDFS keytab --&gt;
&lt;/property&gt;
&lt;property&gt;
  &lt;name&gt;dfs.namenode.kerberos.principal&lt;/name&gt;
  &lt;value&gt;hadoop/admin@NODE-MASTER.EXAMPLE.COM&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
  &lt;name&gt;dfs.namenode.kerberos.internal.spnego.principal&lt;/name&gt;
  &lt;value&gt;HTTP/admin@NODE-MASTER.EXAMPLE.COM&lt;/value&gt;
&lt;/property&gt;

&lt;!-- Secondary NameNode security config --&gt;
&lt;property&gt;
  &lt;name&gt;dfs.secondary.namenode.keytab.file&lt;/name&gt;
  &lt;value&gt;/home/hadoop/hadoop/etc/hadoop/hadoop.keytab&lt;/value&gt; &lt;!-- path to the HDFS keytab --&gt;
&lt;/property&gt;
&lt;property&gt;
  &lt;name&gt;dfs.secondary.namenode.kerberos.principal&lt;/name&gt;
    &lt;value&gt;hadoop/admin@NODE-MASTER.EXAMPLE.COM&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
  &lt;name&gt;dfs.secondary.namenode.kerberos.internal.spnego.principal&lt;/name&gt;
  &lt;value&gt;HTTP/admin@NODE-MASTER.EXAMPLE.COM&lt;/value&gt;
&lt;/property&gt;

&lt;!-- DataNode security config --&gt;
&lt;property&gt;
  &lt;name&gt;dfs.datanode.data.dir.perm&lt;/name&gt;
  &lt;value&gt;700&lt;/value&gt; 
&lt;/property&gt;
&lt;property&gt;
  &lt;name&gt;dfs.datanode.keytab.file&lt;/name&gt;
  &lt;value&gt;/home/hadoop/hadoop/etc/hadoop/hadoop.keytab&lt;/value&gt;&lt;!-- path to the HDFS keytab --&gt;
&lt;/property&gt;
&lt;property&gt;
  &lt;name&gt;dfs.datanode.kerberos.principal&lt;/name&gt;
  &lt;value&gt;hadoop/admin@NODE-MASTER.EXAMPLE.COM&lt;/value&gt;
&lt;/property&gt;

&lt;!-- Web Authentication config --&gt;
&lt;property&gt;
  &lt;name&gt;dfs.web.authentication.kerberos.principal&lt;/name&gt;
  &lt;value&gt;HTTP/admin@NODE-MASTER.EXAMPLE.COM&lt;/value&gt;
 &lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;dfs.data.transfer.protection&lt;/name&gt;
  &lt;value&gt;authentication&lt;/value&gt;
 &lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;dfs.http.policy&lt;/name&gt;
  &lt;value&gt;HTTPS_ONLY&lt;/value&gt;
 &lt;/property&gt;
</pre></div>
</div>
</div>
<div class="section" id="configuring-https-in-hdfs">
<h2>Configuring https in hdfs<a class="headerlink" href="#configuring-https-in-hdfs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generating-the-key-and-certificate">
<h3>Generating the key and certificate<a class="headerlink" href="#generating-the-key-and-certificate" title="Permalink to this headline">¶</a></h3>
<p>The first step of deploying HTTPS is to generate the key and the certificate for each machine in the cluster. You can use Java’s keytool utility to accomplish this task:
Ensure that firstname/lastname OR common name (CN) matches exactly with the fully qualified domain name (e.g. node-master.example.com) of the server.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">genkey</span> <span class="o">-</span><span class="n">alias</span> <span class="n">localhost</span>  <span class="o">-</span><span class="n">keyalg</span> <span class="n">RSA</span> <span class="o">-</span><span class="n">keysize</span> <span class="mi">2048</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">keystore</span><span class="o">.</span><span class="n">jks</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-your-own-ca">
<h3>Creating your own CA<a class="headerlink" href="#creating-your-own-ca" title="Permalink to this headline">¶</a></h3>
<p>We use openssl to generate a new CA certificate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openssl</span> <span class="n">req</span> <span class="o">-</span><span class="n">new</span> <span class="o">-</span><span class="n">x509</span> <span class="o">-</span><span class="n">keyout</span> <span class="n">ca</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">out</span> <span class="n">ca</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">days</span> <span class="mi">365</span>
</pre></div>
</div>
<p>The next step is to add the generated CA to the clients’ truststore so that the clients can trust this CA:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">truststore</span><span class="o">.</span><span class="n">jks</span> <span class="o">-</span><span class="n">alias</span> <span class="n">CARoot</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">file</span> <span class="n">ca</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">cer</span>
</pre></div>
</div>
</div>
<div class="section" id="signing-the-certificate">
<h3>Signing the certificate:<a class="headerlink" href="#signing-the-certificate" title="Permalink to this headline">¶</a></h3>
<p>The next step is to sign all certificates generated  with the CA. First, you need to export the certificate from the keystore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">keystore</span><span class="o">.</span><span class="n">jks</span> <span class="o">-</span><span class="n">alias</span> <span class="n">localhost</span> <span class="o">-</span><span class="n">certreq</span> <span class="o">-</span><span class="n">file</span> <span class="n">cert</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">cer</span>
</pre></div>
</div>
<p>Then sign it with the CA:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openssl</span> <span class="n">x509</span> <span class="o">-</span><span class="n">req</span> <span class="o">-</span><span class="n">CA</span> <span class="n">ca</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">CAkey</span> <span class="n">ca</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="ow">in</span> <span class="n">cert</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">out</span> <span class="n">cert</span><span class="o">-</span><span class="n">signed</span><span class="o">.</span><span class="n">cer</span> <span class="o">-</span><span class="n">days</span> <span class="mi">365</span> <span class="o">-</span><span class="n">CAcreateserial</span> <span class="o">-</span><span class="n">passin</span> <span class="k">pass</span><span class="p">:</span><span class="mi">12345678</span>
</pre></div>
</div>
<p>Finally, you need to import both the certificate of the CA and the signed certificate into the keystore</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">keytool</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">keystore</span><span class="o">.</span><span class="n">jks</span> <span class="o">-</span><span class="n">alias</span> <span class="n">CARoot</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">file</span> <span class="n">ca</span><span class="o">-</span><span class="n">cert</span><span class="o">.</span><span class="n">cer</span>
<span class="n">keytool</span> <span class="o">-</span><span class="n">keystore</span> <span class="n">keystore</span><span class="o">.</span><span class="n">jks</span> <span class="o">-</span><span class="n">alias</span> <span class="n">localhost</span> <span class="o">-</span><span class="kn">import</span> <span class="o">-</span><span class="n">file</span> <span class="n">cert</span><span class="o">-</span><span class="n">signed</span><span class="o">.</span><span class="n">cer</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-hdfs">
<h3>Configuring Hdfs<a class="headerlink" href="#configuring-hdfs" title="Permalink to this headline">¶</a></h3>
<p>Change the ssl-server.xml and ssl-client.xml on all nodes to tell HDFS about the keystore and the truststore</p>
<ol class="simple">
<li><p>Edit ~/hadoop/etc/hadoop/ssl-server.xml</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">configuration</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">location</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">truststore</span><span class="o">.</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Truststore</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">by</span> <span class="n">NN</span> <span class="ow">and</span> <span class="n">DN</span><span class="o">.</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">specified</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">password</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">12345678</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">type</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">The</span> <span class="n">keystore</span> <span class="n">file</span> <span class="nb">format</span><span class="p">,</span> <span class="n">default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;jks&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">reload</span><span class="o">.</span><span class="n">interval</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">10000</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Truststore</span> <span class="n">reload</span> <span class="n">check</span> <span class="n">interval</span><span class="p">,</span> <span class="ow">in</span> <span class="n">milliseconds</span><span class="o">.</span>
  <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="mi">10000</span> <span class="p">(</span><span class="mi">10</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">location</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">keystore</span><span class="o">.</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Keystore</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">by</span> <span class="n">NN</span> <span class="ow">and</span> <span class="n">DN</span><span class="o">.</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">specified</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">password</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">12345678</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Must</span> <span class="n">be</span> <span class="n">specified</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">keypassword</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">12345678</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Must</span> <span class="n">be</span> <span class="n">specified</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">type</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">The</span> <span class="n">keystore</span> <span class="n">file</span> <span class="nb">format</span><span class="p">,</span> <span class="n">default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;jks&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">exclude</span><span class="o">.</span><span class="n">cipher</span><span class="o">.</span><span class="n">list</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">TLS_ECDHE_RSA_WITH_RC4_128_SHA</span><span class="p">,</span><span class="n">SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><span class="p">,</span>
  <span class="n">SSL_RSA_WITH_DES_CBC_SHA</span><span class="p">,</span><span class="n">SSL_DHE_RSA_WITH_DES_CBC_SHA</span><span class="p">,</span>
  <span class="n">SSL_RSA_EXPORT_WITH_RC4_40_MD5</span><span class="p">,</span><span class="n">SSL_RSA_EXPORT_WITH_DES40_CBC_SHA</span><span class="p">,</span>
  <span class="n">SSL_RSA_WITH_RC4_128_MD5</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">The</span> <span class="n">weak</span> <span class="n">security</span> <span class="n">cipher</span> <span class="n">suites</span> <span class="n">that</span> <span class="n">you</span> <span class="n">want</span> <span class="n">excluded</span>
  <span class="kn">from</span> <span class="nn">SSL</span> <span class="n">communication</span><span class="o">.&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">configuration</span><span class="o">&gt;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Edit ~/hadoop/etc/hadoop/ssl-client.xml</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">configuration</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">location</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">truststore</span><span class="o">.</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Truststore</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">by</span> <span class="n">clients</span> <span class="n">like</span> <span class="n">distcp</span><span class="o">.</span> <span class="n">Must</span> <span class="n">be</span>
  <span class="n">specified</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">password</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">12345678</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">type</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">The</span> <span class="n">keystore</span> <span class="n">file</span> <span class="nb">format</span><span class="p">,</span> <span class="n">default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;jks&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">truststore</span><span class="o">.</span><span class="n">reload</span><span class="o">.</span><span class="n">interval</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">10000</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Truststore</span> <span class="n">reload</span> <span class="n">check</span> <span class="n">interval</span><span class="p">,</span> <span class="ow">in</span> <span class="n">milliseconds</span><span class="o">.</span>
  <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="mi">10000</span> <span class="p">(</span><span class="mi">10</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">location</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;/</span><span class="n">home</span><span class="o">/</span><span class="n">hadoop</span><span class="o">/</span><span class="n">keystore</span><span class="o">.</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Keystore</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">by</span> <span class="n">clients</span> <span class="n">like</span> <span class="n">distcp</span><span class="o">.</span> <span class="n">Must</span> <span class="n">be</span>
  <span class="n">specified</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">password</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">12345678</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">keypassword</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="mi">12345678</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nb">property</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="n">ssl</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">keystore</span><span class="o">.</span><span class="n">type</span><span class="o">&lt;/</span><span class="n">name</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="n">jks</span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Optional</span><span class="o">.</span> <span class="n">The</span> <span class="n">keystore</span> <span class="n">file</span> <span class="nb">format</span><span class="p">,</span> <span class="n">default</span> <span class="n">value</span> <span class="ow">is</span> <span class="s2">&quot;jks&quot;</span><span class="o">.</span>
  <span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nb">property</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">configuration</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>After restarting the HDFS daemons (NameNode, DataNode and JournalNode), you should have successfully deployed HTTPS in your HDFS cluster.</p>
<p>For you face error during kerberos, check this:
<a class="reference external" href="//steveloughran.gitbooks.io/kerberos_and_hadoop/content/sections/errors.html"><strong>link</strong></a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, mosip-team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>